define("common/plugin/jquery.ui.breadcrumb",["jquery","underscore"],(function(e,t){"use strict";e.widget("ui.breadcrumb",{classMenu:"ui-breadcrumb-menu",selectorMenu:".ui-breadcrumb-menu",classMenuButton:"ui-breadcrumb-menu-button",selectorMenuButton:".ui-breadcrumb-menu-button",classBreadcrumb:"ui-breadcrumb-crumb",classBreadcrumbFixed:"ui-breadcrumb-crumb-fixed-width",classBreadcrumbSep:"ui-breadcrumb-sep",selectorBreadcrumbSep:".ui-breadcrumb-sep",options:{label:"",leftFixed:0,rightFixed:1,crumbCharLength:-1,separator:"&#9654;",menuSeparator:"&#9660;",menuAriaContext:"",useMenuButtonBorder:!0,offsetX:-52,offsetY:-4,dropOnClick:!1,closeDelay:0,sepStartPosition:0,showBack:!1,showList:!0},_create:function(){var t=this.element,i=e(this._breadcrumbContainerHtml());if(this.container=t.wrap(i).parent(),this.options.showBack){var s="<div class='ui-breadcrumb-back-wrapper'><button class='ui-breadcrumb-back'></button>";s+=this.options.showList?"<div class='ui-breadcrumb-back-sep'></div></div>":"</div>",this.container.prepend(s),e(".ui-breadcrumb-back",this.container).on("click",(function(){window.history.back()}))}var n=e('<span class="breadcrumb-label visuallyhidden" tabindex="-1">'+this.options.label+"</span>");n.uniqueId(),this.container.prepend(n),t.addClass("ui-breadcrumb"),t.attr("aria-labelledby",n.attr("id")),e("li:gt("+this.options.sepStartPosition+")",t).prepend(this._separatorHtml()),e("li",t).addClass(this.classBreadcrumb),this._computeCrumbWidth(),this.options.showList?this.element.show():this.element.hide()},refreshInternal:function(i){var s,n,o=i.offset().left+i.width()-15,a=e("li:first-child",i),r=e("li:last-child",i),l=e(".bc-area2");if(l.length>0&&(o=l.parent().width()-l.width()-15),r.length>0){for(;r.offset().left+r.width()>o;)if(t.isUndefined(n))if(this.options.crumbWidth){var u=(s=this._allNonFixed(this.options.leftFixed,i)).length,d=this;s.each((function(t){if(!e(this).hasClass(d.classBreadcrumbFixed))return t>=u-1?(n=e(d._menuContainerHtml()),!1):(e(this).addClass(d.classBreadcrumbFixed),!1)}))}else n=e(this._menuContainerHtml());else{if(!((s=this._allNonFixed(this.options.leftFixed,i)).length>this.options.rightFixed))break;var c=e(s[0]);c.detach(),c.find(this.selectorBreadcrumbSep).remove(),c.removeClass(this.classBreadcrumb+" "+this.classBreadcrumbFixed),n.prepend(c)}r.offset().left-a.offset().left+r.width()>o&&r.css("width",o-(r.offset().left-a.offset().left)+7)}n&&n.children().length>0&&((s=this._firstNonFixed(this.options.leftFixed,i)).find(this.selectorBreadcrumbSep).remove(),this.$menuContainer=this._createMenuContainer(n))},refresh:t.throttle((function(e){this.refreshInternal(e)}),300,{leading:!1}),refreshview:function(i){var s=this.element;if(this.$menuContainer){if(this.$menuContainer.dropmenu("destroy"),this.$menuContainer.children().length>0){var n=s.find("span:has(.ui-breadcrumb-menu-button)");if(n){n.next().find(".breadcrumb").before(this._separatorHtml());var o=this.$menuContainer.find("li"),a=this;o.each((function(){n.before(e(this)),e(this).removeClass("ui-menu-item"),e(this).removeClass("dropmenu_li"),e(this).removeAttr("role"),e(this).addClass(a.classBreadcrumb),e(this).addClass(a.classBreadcrumbFixed),e(this).find(".ui-breadcrumb-sep").remove(),e(this).find(".breadcrumb").removeClass("ui-corner-all").before(a._separatorHtml()),n=e(this)}))}}this.$menuContainer=void 0,this.container.find(".ui-callout-container").remove()}e("#overflow_menu").remove(),e("li",s).removeClass(this.classBreadcrumbFixed),e("li:last-child",s).css("width",""),i?this.refreshInternal(this.element):t.defer(t.bind((function(){this.refresh(this.element)}),this))},_init:function(){this.refreshInternal(this.element)},_destroy:function(){var t=this.element;t.removeClass("ui-widget ui-breadcrumb"),t.removeAttr("aria-labelledby"),t.siblings().remove(),e("li",t).removeClass(this.classBreadcrumb).css("width","auto").off(),e(this.selectorBreadcrumbSep,t).remove(),e(this.selectorMenuButton).remove(),e(this.selectorMenu+" li").each((function(){e(this).detach(),t.prepend(e(this))})),this.$menuContainer&&this.$menuContainer.dropmenu("destroy"),t.unwrap()},_firstNonFixed:function(t,i){return 0===t?e("li:first-child",i):e(e("li:gt("+(t-1)+")",i)[0])},_allNonFixed:function(t,i){return e(0===t?"li":"li:gt("+(t-1)+")",i)},_computeCrumbWidth:function(){if(this.options.crumbCharLength>0){this.options.crumbWidth=this.options.crumbCharLength;var e='<style type="text/css"> .'+this.classBreadcrumbFixed+" { max-width: "+this.options.crumbWidth+"em; }</style>";this.container.prepend(e)}else delete this.options.crumbWidth},_breadcrumbContainerHtml:function(){return'<nav class="ui-breadcrumb-container ui-widget" role="navigation"></nav>'},_separatorHtml:function(){return'<span class="'+this.classBreadcrumbSep+'" aria-hidden="true">'+this.options.separator+"</span>"},_createMenuContainer:function(t){if(t&&t.children().length>0){var i=e('<span id="overflow_menu" role="menu"></span>');i.append(this._createMenuButton()),i.append(t),i.dropmenu({select:this._menuItemSelect,ariaContext:this.options.menuAriaContext}),this._firstNonFixed(this.options.leftFixed,this.element).before(i);var s=window.innerHeight-100;return s<25&&(s=25),t.css("max-height",s),i}},_menuContainerHtml:function(){return'<ul class="dropmenu_topmenu '+this.classMenu+'"></ul>'},_createMenuButton:function(){var t=this.options.useMenuButtonBorder?" ui-corner-all ui-widget-content":"",i=e('<span id="menu_button" class="dropmenu_button text_button_nohover '+this.classMenuButton+t+'"></span>');return i.append(this.options.menuSeparator),this.options.dropOnClick||i.on({mouseenter:e.proxy(this._buttonClick,this)}),i.on({click:e.proxy(this._buttonClick,this)}),i},_menuItemSelect:function(t){"click"!==t.type&&(t.preventDefault(),e(t.target).click())},_buttonClick:function(e){this.$menuContainer.dropmenu("showDropDownMenu",e)},_closeDropdown:function(){this.$menuContainer.dropmenu("collapseMenu")}})})),define("common/plugin/jquery.ui.dropmenu",["jquery","underscore","common/util/PositionUtils","core/util/Logger","jqueryui-amd/widgets/button"],(function(e,t,i,s){"use strict";var n=/(((cm)|(ct))_action_upload_version)|(((cm)|(ct))_action_upload_to_folder)|(fileview_upload_new_version)/,o=/action_upload_to_assets|action_upload_version|action_upload_to_folder|fileview_upload_new_version/;function a(e){return n.test(e.attr("id"))||o.test(e.data("action"))}var r=function(){var e=3,t=document.createElement("div"),i=t.getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(i[0]);return e>4?e:void 0}();e.widget("ui.dropmenu",{options:{align:"auto",icons:!1,delay:500,delay_submenu:250,contextMenu:!1,selectionMenu:!1,context_offset:{top:-5,left:-5},ariaContext:"",elementWidth:null},_init:function(){},_create:function(){if(this.element.addClass("dropmenu_container"),this.element.attr("role","application"),this.button=e(".dropmenu_button",this.element).length?e(".dropmenu_button",this.element):void 0,!t.isUndefined(this.button)){this.button.is("button")&&this.button.button(this.options.button||{icon:"ui-icon-triangle-1-s",iconPosition:"end"}),this.changeAriaContext(this.options.ariaContext),this.button.attr("role","button"),r||this.button.attr("aria-haspopup",!0);var i=this.button.attr("tabindex");t.isUndefined(i)&&this.button.attr("tabindex",0),this.button.on({click:e.proxy(this._mouseClickedOnButton,this),keydown:this.options.selectSlider?e.noop():e.proxy(this._keyPressedOnButton,this),mouseleave:r?e.noop():e.proxy(this._startCloseTimer,this)})}this.isLTR="ltr"===docs.common.Globals.dir,this.$menu=e(".dropmenu_topmenu",this.element),e("li",this.$menu).addClass("ui-menu-item dropmenu_li").attr("role","presentation"),e("a",this.$menu).uniqueId().addClass("ui-corner-all").attr("role","menuitem").attr("tabIndex","-1"),this.$submenus=e("ul",this.$menu),this.$submenus.length>0&&(this.$submenus.addClass("ui-menu ui-widget ui-widget-content ui-corner-all"),this.$submenus.prev("a").addClass("ui-menu-submenu").attr("aria-haspopup","true"),this.$submenus.prev("a").append('<span class="oj-ux-icon oj-ux-ico-caret-menu">'),this.$submenus.attr({role:"menu","aria-expanded":"false","aria-hidden":"true"}),this.$submenus.hide()),this.$menu.children(":not(.ui-menu-item)").each((function(){var t=e(this);/[^\-\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")})),this.$menu.addClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-helper-clearfix ui-co-container-up").attr("role","menu"),this.$menu.wrap(this._menuWrapperHtml()),this.$menuWrapper=this.$menu.parent(),e(".ui-icon",this.$menuWrapper).remove(),this.options.icons?e(".dropmenu_li[data-icon]",this.$menu).prepend((function(){return"<span class='ui-icon "+e(this).data("icon")+"'></span>"})):e(".dropmenu_li",this.$menu).attr("data-icon-hide","true"),e(".dropmenu_li[data-checked]",this.$menu).prepend((function(){return"<span class='ui-menu-check oj-selected oj-menucheckbox-icon'></span>"})),this.$menuWrapper.on({mouseenter:e.proxy(this._cancelCloseTimer,this),mouseleave:e.proxy(this._startCloseTimer,this),focusout:e.proxy(this._focusout,this)}),this.$menu.on("focus.dmenu",'[role="menuitem"]',{focusWrapper:!0},e.proxy(this._itemFocused,this)),this.$menu.on("blur.dmenu",'[role="menuitem"]',null,e.proxy(this._itemBlurred,this)),this.$menu.on("mouseenter.dmenu",'[role="menuitem"]',{focusWrapper:!1},e.proxy(this._itemFocused,this)),this.$menu.on("mouseleave.dmenu",'[role="menuitem"]',null,e.proxy(this._itemBlurred,this)),e("a",this.$menu).on({"click.dmenu":e.proxy(this._itemSelected,this)}),this.menuKeyDownTriggered=!1;var s=this.element.position();this.$menuWrapper.css({top:s.top,left:!checkFeatureFlag("BidiSupportDropMenu")||this.isLTR?s.left:Math.min(window.visualViewport.width-s.left,window.visualViewport.width-this.$menuWrapper.outerWidth())}),this.adjustMenuPaddingIfIconsPresent(),docs.events.on("orientationchange",this.collapseMenu,this)},destroy:function(){e.Widget.prototype.destroy.call(this,arguments),docs.events.off("orientationchange",this.collapseMenu,this),this.element.removeClass("dropmenu_container"),this.element.removeAttr("role"),t.isUndefined(this.button)||(this.button.removeClass("dropmenu_button"),this.button.off()),e("li",this.$menu).removeClass("ui-menu-item dropmenu_li").removeAttr("role"),e("a",this.$menu).removeClass("ui-corner-all").removeAttr("role"),this.$submenus.removeClass("ui-menu ui-widget ui-widget-content ui-corner-all"),this.$submenus.prev("a").removeClass("ui-menu-submenu").removeAttr("aria-haspopup"),this.$submenus.removeAttr("role"),this.$submenus.removeAttr("aria-expanded"),this.$submenus.removeAttr("aria-hidden"),this.$menu.children(".ui-menu-divider").removeClass("ui-widget-content ui-menu-divider"),this.$menu.removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-helper-clearfix ui-co-container-up").removeAttr("role"),this.$menu.width("auto"),this.$menu.prev(".dropmenu-co-up-1").remove(),this.$menu.unwrap(),e("a",this.$menu).off(".dmenu"),this.$menu.off(".dmenu")},focus:function(t,i){var s=e(i);if(a(s)){var n=e(s.prev("input")[0]);n.is(":visible")&&n.focus()}else s.find("a").focus()},_menuWrapperHtml:function(){return'<div class="dropmenu_wrapper"></div>'},_itemFocused:function(t){s("jqueryui.dropmenu").trace("_itemFocused"),this._cancelSubMenuOpenTimer(),this._cancelCloseTimer();var i=t.target||t.srcElement,n=e(i),o=this._getParentListItem(n);if(this._closeSiblingMenus(o),n.hasClass("ui-menu-submenu")&&this._startSubMenuOpenTimer(t),o.addClass("ui-menu-hover"),t.data.focusWrapper){var a=this._getUploadWrapper(n);a&&a.addClass("focus")}},_itemBlurred:function(e){s("jqueryui.dropmenu").trace("_itemBlurred");var t=e.target||e.srcElement;this._getParentListItem(t).removeClass("ui-menu-hover");var i=this._getUploadWrapper(t);i&&i.removeClass("focus")},_getParentListItem:function(t,i){var s,n=e(t);return n.is("input")?(s=e("#"+n.attr("aria-labelledby")),i&&a(s)&&(s=s.parents(".ui-menu-item"))):s=n.closest("li"),s},_getUploadWrapper:function(t){var i,s=e(t);return s.is("input")&&(i=s.parent(".file-input-wrapper")),i},_keydownOnMenu:function(t){var i=t.keyCode||t.which;i!==e.ui.keyCode.ENTER&&i!==e.ui.keyCode.SPACE&&t.preventDefault(),this.menuKeyDownTriggered=!0},_keyupOnMenu:function(t){if(this.menuKeyDownTriggered)switch(this.menuKeyDownTriggered=!1,t.keyCode||t.which){case e.ui.keyCode.UP:this._previous(t);break;case e.ui.keyCode.DOWN:this._next(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._itemSelected(t);break;case e.ui.keyCode.ESCAPE:t.preventDefault(),this.collapseCurrentMenu(t)}},_previous:function(e){var t=e.target||e.srcElement,i=this._getParentListItem(t,!0),s=i.prevAll(".ui-menu-item:visible").first();0===s.length&&(s=i.nextAll(".ui-menu-item:visible").last()),1===s.length&&s.find('[role="menuitem"]:visible')[0].focus(),e.preventDefault()},_next:function(e){var t=e.target||e.srcElement,i=this._getParentListItem(t,!0),s=i.nextAll(".ui-menu-item:visible").first();0===s.length&&(s=i.prevAll(".ui-menu-item:visible").last()),1===s.length&&s.find('[role="menuitem"]:visible')[0].focus(),e.preventDefault()},_itemSelected:function(e){var t=this._fabricateUiObject(e);s("jqueryui.dropmenu").trace("_itemSelected"),this.options.select&&(s("jqueryui.dropmenu").trace("_itemSelected - call select callback"),this.options.select(e,t)),e.preventDefault(),this.collapseMenu(e,t)},_fabricateUiObject:function(e){var t=e.target||e.srcElement;return{item:this._getParentListItem(t)}},_mouseClickedOnButton:function(e){this.$menuWrapper.is(":visible")?(e.preventDefault(),this.collapseMenu()):this.showDropDownMenu(e)},_keyPressedOnButton:function(i){switch(i.keyCode||i.which){case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:i.preventDefault(),this.$menuWrapper.is(":visible")?this.collapseMenu():(t.isUndefined(this.button)||(this.options.selectSlider?this.button.off("focusout"):this.button.on("focusout",e.proxy(this.collapseMenu,this))),this.showDropDownMenu(i,{focusFirstItem:this.options.selectSlider}));break;case e.ui.keyCode.DOWN:i.preventDefault(),t.isUndefined(this.button)||this.button.off("focusout"),this.showDropDownMenu(i,{focusFirstItem:!0});break;case e.ui.keyCode.ESCAPE:i.preventDefault(),this.collapseMenu(i)}},_turnOnMenuKeyEvents:function(){this.$menu.on("keyup.dmenu",'[role="menuitem"]',e.proxy(this._keyupOnMenu,this)),this.$menu.on("keydown.dmenu",'[role="menuitem"]',e.proxy(this._keydownOnMenu,this))},_turnOffMenuKeyEvents:function(){this.$menu.off("keyup.dmenu"),this.$menu.off("keydown.dmenu")},showDropDownMenu:function(n,o){if(s("jqueryui.dropmenu").trace("showDropDownMenu"),o=o||{},this.focusOnClose=o.focusOnClose,n.isDefaultPrevented()||n.preventDefault(),this._cancelCloseTimer(),!this.$menuWrapper.is(":visible"))if(r&&e(":ui-dropmenu").each((function(){var t=e(this).data("dropmenu");void 0!==t&&t.collapseMenu()})),this.menuTarget=n.currentTarget,this._trigger("dropdown"),s("jqueryui.dropmenu").trace("showDropDownMenu - show menuWrapper"),this.$menuWrapper.show(),s("jqueryui.dropmenu").trace(`showDropDownMenu - menuWrapper html ${this.$menuWrapper.html()}`),s("jqueryui.dropmenu").trace(`showDropDownMenu - isVisible: ${this.$menuWrapper.is(":visible")}`),s("jqueryui.dropmenu").trace(`showDropDownMenu - menuWrapper position ${JSON.stringify(this.$menuWrapper.position())}`),"contextmenu"===n.type||"mousedown"===n.type&&3===n.which||("click"===n.type||"keydown"===n.type)&&!t.isUndefined(this.options.selectSlider)){var l=checkFeatureFlag("BidiSupportDropMenu")?"inset-inline-start":"left",u=n.pageX,d=n.pageY;if(!t.isUndefined(this.options.selectSlider)){var c=e(n.target).closest(".dropmenu_button");if(c.length){var h=c[0].getBoundingClientRect();u=!checkFeatureFlag("BidiSupportDropMenu")||this.isLTR?h.left:h.right,d=h.bottom}}var p=(!checkFeatureFlag("BidiSupportDropMenu")||this.isLTR?u:window.visualViewport.width-u)-e(window).scrollLeft()+this.options.context_offset.left,g=d-e(window).scrollTop()+this.options.context_offset.top,m=p+this.$menuWrapper.outerWidth()-e(window).width(),f=g+this.$menuWrapper.outerHeight()-e(window).height();if(n.target&&e(n.target).parents(".ui-dialog").length>0){var _=e(n.target).parents(".ui-dialog")[0],v=_.offsetTop,C=_.offsetLeft,b=v+_.offsetHeight,E=C+_.offsetWidth;m=p+this.$menuWrapper.outerWidth()-E,f=g+this.$menuWrapper.outerHeight()-b}m>0&&(p-=m),f>0&&(g-=f),s("jqueryui.dropmenu").trace(`showDropDownMenu - ${l}=${p}`),this.$menuWrapper.css(l,p+"px"),this.$menuWrapper.css("top",g+"px"),checkFeatureFlag("BidiSupportDropMenu")&&this.$menuWrapper.css("left","")}else if(!t.isUndefined(this.button)){var S="center ",T="center ";if("left"===this.options.align?(S=checkFeatureFlag("BidiSupportDropMenu")?"start ":"left ",T=checkFeatureFlag("BidiSupportDropMenu")?"start ":"left ",this.$menuWrapper.css("min-width",e(this.button).outerWidth()+"px")):("right"===this.options.align||e(this.button).outerWidth()>this.$menuWrapper.outerWidth())&&(S=checkFeatureFlag("BidiSupportDropMenu")?"end ":"right ",T=checkFeatureFlag("BidiSupportDropMenu")?"end ":"right "),this.options.elementWidth){var I=this.$menuWrapper.closest(this.options.elementWidth);I.length&&this.$menuWrapper.css("min-width",I.width()+"px")}this.$menuWrapper.css("max-width",e(window).width()+"px"),this.$menuWrapper.position(i.normalizeHorizontalAlignment({my:S+"top",at:T+"bottom",of:this.button,collision:"flipfit fit",within:this.options.within})),s("jqueryui.dropmenu").trace(`showDropDownMenu - isVisible: ${this.$menuWrapper.is(":visible")}`),s("jqueryui.dropmenu").trace(`showDropDownMenu - menuWrapper position ${JSON.stringify(this.$menuWrapper.position())}`)}if(t.delay(e.proxy(this._turnOnMenuKeyEvents,this),150),t.isFunction(this.options.afterOpen)&&this.options.afterOpen(this),o.focusFirstItem){var D;if(this.options.selectSlider){var w=this.options.selectSlider.val(),y=e("li:visible a",this.$menuWrapper);D=t.find(y,(function(t){return e(t).data("stop")===w}))}if(D)e(D).focus();else{var A=e("li:visible:first",this.$menuWrapper);a(A)&&1===A.prev("input:visible").length?A.prev("input:visible")[0].focus():A.find("a")[0].focus()}}},collapseCurrentMenu:function(e){this.collapseMenu(e),this.options.contextMenu||t.isUndefined(this.button)?this.options.contextMenu&&!t.isUndefined(this.focusOnClose)&&(this.focusOnClose.focus(),delete this.focusOnClose):this.button.focus()},collapseMenu:function(){s("jqueryui.dropmenu").trace("collapseMenu"),this.$menuWrapper.is(":visible")&&(this._cancelCloseTimer(),this._closeSubMenus(),s("jqueryui.dropmenu").trace("collapseMenu - hide menuWrapper"),this.$menuWrapper.hide(),this._turnOffMenuKeyEvents(),t.isFunction(this.options.afterClose)&&this.options.afterClose(this)),this.$menuWrapper&&(this.$menuWrapper.off("mouseleave"),this.$menuWrapper.on({mouseleave:e.proxy(this._startCloseTimer,this)}))},_focusout:function(e){s("jqueryui.dropmenu").trace("_focusOut"),a(this._fabricateUiObject(e).item)||this._startCloseTimer(e)},_startCloseTimer:function(){s("jqueryui.dropmenu").trace("_startCloseTimer"),this.$menuWrapper.is(":visible")&&(this.closetimer=window.setTimeout(e.proxy(this.collapseMenu,this),this.options.delay))},_cancelCloseTimer:function(){s("jqueryui.dropmenu").trace("_cancelCloseTimer"),this.closetimer&&(window.clearTimeout(this.closetimer),this.closetimer=null)},_startSubMenuOpenTimer:function(t){var i=t.target||t.srcElement,s=e(e(i).next("ul")[0]);s.is(":visible")||(this.$submenu=s,this.submenutimer=window.setTimeout(e.proxy(this._showSubMenu,this),this.options.delay_submenu))},_cancelSubMenuOpenTimer:function(){this.submenutimer&&(window.clearTimeout(this.submenutimer),this.submenutimer=null)},_showSubMenu:function(){this.$submenu&&(this.$submenu.show(),this.$submenu.position({my:"left top",at:t.isString(this.options.at)?this.options.at:"right top",of:e(this.$submenu.parents("li")[0]),collision:"flipfit",within:this.options.within?this.options.within:window}))},_closeSubMenus:function(){this._cancelSubMenuOpenTimer(),this.$submenus.hide()},_closeSiblingMenus:function(t){e(t).siblings().find("ul").hide()},updateItems:function(t,i){s("jqueryui.dropmenu").trace(`updateItems selector=${t}, state=${i}`);var n=e(t,this.$menu);n&&(n.toggleClass("ui-state-disabled",!i),n.toggle(i),n.attr("aria-disabled",!i))},updateItemStatus:function(t,i){s("jqueryui.dropmenu").trace(`updateItemStatus selector=${t}, status=${i}`);var n=e(t,this.$menu);n&&(n.toggleClass("ui-state-disabled",!i),n.attr("aria-disabled",!i))},getButton:function(){return this.button},getTopMenu:function(){return this.$menu},changeAriaContext:function(e){if(!t.isUndefined(this.button)){if(e&&t.isString(e)&&e.trim().length>0)this.options.ariaContext=e;else{var i=this.button.attr("title");this.options.ariaContext=docs.i18n.t("UI_DROPDOWN_MENU_LABEL",i)}this.button.attr("aria-label",this.options.ariaContext)}},replaceAllMenuItems:function(i){s("jqueryui.dropmenu").trace("replaceAllMenuItems"),this.$menu.empty(),t.each(i,(function(e){this.$menu.append(e)}),this),e("li",this.$menu).addClass("remove_button_style ui-menu-item dropmenu_li").attr("role","presentation"),e("a",this.$menu).uniqueId().addClass("ui-corner-all").attr("role","menuitem").attr("tabIndex","-1"),e("a",this.$menu).on({"click.dmenu":e.proxy(this._itemSelected,this)}),this.adjustMenuPaddingIfIconsPresent()},setItems:function(e){this.$menu.empty(),t.each(e,(function(e){this.appendItem(e)}),this),this.adjustMenuPaddingIfIconsPresent()},replaceWith:function(e,i){var s=this.$menu.find(e),n=s.first().index();s.remove(),t.each(i,(function(e){e.index=n++,this.appendItem(e)}),this),this.adjustMenuPaddingIfIconsPresent()},appendItem:function(i){var s,n;return i.menuSeparator?s=e('<div class="dropmenu_sep ui-widget-content ui-menu-divider"></div>'):(s=e("<li></li>",{id:i.id,title:i.title||i.tooltip,class:i.klass}).append(e("<a href='#'><span></span>"+(i.itemIcon?"<img"+(i.itemIconClass?' class="'+i.itemIconClass+'"':"")+' src="'+i.itemIcon+'"/>':"")+i.label+"</a>")),i.data&&t.each(i.data,(function(e,t){s.attr("data-"+t,e)})),s.addClass("remove_button_style ui-menu-item dropmenu_li").attr("role","presentation"),e("a",s).uniqueId().addClass("ui-corner-all").attr("role","menuitem").attr("tabIndex","-1"),e("a",s).on({"click.dmenu":e.proxy(this._itemSelected,this)})),(n=t.isNumber(i.index)?this.$menu.children().eq(i.index):this.$menu.find(i.before))&&n.length>0?n.before(s):this.$menu.append(s),s},disable:function(){var t=e(".dropmenu_button",this.element);t.button("disable"),t.css({opacity:1}),t.find(".ui-button-icon").hide()},enable:function(){var t=e(".dropmenu_button",this.element);t.button("enable"),t.css({opacity:1}),t.find(".ui-button-icon").show()},adjustMenuPaddingIfIconsPresent:function(){this.$menu.toggleClass("ui-menu-icons",this.options.selectionMenu||this.$menu.children().find("img, .oj-ux-icon:not(.oj-ux-ico-caret-menu), .osn-selected").length>0)}})})),define("common/assets/settings",[],(function(){"use strict";return{datatypes:{text:{allowMultiValue:!0,editors:{textbox:{tip:{type:"character-counter"},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"textbox"}}},customValidatorTypes:["length","custom-regex"]},textarea:{tip:{type:"character-counter"},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"textarea"}}},customValidatorTypes:["length","custom-regex"]},radiobuttonset:{tip:null,editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"required"},{type:"length",options:{min:0,max:2e3}}]}}},"single-selectbox":{tip:null,editorOptions:{multiple:!1,select2Options:{}},customValidatorTypes:[],editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"required"},{type:"length",options:{min:0,max:2e3}}]}}},"single-selectbox-rest":{editorConfig:{configView:"CaasRESTOptionsConfigView",configOptions:{allowMultipleSelect:!1}}},"multi-selectbox":{tip:null,editorOptions:{multiple:!0,select2Options:{}},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!0,validators:[{type:"required"},{type:"length",options:{min:0,max:2e3}}]}},customValidatorTypes:[]},"multi-selectbox-rest":{editorConfig:{configView:"CaasRESTOptionsConfigView",configOptions:{allowMultipleSelect:!0}}},checkboxset:{tip:null,editorOptions:{},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!0,validators:[{type:"required"},{type:"length",options:{min:0,max:2e3}}]}},customValidatorTypes:[]},tagcloud:{tip:{stringKey:"CAAS_EDITOR_TAGCLOUD_TIP"},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"tagcloud",defaultValueValidators:[]}}},editorOptions:{},customValidatorTypes:["length","custom-regex"]}},defaultEditor:"textbox",defaultViewer:"text",defaultEmptyValue:"",validators:[{type:"length",options:{min:0,max:2e3}}],customValidators:[{type:"length",defaultOptions:{validateOnEachValue:!0,ignoreEmpty:!0},label:"CAAS_LENGTH_VALIDATION_LABEL",configView:"CaasLengthValidatorConfigView",configOptions:{min:0,max:2e3,maxDefault:2e3}},{type:"custom-regex",defaultOptions:{validateOnEachValue:!0},label:"CAAS_REGEX_VALIDATION_LABEL",configView:"CaasCustomRegexValidatorConfigView",configOptions:{}}]},largetext:{allowMultiValue:!0,editors:{textarea:{tip:{type:"character-counter"},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"textarea",defaultValueValidators:[{type:"length",options:{min:0,max:4e3}}]}}},customValidatorTypes:["length","custom-regex"]},"rich-text-editor":{tip:{type:"character-counter",options:{stringKey:"CAAS_EDITOR_CHARACTER_COUNT_WITH_MARKUP_TIP"}},editorConfig:{configView:"CaasCKEditorConfigView",configOptions:{configTypes:[{labelKey:"CAAS_EDITOR_CONFIG_RTE_STANDARD",value:"caas-standard"},{labelKey:"CAAS_EDITOR_CONFIG_RTE_BASIC",value:"caas-basic"},{labelKey:"CAAS_EDITOR_CONFIG_RTE_CUSTOM",value:"caas-custom"}],defaultValueSettings:{defaultValueEditor:"textarea",defaultValueValidators:[{type:"length",options:{min:0,max:4e3}}]}}},customValidatorTypes:["length"]},"markdown-editor":{tip:{type:"character-counter",options:{stringKey:"CAAS_EDITOR_CHARACTER_COUNT_TIP"}},editorConfig:{configView:"CaasMarkdownEditorConfigView",configOptions:{configTypes:[{labelKey:"CAAS_EDITOR_CONFIG_RTE_STANDARD",value:"caas-mde-standard"},{labelKey:"CAAS_EDITOR_CONFIG_RTE_CUSTOM",value:"caas-mde-custom"}],defaultValueSettings:{defaultValueEditor:"textarea",defaultValueValidators:[{type:"length",options:{min:0,max:4e3}}]}}},customValidatorTypes:["length"]}},defaultEditor:"textarea",defaultViewer:"text",defaultEmptyValue:"",validators:[],customValidators:[{type:"length",defaultOptions:{validateOnEachValue:!0,ignoreEmpty:!0},label:"CAAS_LENGTH_VALIDATION_LABEL",configView:"CaasLengthValidatorConfigView",configOptions:{min:0,max:1e9,maxDefault:1e4}},{type:"custom-regex",defaultOptions:{validateOnEachValue:!0},label:"CAAS_REGEX_VALIDATION_LABEL",configView:"CaasCustomRegexValidatorConfigView",configOptions:{}}]},media:{allowMultiValue:!0,fixedReferenceType:!0,defaultReferenceType:{types:["DigitalAsset"]},defaultEditor:"mediapicker",defaultViewer:"media",editors:{mediapicker:{tip:null,editorConfig:{configView:"CaasMediaOptionsConfigView",configOptions:{allowMultipleSelect:!0}}}},validators:[]},reference:{allowMultiValue:!0,fixedReferenceType:!1,defaultReferenceType:{types:[]},defaultEditor:"itempicker",defaultViewer:"item",editors:{itempicker:{tip:null,editorConfig:{configView:"CaasReferenceOptionsConfigView",configOptions:{}}}}},datetime:{allowMultiValue:!1,defaultEditor:"datepicker",defaultViewer:"date",editors:{datepicker:{editorOptions:{showTimepicker:!1,showTimezone:!1},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"datepicker",defaultValueEditorOptions:{showTimepicker:!1,showTimezone:!1}}}},customValidatorTypes:["daterange"]},datetimepicker:{editorOptions:{showTimepicker:!0,showTimezone:!1},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"datetimepicker",defaultValueEditorOptions:{showTimepicker:!0,showTimezone:!1}}}},customValidatorTypes:["daterange"]},datetimepickertz:{editorOptions:{showTimepicker:!0,showTimezone:!0,timeFormat:"LT"},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"datetimepickertz",defaultValueEditorOptions:{showTimepicker:!0,showTimezone:!0}}}},customValidatorTypes:["daterange"]}},customValidators:[{type:"daterange",defaultOptions:{validateOnEachValue:!0},label:"CAAS_DATE_RANGE_VALIDATION_LABEL",configView:"CaasDateRangeValidatorConfigView",configOptions:{}}]},number:{allowMultiValue:!1,editors:{"number-inc-dec":{tip:{stringKey:"CAAS_EDITOR_NUMBER_INTEGER_TIP"},converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}},editorOptions:{min:-2147483648,max:2147483647,step:1},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"number-inc-dec",defaultValueEditorOptions:{min:-2147483648,max:2147483647,step:1},defaultValueConverter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}}}}},customValidatorTypes:["numrange"]},radiobuttonset:{tip:null,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,noFormat:!0,useGrouping:!1}},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"isNumber"},{type:"required"},{type:"numrange",options:{min:-2147483648,max:2147483647}}],converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}}}},customValidatorTypes:[]},"single-selectbox":{tip:null,editorOptions:{multiple:!1,select2Options:{}},converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,noFormat:!0,useGrouping:!1}},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"isNumber"},{type:"required"},{type:"numrange",options:{min:-2147483648,max:2147483647}}],converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}}}},customValidatorTypes:[]},"single-selectbox-rest":{converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,noFormat:!0,useGrouping:!1}},editorConfig:{configView:"CaasRESTOptionsConfigView",configOptions:{allowMultipleSelect:!1,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}}}}}},defaultEditor:"number-inc-dec",defaultViewer:"text",validators:[],customValidators:[{type:"numrange",defaultOptions:{validateOnEachValue:!0},label:"CAAS_NUMBER_RANGE_VALIDATION_LABEL",configView:"CaasNumberRangeValidatorConfigView",configOptions:{min:-2147483648,max:2147483647,minDefault:-1e3,maxDefault:1e3,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0,formatDuringParse:!0,useGrouping:!1}}}}]},decimal:{allowMultiValue:!1,editors:{"number-inc-dec":{tip:{stringKey:"CAAS_EDITOR_NUMBER_DECIMAL_TIP"},converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,useGrouping:!1}},editorOptions:{min:-340282347e30,max:340282347e30,step:1},editorConfig:{configView:"CaasDefaultValueConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"number-inc-dec",defaultValueEditorOptions:{min:-340282347e30,max:340282347e30,step:1},defaultValueConverter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,useGrouping:!1}}}}},customValidatorTypes:["numrange"]},radiobuttonset:{tip:null,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,noFormat:!0,useGrouping:!1}},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"required"},{type:"numrange",options:{min:-340282347e30,max:340282347e30}}],converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,useGrouping:!1}}}},customValidatorTypes:[]},"single-selectbox":{tip:null,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,noFormat:!0,useGrouping:!1}},editorOptions:{multiple:!1,select2Options:{}},editorConfig:{configView:"CaasOptionsConfigView",configOptions:{allowMultipleSelect:!1,validators:[{type:"required"},{type:"numrange",options:{min:-340282347e30,max:340282347e30}}],converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,useGrouping:!1}}}},customValidatorTypes:[]}},defaultEditor:"number-inc-dec",defaultViewer:"text",validators:[],customValidators:[{type:"numrange",defaultOptions:{validateOnEachValue:!0},label:"CAAS_NUMBER_RANGE_VALIDATION_LABEL",configView:"CaasNumberRangeValidatorConfigView",configOptions:{min:-340282347e30,max:340282347e30,minDefault:-1e9,maxDefault:1e9,converter:{type:"number",options:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:6,formatDuringParse:!0,useGrouping:!1}}}}]},boolean:{allowMultiValue:!1,editors:{"boolean-switch":{tip:null,editorOptions:{},editorConfig:{configView:"CaasBooleanLabelConfigView",configOptions:{maxLabelLength:30,defaultValueSettings:{defaultValueEditor:"boolean-switch",defaultValueEditorOptions:{labels:{on:"True",off:"False"},id:"default-boolean-value"}}}}},"boolean-checkbox":{tip:null,editorOptions:{},editorConfig:{configView:"CaasBooleanCheckboxLabelConfigView",configOptions:{defaultValueSettings:{defaultValueEditor:"boolean-switch",defaultValueEditorOptions:{labels:{on:"True",off:"False"},id:"default-boolean-value"}}}}}},defaultEditor:"boolean-switch",defaultViewer:"text",defaultEmptyValue:!0,validators:[]},json:{allowMultiValue:!1,editors:{"json-textarea":{tip:null,editorConfig:{configView:"CaasJSONOptionsConfigView",configOptions:{editorType:"textarea"}}},"json-form":{tip:null,editorConfig:{configView:"CaasJSONOptionsConfigView",configOptions:{editorType:"json-form"}}}},defaultEditor:"json-textarea",defaultViewer:"text",defaultEmptyValue:"",validators:[{type:"isJSON"}]}},endpoints:{serverURL:"/content/management/api/v1.1",publishedServerURL:"/content/published/api/v1.1",previewServerURL:"/content/preview/api/v1.1",items:"/items",types:"/types",master:"/master",assets:"/assets",variations:"/variations/language",variationset:"/variationsets",token:"/token",slugQueriesURL:"/items",recommendations:"/personalization/recommendations",recommendationResults:"/personalization/recommendationResults",recommendationResultsById:"/personalization/recommendationResults/.by.id",audienceAttributes:"/personalization/audienceAttributes",categories:"/personalization/categories",targetedchannel:"/jobs/channels",translationJobs:"/translationJobs",helpURL:"/swagger-ui/index.html",typesURLTarget:"#/Types",integrationServerUrl:"/system/api/v1/integration",rankingpolicies:"/search/rankingPolicies"},commonAttributes:{url_slug:"url_slug"},systemDefinedCategoriesForCT:[{category:"Default",categoryLabel:"CAAS_CONTENT_CATEGORY_ITEM_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_LAYOUT_DEFAULT_HINT"},{category:"Content List Default",categoryLabel:"CAAS_CONTENT_CATEGORY_LIST_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_LAYOUT_LIST_DEFAULT_HINT"},{category:"Empty Content List Default",categoryLabel:"CAAS_CONTENT_CATEGORY_EMPTY_LIST_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_LAYOUT_EMPTY_LIST_HINT"},{category:"Content Placeholder Default",categoryLabel:"CAAS_CONTENT_CATEGORY_PLACEHOLDER_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_LAYOUT_PLACEHOLDER_DEFAULT_HINT"}],systemDefinedCategoriesForCDA:[{category:"Default",categoryLabel:"CAAS_CONTENT_CATEGORY_ASSET_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_CDA_LAYOUT_DEFAULT_HINT"},{category:"Content List Default",categoryLabel:"CAAS_CONTENT_CATEGORY_LIST_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_CDA_LAYOUT_LIST_DEFAULT_HINT"},{category:"Empty Content List Default",categoryLabel:"CAAS_CONTENT_CATEGORY_EMPTY_LIST_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_LAYOUT_EMPTY_LIST_HINT"},{category:"Content Placeholder Default",categoryLabel:"CAAS_CONTENT_CATEGORY_PLACEHOLDER_DEFAULT",layoutMessage:"CAAS_TYPE_EDITOR_CDA_LAYOUT_PLACEHOLDER_DEFAULT_HINT"}]}})),define("docs/notification/template/ProgressDetailsRow.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="progress-details-table" role="group">\t<div class="progress-details-row">\t\t<div class="progress-details-cell progressItemIcon">\t\t\t<div class="folderIcon"><img src="'+(null==(__t=item.get("img"))?"":_.escape(__t))+'" alt=""/></div>\t\t\t<div class="fileIcon">\t\t\t',thumbDetails&&thumbDetails.thumbUxIcon?__p+='\t\t\t\t<span class="iconmap-ui-icon oj-ux-icon '+(null==(__t=thumbDetails.thumbUxIcon)?"":_.escape(__t))+'"></span>\t\t\t':__p+='\t\t\t\t<img src="'+(null==(__t=item.get("img"))?"":_.escape(__t))+'" alt=""/>\t\t\t',__p+='\t\t\t</div>\t\t</div>\t\t<div class="progress-details-cell upload-file-info">\t\t\t<div class="progressItemDetails">\t\t\t\t<span class="progressItemName">'+(null==(__t=name)?"":__t)+'</span>\t\t\t\t<span class="progressItemSize">'+(null==(__t=displaySize)?"":_.escape(__t))+'</span>\t\t\t\t<span class="progressItemType">'+(null==(__t=overlayText)?"":_.escape(__t))+'</span>\t\t\t\t<div class="progressItemErrorText"></div>\t\t\t</div>\t\t</div>\t\t<div class="progress-details-cell progressItemStatusIcon">\t\t\t<span class="progressItemDone"><span class="progress-msg-icon progress-msg-icon-success" title="'+(null==(__t=i18n.t("IMG_ALT_SUCCESS"))?"":_.escape(__t))+'"></span></span>\t\t\t<span class="progressItemError"><span class="progress-msg-icon progress-msg-icon-error" title="'+(null==(__t=i18n.t("IMG_ALT_ERROR"))?"":_.escape(__t))+'"></span></span>\t\t\t<span class="progressItemWarning"><span class="progress-msg-icon progress-msg-icon-warning" title="'+(null==(__t=i18n.t("IMG_ALT_WARNING"))?"":_.escape(__t))+'"></span></span>\t\t\t<span class="progressItemCancel" role="button" tabindex="0" aria-label="'+(null==(__t=i18n.t("GENERAL_CMD_CANCEL"))?"":_.escape(__t))+" "+(null==(__t=name)?"":_.escape(__t))+'" ><span class="athena-icon-16 athena-icon-16-close" title="'+(null==(__t=i18n.t("GENERAL_CMD_CANCEL"))?"":_.escape(__t))+'"></span></span>\t\t</div>\t</div></div>';return __p}})),define("docs/notification/template/ProgressViewLink.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a href="'+(null==(__t=href)?"":_.escape(__t))+'" class="osn-clickable osn-link">'+(null==(__t=name)?"":__t)+"</a>";return __p}})),
/*!
 * jQuery UI Progressbar 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
function(e){"use strict";"function"==typeof define&&define.amd?define("jqueryui-amd/widgets/progressbar",["jquery","../version","../widget"],e):e(jQuery)}((function(e){"use strict";return e.widget("ui.progressbar",{version:"1.13.2",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=e("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(e){if(void 0===e)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})})),define("common/notification/view/ProgressDetailRow",["jquery","underscore","backbone","docs/notification/template/ProgressDetailsRow.template","docs/notification/template/ProgressViewLink.template","core/util/Utils","core/util/Globals","jqueryui-amd/widgets/progressbar"],(function(e,t,i,s,n){"use strict";var o=docs.common.Globals,a=["error","finished-with-error","canceled","aborted","skipped"],r=["finished"];return docs.views.ProgressDetailRow=i.View.extend({tagName:"li",className:"progress-details",events:{},initialize:function(e){return t.bindAll(this,"_keydownOnCancel","cancelOperation"),this.parentView=e.parentView,this.listenTo(this.model,"change:uploadState",this._updateState),this.listenTo(this.model,"change:errorMsg",this._updateState),this.listenTo(this.model,"change:percentComplete",this._percentCompleteChanged),this.render()},render:function(){var t=s,i=this.model.get("thumbDetails");return e(this.el).html(t({i18n:docs.i18n,name:docs.views.ProgressDetailRow.getFilenameForDisplay(this.model.get("name")),item:this.model,thumbDetails:i,displaySize:this.model.hasSizeData()?docs.common.Utils.getBytesDisplay(this.model.get("size")):"",overlayClass:i&&i.overlayClass?i.overlayClass:"",overlayText:i&&i.overlayText?i.overlayText:""})),e(this.el).attr("tabindex","-1"),i&&i.overlayClass?e(".folderIcon",this.el).toggle(!1):e(".fileIcon",this.el).toggle(!1),this._updateLocationLink(),this._setupProgressBar(),this._setActiveDisplay(),this._setCancelDisplay(),this._setErrorDisplay(),this._setAriaLabel(),this.$el.find(".progressItemCancel").off(".cancel").on("click.cancel",this.cancelOperation).on("keydown.cancel",this._keydownOnCancel),this},_getLocationLink:function(){var e,t=this.options.linkTemplate?this.options.linkTemplate:n,i=docs.views.ProgressDetailRow.getFilenameForDisplay(this.model.get("name")),s=this.model.get("noLink");if((this.model.get("locationLinkStates")||r).indexOf(this.model.get("uploadState"))>-1&&!s){var a=this.model.get("locationLink")||this.model.getLocationLink&&this.model.getLocationLink();if(a)e="function"==typeof a.then?a.then((function(e){return t({href:e,name:i})})):t({href:a,name:i});else if(o.embed||o.isAppLink||this.options.skipLinks)e=i;else{var l;l=this.options.fileviewHref?this.options.fileviewHref(this.model):o.routerRoot+"fileview/"+this.model.get("id"),e=t({href:l,name:i})}}else e=i;return e},_updateState:function(){this._updateLocationLink(),this._updateProgressBar(),this._setActiveDisplay(),this._setCancelDisplay(),this._setErrorDisplay(),this._setAriaLabel()},_updateLocationLink:function(){var e=this;function t(t){e.$el.find(".progressItemName").html(t)}var i=this._getLocationLink();"function"==typeof i.then?i.then((function(e){t(e)})):t(i)},_setupProgressBar:function(){var t=e('<div class="progressBar"></div>');e(this.el).append(t),t.progressbar({value:this.model.get("percentComplete")}),this.hasProgressBar=!0,this.$(".progressBar").attr("aria-hidden",!0),this.$(".ui-progressbar-value").removeClass("ui-widget-header ui-corner-left ui-corner-right")},_hideProgressBar:function(){!0===this.hasProgressBar&&(this.$(".progressBar").progressbar("destroy"),this.hasProgressBar=void 0)},_percentCompleteChanged:function(){this._updateProgressBar(),this.model.get("percentComplete"),this.model.get("maxPctDisplayed"),this.$(".progressItemCancel").hide()},_updateProgressBar:function(){!0===this.hasProgressBar&&(this.$(".progressBar").progressbar({value:this.model.get("percentComplete")}),this.$(".progressBar").attr("aria-hidden",!0),this.$(".ui-progressbar-value").removeClass("ui-widget-header ui-corner-left ui-corner-right")),this._setAriaLabel()},_setActiveDisplay:function(){"finished"===this.model.get("uploadState")||this._hasError()||"active"===this.model.get("uploadState")?this.$el.toggleClass("progressItemInactive",!1):this.$el.toggleClass("progressItemInactive",!0)},_setCancelDisplay:function(){this.model.get("unCancelable")||"finished"===this.model.get("uploadState")||"aborted"===this.model.get("uploadState")||this.model.get("percentComplete")>=this.model.get("maxPctDisplayed")||this._hasError()?this.$el.find(".progressItemCancel").hide():this.$el.find(".progressItemCancel").show()},_setErrorDisplay:function(){"finished"===this.model.get("uploadState")?(this.$el.find(".progressItemDone").show(),this.$el.find(".progressItemError").hide(),this.$el.find(".progressItemWarning").hide(),this._hideProgressBar(),this.$el.addClass("success")):"warning"===this.model.get("uploadState")?(this.$el.find(".progressItemDone").hide(),this.$el.find(".progressItemError").hide(),this.$el.find(".progressItemWarning").show(),this._hideProgressBar(),this.$el.addClass("error"),this.$(".progressItemErrorText").text(this.model.get("warningMsg"))):this._hasError()?(this.$el.find(".progressItemDone").hide(),this.$el.find(".progressItemError").toggle(!this.options.showErrorAsWarning),this.$el.find(".progressItemWarning").toggle(!!this.options.showErrorAsWarning),this._hideProgressBar(),this.$el.addClass("error"),this._addError()):(this.$el.find(".progressItemDone").hide(),this.$el.find(".progressItemError").hide(),this.$el.find(".progressItemWarning").hide())},_hasError:function(){return a.indexOf(this.model.get("uploadState"))>-1},_addError:function(){var e=this.model.getErrorMessage().message;this.$el.find(".progressItemErrorText").html(e)},_keydownOnCancel:function(t){var i=t.keyCode||t.which;i!==e.ui.keyCode.ENTER&&i!==e.ui.keyCode.SPACE||this.cancelOperation(t)},cancelOperation:function(e){e&&(e.stopPropagation(),e.preventDefault()),this.model.cancel()},_setAriaLabel:function(){var t=docs.views.ProgressDetailRow.getFilenameForDisplay(this.model.get("name"))+" ";if(this.model.hasSizeData()&&(t+=docs.common.Utils.getBytesDisplay(this.model.get("size"))+" "),"finished"===this.model.get("uploadState"))t+=docs.i18n.t("IMG_ALT_SUCCESS");else if(this._hasError()){t+=docs.i18n.t("IMG_ALT_ERROR");var i=this.model.getErrorMessage().message;i&&(t+=":"+i)}else this.hasProgressBar&&this.model.get("percentComplete")?t+=docs.i18n.t(this.parentView&&"prepareBulkDownload"===this.parentView.model.get("action")?"PREPARE_DOWNLOAD_PERCENT_PROGRESS":"UPLOAD_PERCENT_PROGRESS",this.model.get("percentComplete")):t+=docs.i18n.t(this.parentView&&"prepareBulkDownload"===this.parentView.model.get("action")?"PREPARE_DOWNLOAD_WAITING":"UPLOAD_WAITING");e(this.el).find(".progress-details-table").attr("aria-label",t)}},{getFilenameForDisplay:function(e){return e=t.escape(e)}}),docs.views.ProgressDetailRow})),define("docs/notification/template/ProgressDetails.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="progressDetailHeader">\t<div class="progressSubTitle">\t\t<span class="dialog-label">'+(null==(__t=subTitle)?"":_.escape(__t))+"</span> "+(null==(__t=link)?"":__t)+'\t</div></div><ul class="operationList" tabindex="0" aria-label="'+(null==(__t=operationListLabel)?"":_.escape(__t))+'"></ul>';return __p}})),define("common/notification/view/ProgressDetails",["jquery","underscore","core/view/BaseViewWithLogging","core/util/Utils","core/util/Globals","core/dialog/MessageDialog","common/notification/view/ProgressDetailRow","core/dialog/OJDialog","docs/notification/template/ProgressViewLink.template","docs/notification/template/ProgressDetails.template"],(function(e,t,i,s,docs,n,o,a,r,l){"use strict";var u=docs.common.Globals;return docs.views.ProgressDetails=i.extend({objectName:"ProgressDetail",className:"dlgProgressDetail",cancelButtonText:docs.i18n.t("GENERAL_CMD_CANCEL_ALL"),dialogClassName:function(){return this.options.dialogClass+(this.options.hideCancelAll||this.model.get("unCancelable")?"":" cancelable")},width:function(){return this.getResizeValues().width},minWidth:325,minHeight:188,maxHeight:660,buttons:function(){return[{text:this.cancelButtonText,chroming:null,id:"cancelBtn",click:this.cancelOperation,class:"uploadCancelAll"},{text:docs.i18n.t("GENERAL_CMD_HIDE"),chroming:"callToAction",id:"hideBtn",autofocus:!0,click:this.onHide,class:"ui-button-primary detail-close-button"}]},title:function(){return this.getTitle()},initialize:function(e){return e.dialogClass="spaceBetweenFooterButtons",i.prototype.initialize.call(this,e),null!==e.progress&&void 0!==e.progress?this.progress=e.progress:this.progress=!1,t.bindAll(this,"onOpen","onBeforeOpen","cancelOperation","onHide"),this.listenTo(this.model,"change",this.changeCancelButton),this.listenTo(this.model,"change",this.changeTitle),this.listenTo(this.model,"remove",this.render),this.listenTo(this.model,"remove",this.changeTitle),this},onHide:function(){this.close()},render:function(){var i,n,a=this.options.linkTemplate?this.options.linkTemplate:r,d=this.model.getParentModel(),c=d&&d.id||null,h=d&&d.name||null;if(d)if(d.isCollection)t.noop();else if(d.isFile)i=docs.i18n.t("FILE"),n=h;else if(d.isAsset)i=docs.i18n.t("ASSET_LABEL"),n=h;else if(d.isRepository)i=docs.i18n.t("REPOSITORY_LABEL"),n=h;else if(h)if(i=this.options.dialogStrings?docs.i18n.t(this.options.dialogStrings.detailsLocationLabel):docs.i18n.t("FOLDER"),u.embed||u.isAppLink||this.options.skipLinks)n=h;else{var p="";c&&(p=this.options.locationHref?this.options.locationHref(c):s.getLocation(c)),n=a({href:p,name:h})}else t.noop();else if(t.isFunction(this.model.getLocationLink)){var g=this.model.getLocationLink();i=docs.i18n.t(g.locType),n=a({href:g.href,name:g.name})}var m=(this.template||l)({i18n:docs.i18n,subTitle:i,link:n,operationListLabel:this.operationListLabel});e(this.el).html(m),!n&&this.model.get("unCancelable")&&e(this.el).find(".progressDetailHeader").toggle(!1);for(var f=0;f<this.model.items.length;f++){var _=new o({model:this.model.items.at(f),parentView:this,linkTemplate:this.options.linkTemplate,fileviewHref:this.options.fileviewHref,skipLinks:this.options.skipLinks,showErrorAsWarning:this.options.showErrorAsWarning});this.$el.children(".operationList").append(_.el)}return e(":focusable",this.$el).focus(),this},getDialog:function(){return this.$dialog&&this.$dialog.length||(this.$dialog=this.$el.closest("oj-dialog, .ui-dialog")),this.$dialog},getCancelButton:function(){return this.getDialog().find(".uploadCancelAll")},changeCancelButton:function(){this.options.hideCancelAll?this.getCancelButton().hide():this.model.get("unCancelable")?this.getCancelButton().toggle(!1):this.model.uploadsPending()&&this.model.get("percentComplete")<this.model.get("maxPctDisplayed")?this.enableButton("cancelBtn",!0):this.enableButton("cancelBtn",!1)},getTitle:function(){return this.model.getTitle()},changeTitle:function(){var e=this.getTitle();null!==e&&this.getDialog().find("span.ui-dialog-title, .oj-dialog-title").html(e)},onBeforeOpen:function(){this.changeCancelButton(),this.changeTitle()},details:!0,onOpen:function(){var t=this.$el.getDialogHeight(),i=e(".operationList",this.$el).innerHeight();this.diffListAndDialog=t-i;this.getDialog().find("#hideBtn").focus()},cancelOperation:function(e){e&&(e.stopPropagation(),e.preventDefault()),n.show({addClass:this.cancelDlgClasses,title:this.cancelDlgTitle,message:this.cancelDlgMessage,cancelButtonText:docs.i18n.t("NO"),cancelCallback:t.noop,okButtonText:docs.i18n.t("YES"),callback:this.model.cancelOperation||this.model.cancelUpload})},getResizeValues:function(){var t={width:550};return e("#osn-view-main").width()<560&&(t.width=320),t}},{show:function(e){return e.DialogClass=e.DialogClass||docs.views.ProgressDetails,a.show(e)}}),docs.views.ProgressDetails})),define("docs/template/UploadProgressDetails.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="progressDetailHeader">\t<div class="subTitle uploadDestination">\t\t<span class="dialog-label">'+(null==(__t=subTitle)?"":_.escape(__t))+"</span> "+(null==(__t=link)?"":__t)+'\t</div></div><ul class="operationList" tabindex="0" aria-label="'+(null==(__t=i18n.t("UPLOAD_LIST_LABEL"))?"":_.escape(__t))+'"></ul>';return __p}})),define("common/upload/view/UploadProgressDetails",["jquery","underscore","common/notification/view/ProgressDetails","core/dialog/OJDialog","docs/template/UploadProgressDetails.template"],(function(e,t,i,s,n){"use strict";return docs.upload.UploadProgressDetails=i.extend({objectName:"UploadProgressDetail",template:n,operationListLabel:docs.i18n.t("UPLOAD_LIST_LABEL"),cancelDlgTitle:docs.i18n.t("UPLOAD_CANCEL_TITLE"),cancelDlgMessage:docs.i18n.t("UPLOAD_CANCEL_MSG"),cancelDlgClasses:"cancelUpload"},{show:function(e){return e.DialogClass=docs.upload.UploadProgressDetails,s.show(e)}}),docs.upload.UploadProgressDetails})),define("common/upload/model/ProgressMessages",["jquery","underscore","core/util/Globals","core/util/Service"],(function(e,t,docs,i){"use strict";var s=docs.common.Globals,n={uploadCanceledWithLocation:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_CANCELED","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_CANCELED"],uploadCanceledWithLocationNoneFinished:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_CANCELED_NONE_FINISHED","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_CANCELED"],uploadCanceledNoLocation:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_CANCELED_NO_LOCATION","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_CANCELED_NO_LOCATION"],uploadCanceledNoLocationNoneFinished:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_CANCELED_NO_LOCATION_NONE_FINISHED","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_CANCELED_NO_LOCATION"],uploadingWithLocationAndProgress:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_PCT","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_PCT"],uploadingWithLocationNoProgress:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM"],uploadingWithProgressNoLocation:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_PCT_NO_LOCATION","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_PCT_NO_LOCATION"],uploadingNoProgressNoLocation:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_NO_LOCATION","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_NO_LOCATION"],finishedSingleUpdate:["UPLOAD_PROGRESS_STATUS_NEW_VERSION_COMPLETE","UPLOAD_PROGRESS_STATUS_NEW_VERSION_COMPLETE"],finishedSingleUpdateNoLocation:["UPLOAD_PROGRESS_STATUS_NEW_VERSION_COMPLETE_NO_LOCATION","UPLOAD_PROGRESS_STATUS_NEW_VERSION_COMPLETE_NO_LOCATION"],finishedNoSuccess:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_NOT_SUCCESSFUL","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_NOT_SUCCESSFUL"],finishedNoSuccessNoLocation:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_NOT_SUCCESSFUL_NO_LOCATION","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_NOT_SUCCESSFUL_NO_LOCATION"],finishedUpload:["UPLOAD_PROGRESS_STATUS_MULTI_ITEMS_COMPLETE","UPLOAD_PROGRESS_STATUS_SINGLE_ITEM_COMPLETE"]},o={getMessageText:function(e){var n,o;if(e.status.canceled)o=e.links.locationLink?this.getMessage(0===e.items.finished?"uploadCanceledWithLocationNoneFinished":"uploadCanceledWithLocation",e.links.fileLink,e.messageStrings):this.getMessage(0===e.items.finished?"uploadCanceledNoLocationNoneFinished":"uploadCanceledNoLocation",e.links.fileLink,e.messageStrings),n=docs.i18n.t(o,e.items.finished,e.items.total,e.links.locationLink,e.links.fileLink);else if(e.status.pending)o=e.links.locationLink?e.supportsProgress?this.getMessage("uploadingWithLocationAndProgress",e.links.fileLink,e.messageStrings):this.getMessage("uploadingWithLocationNoProgress",e.links.fileLink,e.messageStrings):e.supportsProgress?this.getMessage("uploadingWithProgressNoLocation",e.links.fileLink,e.messageStrings):this.getMessage("uploadingNoProgressNoLocation",e.links.fileLink,e.messageStrings),n=docs.i18n.t(o,e.items.currentIndex,e.items.total,e.links.locationLink,e.items.percentage,e.links.fileLink);else{var a=e.items.total-e.items.error-e.items.canceled;if(e.items.finished>0)if(1===e.items.finished&&1===e.items.total){var r;if(s.embed||s.isAppLink||e.skipLinks)e.links.fileLink=i.breakWords(e.item.get("name"));else r=e.fileviewHref?e.fileviewHref(e.item):s.routerRoot+"fileview/"+e.item.get("id"),e.links.fileLink=e.linkTemplate({href:r,name:i.breakWords(e.item.get("name"))});o=t.isFunction(e.item.isUpdate)&&e.item.isUpdate()?this.getMessage(e.links.locationLink?"finishedSingleUpdate":"finishedSingleUpdateNoLocation",null,e.messageStrings):e.items.warning>0&&e.messageStrings.finishedWithWarning?this.getMessage("finishedWithWarning",e.links.fileLink,e.messageStrings):this.getMessage("finishedUpload",e.links.fileLink,e.messageStrings)}else o=e.items.warning>0&&e.messageStrings.finishedWithWarning?this.getMessage("finishedWithWarning",e.links.fileLink,e.messageStrings):this.getMessage("finishedUpload",e.links.fileLink,e.messageStrings);else o=this.getMessage(e.links.locationLink?"finishedNoSuccess":"finishedNoSuccessNoLocation",e.links.fileLink,e.messageStrings);n=docs.i18n.t(o,e.items.total,e.links.locationLink,a,e.links.fileLink)}return n},getMessage:function(e,t,i){return i=i||n,this._getMessageFormat(i[e],t)},_getMessageFormat:function(e,i){return e[t.isString(i)?1:0]}};return docs.upload.ProgressMessages=o,docs.upload.ProgressMessages})),define("common/plugin/jquery.stringformat",["jquery"],(function(e){"use strict";e.stringFormat=function(e){var t=arguments,i=function(e){var i=parseInt(e.slice(1),10);return t[i+1]};return e.replace(/\{\d+\}/g,i)}})),define("common/notification/view/UploadProgressBar",["jquery","underscore","core/view/BaseViewWithLogging","core/util/Globals","core/util/Utils","core/util/Service","core/dialog/MessageDialog","core/view/NotificationManager","common/upload/view/UploadProgressDetails","common/upload/model/ProgressMessages","docs/notification/template/ProgressViewLink.template","core/view/WebBarView.template","common/plugin/jquery.stringformat","jqueryui-amd/widgets/progressbar"],(function(e,t,i,docs,s,n,o,a,r,l,u,d){"use strict";var c=docs.common.Globals;return docs.views.UploadProgressBar=i.extend({objectName:"UploadProgressBar",attributes:function(){return{class:"webbar"}},initialize:function(e){return i.prototype.initialize.call(this,e),e||(e={}),null!==e.progress&&void 0!==e.progress?this.progress=e.progress:this.progress=!1,t.bindAll(this,"viewDetails","closeProgress","cancelUpload"),this.listenTo(this.model,"change",this._updateMessage),this.listenTo(this.model,"change:percentComplete",this._updateProgressBar),this.listenTo(this.model,"remove",this._updateMessage),this.messageNumber=a.getWebBarNumber(),this.options=this.options||{},this.options.skipLinks=this.options.skipLinks||a.getHasSkipLinks(),this.render(),a.addProgress(this),this},render:function(){e(this.el).html(d({i18n:docs.i18n,webBarId:docs.i18n.t("WEBBAR_ID_TEXT",this.messageNumber),closeTitle:docs.i18n.t("WEBBAR_CLOSE_TITLE",this.messageNumber)})),this.$(".wbCommands .wbDetails").html(docs.i18n.t("GENERAL_CMD_DETAILS",this.messageNumber));var t=e('<div class="progressBar"></div>').progressbar({value:0});return e(this.el).append(t),this.hasProgressBar=!0,this.$(".progressBar").attr("aria-hidden",!0),this.$(".ui-progressbar-value").removeClass("ui-widget-header ui-corner-left ui-corner-right"),this.$(".wbClose").on("click",this.closeProgress),this.options.hideCancel||this.$(".wbCommands .wbCancel").on("click",this.cancelUpload),this.$(".wbCommands .wbDetails").on("click",this.viewDetails),(!this.options.hideDetails||this.options.showDetailsOnError&&this.model.getErrorCount()>0)&&this.$(".wbCommands .wbDetails").show(),this.$(".wbErrorMsgPopup").hover(this.cancelCloseTimer,this.startCloseTimer),this._renderMessageAndButtons(),this},_renderMessageAndButtons:function(){var e,t=!1,i=this.model.finishedItems(),s=this.model.get("totalItems");this.model.uploadWasCanceled()?(e="athena-icon-16-warning",this.$(".wbCommands .wbCancel").hide(),this.$(".wbClose").show(),this._hideProgressBar(),t=!0):this.model.uploadsPending()?(e="athena-icon-16-uploading",this.options.hideCancelAll||this.$(".wbCommands .wbCancel").show(),this.$(".wbClose").hide()):(i>0?i<s||this.model.hasWarnings()?e="athena-icon-16-warning":(e="athena-icon-16-success",this.$el.addClass("wbSuccess")):e="athena-icon-16-error",this.$(".wbCommands .wbCancel").hide(),this.$(".wbClose").show(),this._hideProgressBar(),t=!0),this.$(".wbIcon .athena-icon-16").removeClass().addClass("athena-icon-16").addClass(e),this.$(".wbMessage div").empty().html(this.getBarMessage()),this.$(".wbMessage div").attr("aria-label",this.$(".wbMessage div").text()),this.model.get("percentComplete")>=this.model.get("maxPctDisplayed")&&this.$(".wbCommands .wbCancel").hide(),this._setErrorDisplay(),this.options.showDetailsOnError&&this.model.getErrorCount()>0&&this.$(".wbCommands .wbDetails").show();var n=this.$(".wbCommands .wbCommands-buttons").outerWidth();return this.$(".wbCommands").width(n),t},_hideProgressBar:function(){!0===this.hasProgressBar&&(this.$(".progressBar").progressbar("destroy"),this.hasProgressBar=void 0)},_setErrorDisplay:function(){this.model.uploadWasCanceled()||this.model.uploadsPending()||0!==this.model.finishedItems()?this.$el.removeClass("wbError"):this.$el.removeClass("wbSuccess").addClass("wbError")},_updateProgressBar:function(){!0===this.hasProgressBar&&(this.$(".progressBar").progressbar({value:this.model.get("percentComplete")}),this.$(".progressBar").attr("aria-hidden",!0),this.$(".ui-progressbar-value").removeClass("ui-widget-header ui-corner-left ui-corner-right"))},isFinished:function(){return this.model.isFinished()||this.model.uploadWasCanceled()},isFinishedWithoutError:function(){return this.model.isFinishedWithoutError()},cancelUpload:function(e){e&&(e.stopPropagation(),e.preventDefault()),o.show({title:docs.i18n.t("UPLOAD_CANCEL_TITLE"),message:docs.i18n.t("UPLOAD_CANCEL_MSG"),cancelButtonText:docs.i18n.t("NO"),cancelCallback:t.noop,okButtonText:docs.i18n.t("YES"),callback:this.model.cancelUpload})},closeProgress:function(e){e&&(e.stopPropagation(),e.preventDefault()),a.removeProgress(this)},onClose:function(){this.detailView&&this.detailView.close()},viewDetails:function(e){this.options.detailsView=this.options.detailsView||r;var t={DialogClass:this.options.detailsView,model:this.model,progress:this.progress,cid:this.cid+"_detail",linkTemplate:u,locationHref:this.options.locationHref,fileviewHref:this.options.fileviewHref,hideCancelAll:this.options.hideCancelAll,dialogStrings:this.options.dialogStrings,skipLinks:this.options.skipLinks};e&&(e.stopPropagation(),e.preventDefault()),this.detailView=this.options.detailsView.show(t)},showErrors:function(e){e&&(e.stopPropagation(),e.preventDefault()),this.cancelCloseTimer(),this.$(".wbErrorMsgPopup").show().position({my:"right-10 top",at:"right bottom",of:this.$(".wbErrors")})},hideErrors:function(e){e&&(e.stopPropagation(),e.preventDefault()),this.$(".wbErrorMsgPopup").hide()},startCloseTimer:function(){this.$(".wbErrorMsgPopup").is(":visible")&&(this.closetimer=window.setTimeout(this.hideErrors,500))},cancelCloseTimer:function(){this.closetimer&&(window.clearTimeout(this.closetimer),this.closetimer=null)},clickErrors:function(e){return e&&(e.stopPropagation(),e.preventDefault()),!1},getBarMessage:function(){var e,i,o=this.model.get("totalItems"),a={status:{canceled:this.model.uploadWasCanceled(),pending:this.model.uploadsPending()},item:this.model.items.models[0],items:{currentIndex:this.model.get("currentIndex"),finished:this.model.finishedItems(),warning:this.model.getWarningCount(),error:this.model.getErrorCount(),canceled:this.model.getCanceledCount(),total:o,percentage:this.model.get("percentComplete")},links:{},linkTemplate:u,supportsProgress:this.progress,messageStrings:this.model.getProgressStrings(),fileviewHref:this.options.fileviewHref,skipLinks:this.options.skipLinks},r=this.model.getParentModel();(1===o&&(e=this.model.items.models[0],a.links.fileLink=docs.views.UploadProgressBar.getFilenameForDisplay(t.unescape(e.get("name")))),!r||!r.id||-1!==r.id.indexOf("FLD_SEARCH:")||e&&e.get("digitalAssetUpload")||r.isFile||t.isEmpty(r.name))||(c.embed||c.isAppLink||this.options.skipLinks?a.links.locationLink=n.breakWords(r.name):(i=this.options.locationHref?this.options.locationHref(r.id):s.getLocation(r.id),a.links.locationLink=u({href:i,name:n.breakWords(r.name)})));return l.getMessageText(a)},getStatusMessage:function(){return e(".wbMessage",this.$el).text()},_updateMessage:function(){this._renderMessageAndButtons()?a.progressCompleted(this):docs.events.trigger("progress:update",this)}},{getFilenameForDisplay:function(e){return e=t.escape(e),n.breakWords(e)}}),docs.views.UploadProgressBar})),define("common/asset/AssetsJsonify",["jquery","underscore","core/util/Jsonify","core/util/Service","core/util/Session","core/util/Logger","core/plugin/jquery.bitparse"],(function(e,t,i,s,n){"use strict";var o={preview:1,read:2,write:4,update:8,delete:16,share:32};return t.extend({},i,{assetAllowedActions:o,fieldMap:t.extend(i.fieldMap,{channel:{id:"arChannelId",name:"arChannelName",description:"arChannelDescription",createdBy:"arChannelCreator",createdAt:"arChannelCreateDate",modifiedBy:"arChannelLastModifier",modifiedAt:"arChannelLastModifiedDate",isSiteChannel:{name:"arIsSiteChannel",type:"boolean"},channelAccess:"arChannelType",publishPolicy:"arPublishPolicy",localizationPolicy:"arLocalizationPolicy",requiredLanguages:{name:"requiredLanguages",type:"list-string",separators:","},optionalLanguages:{name:"optionalLanguages",type:"list-string",separators:","},allowedActions:{name:"dAllowedActions",mask:o}},connectorJobInfo:{connectorJobId:"connectorJobId",connectorJobTitle:"connectorJobTitle",connectorJobProgress:"connectorJobProgress",connectorJobStatus:"connectorJobStatus",creationDate:"creationDate",translationDate:"translationDate",statusMessage:"statusMessage",notificationData:"notificationData",assetValidationFileGUID:"assetValidationFileGUID"},assetX:{updatedBy:"fLastModifierFullName",isPublished:{name:"xARIsPublished",type:"boolean"},varSetId:"xARLanguageVariationSetId",name:{name:"fItemName",alt:"fFileName"},id:"xARCaaSGUID",docsId:{name:"fItemGUID",alt:"fFileGUID"},updatedDate:{name:"fLastModifiedDate",result:function(e){return{value:e,timezone:"UTC"}}},type:{name:"xARContentType",result:function(e){return t.isEmpty(e)&&(e="DigitalAsset"),e}},languageIsMaster:{name:"xARLanguageIsMaster",result:function(e,i){var s="0"!==e&&0!==e&&"false"!==e,n="0"!==i.xARIsTranslatable&&0!==i.xARIsTranslatable&&"false"!==i.xARIsTranslatable;return!t.isEqual(i.xARContentType,"DigitalAsset")&&n||(s=!0),s}},version:{name:"dRevLabel",result:function(e,t){return"0.1"}},status:{name:"xARApprovalStatus",type:"toLowerCase"},description:"fFileDescription",publishedChannels:{name:"xARPublishedChannels",result:function(e,s){var n=i.parseListString(e),o={data:[]};return t.each(n,(function(e){var t={id:e};o.data.push(t)})),o}},collections:{name:"xARCollections",result:function(e,s){var n=i.parseListString(e),o={data:[]};return t.each(n,(function(e){var t={id:e};o.data.push(t)})),o}},fileGroup:"dAssetFormatType",tags:{name:"xARTags",result:function(e,s){var n=i.parseListString(e),o=/^cecauto[^:]+:/,a={data:[]};return t.each(n,(function(e){var t=!1,i=e.match(o);i&&(t=!0,e=e.slice(i[0].length));var s={name:e,properties:{type:t?"auto":"manual"}};a.data.push(s)})),a}},createdDate:{name:"fCreateDate",result:function(e){return{value:e,timezone:"UTC"}}},channels:{name:"xARTargetedChannels",result:function(e,s){var n=i.parseListString(e),o={data:[]};return t.each(n,(function(e){var t={id:e};o.data.push(t)})),o}},createdBy:"fCreatorFullName",repositoryId:"fParentGUID",language:"xARLanguageValue",translatable:{name:"xARIsTranslatable",type:"boolean"}},advancedVideo:{name:"Name",id:"xARCaaSGUID",extension:"Extension",media_id:"EntryId",video_status:"Status",xduration:"Duration",xheight:"Height",xwidth:"Width"},backgroundJobStatus:{repositoryId:"repositoryId",repositoryName:"repositoryName",jobId:"jobId",status:{name:"jobStatus",type:"toLowerCase"},taskTotal:"totalNumberOfTask",taskSuccess:"successfullTask",taskFail:"failedTask"},taskInfo:{taskId:"taskId",sourceId:"itemId",status:"taskStatus",itemId:"assetIdentifier"},rendition:{rid:"extRenditionName",name:"extRenditionName",description:"extRenditionDescription",path:"extRenditionPath",originalName:"extRenditionOriginalName",params:"extRenditionParams",type:"extRenditionType"}}),parse_GET_RENDITION_LIST:function(e){this.convertToRealJson(e),s.setIdcToken(e);var t=e.ResultSets.UploadRenditions;return this.parseResultSet(t,"rendition",this.fieldMap.rendition)},parse_FLD_BROWSE_CHANNEL_ITEMS:function(e){this.convertToRealJson(e),s.setIdcToken(e),e.LocalData.TotalChildItemsCount=e.LocalData.TotalItemsCount,e.LocalData.hasMoreChildItems=!1;var i=e.ResultSets.Channels||e.ResultSets.Items,n=this.parseResultSet(i,"channel",this.fieldMap.channel);return t.each(n,(function(e){e.type="channel",e.application="channel",e.flags={isShared:!1}}),this),n},parse_AR_UPLOAD_DIGITAL_ASSET:function(e){var i;this.convertToRealJson(e),s.setIdcToken(e),e.ResultSets.AdvancedVideoInfo?((i=this.parseResultSet(e.ResultSets.AdvancedVideoInfo,"advancedVideo")[0]).isAdvancedVideo=!0,i.type="DigitalAsset",i.fileGroup="AdvancedVideos",i.isPublished=!1,i.status="draft",i.updatedDate={value:new Date(Date.now()).toGMTString(),timezone:"UTC"},i.createdDate=i.updatedDate,i.user=n.getUserLogin(),i.updatedBy=i.user,i.createdBy=i.user,e.LocalData&&(i.docsId=e.LocalData.fFileGUID,i.revision=e.LocalData.dRevisionID)):((i=this.parseResultSet(e.ResultSets.AssetInfo,"assetX")[0]).type="DigitalAsset",i.status=i.status||"draft");var o="0.1";return i.versionInfo={data:[{latestVersion:o}]},i.version=o,i.latestVersion=o,e.LocalData.repositoryId&&(i.repositoryId=e.LocalData.repositoryId),i.name=t.unescape(i.name),i},parse_AR_GET_BG_JOB_STATUS:function(e){this.convertToRealJson(e),s.setIdcToken(e);var i=this.parseLocalData(e.LocalData,void 0,this.fieldMap.backgroundJobStatus);return e.ResultSets.AssetInfo&&(i.items=this.parseResultSet(e.ResultSets.AssetInfo,"assetX"),t(i.items).each((function(e){e.type="DigitalAsset"}),this)),e.ResultSets.TaskInfo&&(i.tasks=this.parseResultSet(e.ResultSets.TaskInfo,"taskInfo")),i},mergeAssetMetadata:function(e,i){if(e.ResultSets.xARAssetMetaCollection){var s=t(e.ResultSets.xARAssetMetaCollection).indexBy("dIdentifier");i&&t(i).each((function(e){var i=e.fItemGUID||e.fFileGUID,n=s[i];n&&t(n).each((function(t,i){"dIdentifier"!==i&&(e[i]=t)}))}))}},parse_GET_CONNECTOR_JOB_INFO:function(e){this.convertToRealJson(e),s.setIdcToken(e);var t=this.parseResultSet(e.ResultSets.ConnectorJobInfo,"connectorJobInfo")[0];return t.connectorId=e.LocalData.connectorId,t.connectorName=e.LocalData.connectorName,t}})})),define("common/upload/model/ImageThumbWorker",[],(function(){"use strict";return function(){onmessage=function(e){var t=e.data;try{var i=new FileReaderSync;postMessage({result:i.readAsDataURL(t)})}catch(e){postMessage({result:"error"})}}}.toString().match(/function[^{]+\{([\s\S]*)\}$/)[1]})),define("common/upload/model/QueueItem",["jquery","underscore","backbone","core/util/Service","core/util/ErrorMsg","core/util/Globals","core/util/Utils","common/util/O365Edit","common/asset/AssetsJsonify","core/util/Thumbs","common/notification/model/Progressable","core/util/Session","common/upload/model/ImageThumbWorker","core/util/FeatureFlags"],(function(e,t,i,s,n,docs,o,a,r,l,u,d,c,h){"use strict";var p=URL.createObjectURL(new Blob([c],{type:"application/javascript"})),g=docs.common.Globals,m=1048576;function f(){_().useLogging&&console.log.apply(null,arguments)}var _=t.once((function(){function e(e,i,s,n,a,r){t.has(i,s)?!t.isNumber(i[s])||t.isNaN(i[s])?o.push(`"${s}" must be a number`):t.isNumber(n)&&t.isNumber(a)&&(i[s]<n||i[s]>a)?o.push(`"${s}" must be a number between ${n} and ${a}`):t.isNumber(n)&&i[s]<n?o.push(`"${s}" must be a number greater than or equal to ${n}`):e[s]=i[s]:t.isNumber(r)&&(e[s]=r)}function i(e,i,s){t.has(i,s)&&(t.isBoolean(i[s])?e[s]=i[s]:o.push(`"${s}" must be a must be a boolean (true or false)`))}var s,n=h("ChunkedUpload");if(t.isBoolean(n))return s=!0===n?{enabled:!0,maxConnections:2,minFileSize:0,maxRetries:3}:{enabled:!1};if(t.isString(n))try{n=JSON.parse(n)}catch(e){return s={configError:"Error with ChunkedUpload feature flag: *"+n+"* "+e.message,enabled:!1}}var o=[],a=[];return i(s={enabled:!0,maxConnections:2,minFileSize:0,maxRetries:3},n,"enabled"),e(s,n,"maxConnections",1,4),e(s,n,"minFileSize",0),i(s,n,"fixedConnections"),i(s,n,"forceTokenError"),i(s,n,"useLogging"),s.forceTokenError&&(e(s,n,"tokenErrorFreq",1,void 0,3),a.push("forcing token errors")),i(s,n,"forceServiceError"),s.forceServiceError&&(e(s,n,"serviceErrorFreq",1,void 0,4),a.push("forcing service errors")),o.length>0&&(s.usageMessage=o.join("\n")),a.length>0&&(s.devMessage=a.join("\n")),s}));var v="stopped",C="active",b="canceled",E="error",S="finished",T="finished-with-error",I="warning",D=i.Model.extend({className:"UploadChunk",stopUpload:function(){this.xhr&&this.xhr.abort(),t.contains([D.STATUS.PENDING,D.STATUS.ERROR],this.get("status"))&&this.set({status:D.STATUS.CANCELED})},start:function(){this.get("progress").timeBegin=(new Date).getTime(),this.set({status:D.STATUS.UPLOADING})},setChunkError:function(e,t){this.set({response:t,status:D.STATUS.ERROR}),this.get("progress").timeEnd=(new Date).getTime(),delete this.xhr},setChunkComplete:function(e){this.set({response:e,objectName:e.LocalData.dObjectName,status:D.STATUS.COMPLETE}),this.get("progress").timeEnd=(new Date).getTime(),delete this.xhr},getProgressData:function(){var e={bytesLoaded:0,totalBytes:this.get("size")};if(this.has("progress")){var i=this.get("progress");t.contains([D.STATUS.UPLOADING,D.STATUS.COMPLETE],this.get("status"))&&(e.bytesLoaded=i.bytesLoaded?i.bytesLoaded:0),e.totalBytes=i.totalBytes?i.totalBytes:this.get("size")}return e},getLogData:function(){var e=this.get("progress"),t=e.totalBytes/m,i=(e.time100-e.timeBegin)/1e3,s=(e.timeEnd-e.timeBegin)/1e3;return{id:this.get("sequenceId"),status:this.get("status"),retries:this.has("errorCount")?this.get("errorCount"):0,Mb_Loaded:e.bytesLoaded/m,total_Mm:t,pct_Comp:e.percentComplete,time_Upload:i,time_Server:(e.timeEnd-e.time100)/1e3,time_Total:s,Mbps_Upload:t/i,Mbps_Total:t/s}},getTimingData:function(){var e,i=[],s=0;return this.has("failedAttempts")&&t.each(this.get("failedAttempts"),t.bind((function(t){s++,e=this.get("sequenceId")+"-"+s,this._addAttemptProgress(i,t.progress,e)}),this)),s++,e=this.get("sequenceId")+"-"+s,this._addAttemptProgress(i,this.get("progress"),e),i},_addAttemptProgress:function(e,i,s){i.addedStart||(i.timings.splice(0,0,{time:i.timeBegin,bytesLoaded:0}),i.addedStart=!0);for(var n=0;n<i.timings.length;n++){var o=i.timings[n];if(0===n)e.push(t.extend({},o,{seq:s}));else{var a=i.timings[n-1],r=(o.bytesLoaded-a.bytesLoaded)/m,l=(o.time-a.time)/1e3,u=r/l;e.push(t.extend({},o,{seq:s},{deltaMb:r,deltaTs:l,Mbps:u}))}}}},{STATUS:{PENDING:"pending",UPLOADING:"uploading",COMPLETE:"complete",ERROR:"error",FAILED:"failed",CANCELED:"cancelled"}}),w=i.Collection.extend({model:D,setFile:function(e){if(this.file=e,this.isEmpty()){var t=this.file.size;this.chunkSize=w.getChunkSize(t),this.totalChunks=Math.ceil(t/this.chunkSize);for(var i=0;i<this.totalChunks;i++){var s=i*this.chunkSize,n=s+this.chunkSize,o=this.file.slice(s,n),a=new D({sequenceId:(i<10?"seq0":"seq")+i,start:s,end:s+o.size,size:o.size,blob:o,status:D.STATUS.PENDING,progress:{timings:[]}});this.add(a)}}},canStartNextChunk:function(){var e=this.numActiveChunks();return 0===e||e+this.numErrorChunks()<this.getMaxActiveChunks()},numActiveChunks:function(){return this.where({status:D.STATUS.UPLOADING}).length},numErrorChunks:function(){return this.where({status:D.STATUS.ERROR}).length},getMaxActiveChunks:function(){return _().maxConnections},numCompletedChunks:function(){return this.where({status:D.STATUS.COMPLETE}).length},isUploadComplete:function(){return this.numCompletedChunks()===this.totalChunks},getNextUploadChunk:function(){var i=e.Deferred();return t.defer(t.bind(this._getNextUploadChunk,this),i),i.promise()},_getNextUploadChunk:function(e){if(this.queueItem.get("uploadState")===C){var i=this.findWhere({status:D.STATUS.ERROR});if(i){var n=s.checkResponseForError(i.get("response")),o=i.has("errorCount")?i.get("errorCount")+1:1;if(o<=_().maxRetries){var a=i.get("failedAttempts")||[];a.push({progress:i.get("progress"),response:i.get("response")}),i.set({progress:{timings:[]},response:void 0,errorCount:o,status:D.STATUS.UPLOADING,failedAttempts:a});var r=this._isNetworkError(n)?1e4:5e3;return void t.delay(this._startChunk,r,i,e)}return i.set({status:D.STATUS.FAILED}),this.queueItem.set("uploadState",E),this.queueItem.set("errorMsg","File chunk failed to upload.\n"+n.errorMsg),this.queueItem.stopUpload(),void e.reject()}i=this.findWhere({status:D.STATUS.PENDING}),this._startChunk(i,e)}else e.reject()},_isNetworkError:function(e){return t.isObject(e)&&"!clouduiUnexpectedServerError"===e.errorMsgKey},_startChunk:function(e,t){var i,s,n,o;e&&e.collection.queueItem.get("uploadState")===C?(f((i=new Date,s=i.getHours(),n=i.getMinutes(),o=i.getSeconds(),"["+(s<10?"0"+s:s)+":"+(n<10?"0"+n:n)+":"+(o<10?"0"+o:o)+"."+("00"+i.getMilliseconds()).slice(-3)+"] "),"start chunk",JSON.parse(JSON.stringify(e))),e.start(),t.resolve(e)):t.reject()},stopUpload:function(){var t=e.Deferred();return this.each((function(e){e.stopUpload()})),this._checkChunksFinished(t),t.promise()},_checkChunksFinished:function(e,i){0===this.numActiveChunks()?e.resolve():(i=i?i+1:1)<60?t.delay(t.bind(this._checkChunksFinished,this),1e3,e):(f("failed to reach finished state"),e.resolve())},computeProgressData:function(){var e={bytesLoaded:0,totalBytes:0};return this.each((function(t){var i=t.getProgressData();e.bytesLoaded+=i.bytesLoaded,e.totalBytes+=i.totalBytes})),e.percentComplete=100*e.bytesLoaded/e.totalBytes,e},adjustProgressData:function(e){var t=(new Date).getTime(),i=this.findWhere({sequenceId:e.sequenceId});if(i){var s=i.get("progress");s.timings.push({time:t,bytesLoaded:e.bytesLoaded}),s.bytesLoaded=e.bytesLoaded,s.totalBytes=e.totalBytes,s.percentComplete=e.percentComplete,100===s.percentComplete&&(s.time100=(new Date).getTime())}var n=this.computeProgressData();e.bytesLoaded=n.bytesLoaded,e.totalBytes=n.totalBytes,e.percentComplete=n.percentComplete},getChunkDataRS:function(){var e={name:"ChunkData",fields:[{name:"dObjectName"},{name:"StartIndex"},{name:"Length"}],rows:[]};return this.each((function(t){e.rows.push([t.get("objectName"),0,t.get("size")])})),e},getDeleteChunkDataRS:function(){var e=[];if(this.each((function(t){t.has("objectName")&&e.push([t.get("objectName")])})),e.length>0)return{name:"ChunkData",fields:[{name:"dObjectName"}],rows:e}},logChunkData:function(){if(_().useLogging){var e=this.map((function(e){return e.getLogData()}));console.table(e)}},logChunkTimingData:function(){if(_().useLogging){var e=[],i="Chunk Timing";console.groupCollapsed(i),this.each((function(i){var s=i.getTimingData();console.table(s),e=t.union(e,s)})),console.groupEnd(i),this.isChunkedUpload&&(i="Combined Chunk Timing",console.groupCollapsed(i),console.table(e),console.groupEnd(i))}}},{getChunkSize:function(e){var t=_();return t.fixedConnections?Math.min(Math.ceil(e/t.maxConnections),w.MAX_CHUNK_SIZE):e<w.SEGMENT.MB512?w.SIZE.MB8:e<w.SEGMENT.MB1024?w.SIZE.MB16:e<w.SEGMENT.MB2048?w.SIZE.MB32:e<w.SEGMENT.MB4096?w.SIZE.MB64:e<w.SEGMENT.MB8192?w.SIZE.MB128:e<w.SEGMENT.MB16384?w.SIZE.MB256:w.MAX_CHUNK_SIZE},SIZE:{MB8:8388608,MB16:16777216,MB32:33554432,MB64:67108864,MB128:134217728,MB256:268435456},SEGMENT:{MB512:536870912,MB1024:1073741824,MB2048:2147483648,MB4096:4294967296,MB8192:8589934592,MB16384:17116954624},MAX_CHUNK_SIZE:536870912,MAX_CHUNKS:1e4}),y={csCloudItemInsufficientPrivileges:{formatString:"ERROR_FOLDER_INSUFFICIENT_PRIVILEGE",args:0},csBillingAssetsCountOverLimit:{formatString:"ERROR_ASSET_COUNT_EXCEEDED",args:2},csBillingStorageOverLimit:{formatString:"ERROR_STORAGE_LIMIT_EXCEEDED",args:2}},A={csUnableToCheckIn:{causes:{csBlackListedExtension:{formatString:"ERROR_UNABLE_TO_UPLOAD_BLACKLIST",args:1},csFldNameNoConsecutiveSpaces:{formatString:"ERROR_CONSECUTIVE_SPACES_FILE",args:0},csItemNameNoSpacePrefix:{formatString:"ERROR_NAME_CONTAINS_SPACE_PREFIX",args:0},csMaxFileSizeExceeded:{formatString:"ERROR_MAX_FILE_SIZE_EXCEEDED",args:2},csFldQuotaSizeExceeded:{formatString:"ERROR_OWN_QUOTA_EXCEEDED",args:0},csFldItemInTrash:{formatString:"ERROR_CHECKIN_FOLDER_DELETED",args:0},csSecurityValidationFailed:{causes:{csFldDoesNotExist:{formatString:"ERROR_CHECKIN_FOLDER_DELETED",args:0}}},csCloudItemInsufficientPrivileges:{formatString:"ERROR_FOLDER_INSUFFICIENT_PRIVILEGE",args:0},csFldReservedUserNotMatched:{formatString:"ERROR_CHECKIN_FILE_RESERVED",args:0,responseArgs:["LocalData.fReservedByFullName"]},csCheckInFileInfected:{formatString:"ERROR_INFECTED_FILE",args:0},csUnabletoValidateCheckInFile:{formatString:"ERROR_CANNOT_VALIDATE_FILE",args:0},csFileIsNotClean:{formatString:"ERROR_CANNOT_VALIDATE_FILE",args:0},csPathSegmentContainsIllegalCharacter:{formatString:"ERROR_UNABLE_TO_UPLOAD_BAD_PATH",args:1},csBillingFilesCountOverLimit:{formatString:"ERROR_FILE_COUNT_EXCEEDED",args:2},csBillingStorageOverLimit:{formatString:"ERROR_STORAGE_LIMIT_EXCEEDED",args:2}},defaultMsg:{formatString:"ERROR_UNABLE_TO_UPLOAD_FILE",args:0}}},L={csUnableToCheckIn:{causes:{csFldQuotaSizeExceeded:{formatString:"ERROR_OWN_QUOTA_EXCEEDED",args:0}}}},O={csUnableToCheckIn:{causes:{csFldQuotaSizeExceeded:{formatString:"ERROR_OTHER_QUOTA_EXCEEDED",args:0,responseArgs:["LocalData.fParentName"]}}}},U={csUnableToCheckIn:{causes:{csFldQuotaSizeExceeded:{formatString:"ERROR_OTHER_QUOTA_EXCEEDED_NO_FOLDER",args:0}}}};return docs.upload.QueueItem=u.extend({className:"QueueItem",logger:"Upload",defaults:{item:null,type:"file",img:g.staticRoot+"images/thumbs/others_40.png",name:"",originalName:"",size:0,hasSizeData:!0,parentId:null,securityGroup:null,isNewDocument:!0,fFileGUID:"",uploadState:v,uploadLengthComputable:!1,uploadResponse:"",errorMsg:null,errorAction:null,modifiedAt:"",createdAt:""},initialize:function(e){var i;if(u.prototype.initialize.call(this,e),e.item)this.set({item:e.item,name:e.item.name,originalName:e.item.name,mime:e.item.type,size:e.item.size,totalBytes:e.item.size,hasSizeData:!0!==e.item.noSizeData,modifiedAt:e.item.lastModifiedDate});else if(e.docItem||e.assetItem){var s=e.docItem||e.assetItem;i={docItem:s,docItemType:e.docItemType?e.docItemType:e.docItem?"docs":"assets",preUploadStatus:"ok",id:s.id,name:s.name,originalName:s.name,size:s.size,totalBytes:s.size,hasSizeData:!t.isUndefined(s.size)&&!t.isNull(s.size)},e.docItem&&e.docItem.folderItem&&(i.revision=e.docItem.folderItem.getRevision(),i.modifiedAt=e.docItem.folderItem.get("modifiedAt")),this.set(i)}else if(e.videoItem){var n=e.videoItem.asset,o=e.videoItem.videoData||{};i={videoItem:e.videoItem,docItemType:"assets",preUploadStatus:"ok",id:n.get("id"),name:o.entryName||n.get("name"),originalName:n.get("name"),revision:n.getRevision(),modifiedAt:n.get("modifiedAt"),size:null,totalBytes:null,hasSizeData:!1},this.set(i)}else if(e.convertAsset){var a=e.convertAsset;i={convertAsset:a,id:a.get("id"),name:a.get("name"),originalName:a.get("name"),hasSizeData:!1},this.set(i)}var r=this.get("name"),d="";if(e.convertAsset&&e.convertAsset.has("fileExtension"))d=e.convertAsset.get("fileExtension")||"";else if(r&&r.length>0){var c=r.lastIndexOf(".");d=c>-1?r.substring(c+1):""}var h=l.getThumbDetails(d.toLowerCase());this.set({thumbDetails:h,extension:d}),h&&h.thumbWhiteSVG&&this.set({img:g.staticRoot+"images/thumbs/"+h.thumbWhiteSVG})},isUpdate:function(){return!this.get("isNewDocument")},cancel:function(){this.debug("Cancel",this.get("name")),this.get("uploadState")===C?this.stopUpload():this.queue.cancelItem(this)},stopUpload:function(){this.debug("Stop",this.get("name")),this.uploader.stopUpload(this),this.isChunkedUpload&&this.chunks.stopUpload().done(t.bind((function(){this._finishUpload()}),this))},getResponse:function(){return this.get("uploadResponse")},hasSizeData:function(){return this.get("hasSizeData")},hasError:function(){return this.get("uploadState")===E},hasDataProblem:function(){return this.get("uploadState")===T},hasFinished:function(){return this.get("uploadState")===S},getErrorMessage:function(){return{message:this.get("errorMsg"),action:this.get("errorAction")?this.get("errorAction"):""}},_setError:function(e,t,i){this.set({errorMsg:e,errorAction:t,uploadState:i}),this.queue.updateErrors()},_clearError:function(){this.unset("errorMsg",{silent:!0}),this.unset("errorAction",{silent:!0})},startUpload:function(){this.get("uploadState")===v&&(this.debug("startUpload"),this.set({uploadState:C}),this._logConfigData())},setUploader:function(e){this.uploader=e},getUploader:function(){return this.uploader},startTimer:function(){u.prototype.startTimer.call(this)},getChunkConfig:function(){return _()},getUploadChunks:function(){return this.chunks},_adjustProgressData:function(e){if(this.isChunkedUpload)this.chunks.adjustProgressData(e);else{var t=(new Date).getTime();this.chunks||(this.chunks=new w({sequenceId:"main",status:D.STATUS.UPLOADING,timeBegin:this.get("startTime"),progress:{timings:[]}},{comparator:!1}),this.chunks.queueItem=this,this.chunks.setFile(this.get("item")));var i=this.chunks.findWhere({sequenceId:"main"}).get("progress");if(i.timings.push({time:t,bytesLoaded:e.bytesLoaded}),i.bytesLoaded=e.bytesLoaded,i.totalBytes=e.totalBytes,i.percentComplete=e.percentComplete,100===e.percentComplete&&(i.timeBegin=this.get("startTime"),i.time100=(new Date).getTime(),i.timeEnd=(new Date).getTime(),i.status=D.STATUS.COMPLETE,this.timerSnapshot("timing:fileUploaded"),this.chunks.logChunkTimingData()),this.hasSizeData()){var s=this.get("size");e.bytesLoaded=Math.min(e.bytesLoaded,s),e.totalBytes=Math.min(e.totalBytes,s)}}},updateProgress:function(e){this._adjustProgressData(e),this.set(e,{silent:!0}),this.updateTransferData((new Date).getTime(),100),this._updateQueue()},_updateQueue:t.throttle((function(){this.queue.childProgress(this)}),250),assetCopyComplete:function(e){this.set({id:e.id,name:t.unescape(e.name),uploadState:S,bytesLoaded:this.get("size"),totalBytes:this.get("size"),percentComplete:100,addResponse:e}),this.queue.childFinished(this,{updateAttributesOnly:!0})},assetCopyError:function(e){this.set({errorMsg:t.isObject(e)&&e.message?e.message:e,uploadState:E,addResponse:e}),this.queue.childFinished(this,{updateAttributesOnly:!0})},addComplete:function(e,i){if(e.success){var s=e.resolvedName;t.isEmpty(s)&&(s=e.displayName),this.set({id:e.id,name:t.unescape(s),revision:e.version||e.revision,uploadState:e.hasWarnings?I:S,bytesLoaded:this.get("size"),totalBytes:this.get("size"),percentComplete:100,addResponse:e,warningMsg:e.hasWarnings?e.message:""})}else this.set({errorMsg:e.message?e.message:"",uploadState:E,addResponse:e});this.queue.childFinished(this,{updateAttributesOnly:i})},convertComplete:function(e){if(e.failed)return this.set({errorMsg:e.errorThrown?e.errorThrown:"",uploadState:E,percentComplete:100}),void this.queue.childFinished(this);this.has("convertAsset")&&!t.isEmpty(e)&&(this.get("convertAsset").versionUploaded(e),this.set({uploadState:S,percentComplete:100}),this.queue.childFinished(this))},uploadComplete:function(i,o,a){this.timerSnapshot("timing:uploadComplete");var l,u=t.isObject(i)?i:s.parseJSON(i);if(o&&200!==o&&201!==o){if(this.uploader.options.use_cdt)if(u.title.includes("Maximum allowed limit:"))l={errorCode:-1,errorMsg:docs.i18n.t("STARTER_EDITION_ERROR_FOR_ASSETS")};else if(u["o:errorCode"]&&u["o:errorDetails"]&&t.isArray(u["o:errorDetails"])&&u["o:errorDetails"].length>0){var d=u["o:errorDetails"][0];l={errorCode:-1,errorMsg:d.title+"\n"+d.detail}}else(u.title||u.detail)&&(l={errorCode:-1,errorMsg:(u.title?u.title+":\n":"")+(u.detail?u.detail:"")});else l=s.checkResponseForError(u);l||(l={errorCode:-1,errorMsg:docs.i18n.t("UNEXPECTED_SERVER_NETWORK_ERROR",o,a)})}else l=s.checkResponseForError(u);if(l){if(s.isInvalidToken(l))return void this.queue.cancelUpload();if(this.uploader.isSystemFile()||this.uploader.options.repository_file){var c;if(!this.uploader.options.use_cdt){var h={};e.extend(!0,h,y),c=n.getErrorMessageFromSet(h,l,u)}this.set({errorMsg:c||l.errorMsg||"",uploadState:E,uploadResponse:u})}else{var p,m={},f=this.queue.getParentModel();!f||f.isFile?f&&f.ownedByOther||l.errorMsgKey.indexOf("/"+g.userid+",")<0?e.extend(!0,m,A,U):e.extend(!0,m,A,L):f.ownedByOther?(e.extend(!0,m,A,O),u.LocalData.fParentName=f.name):e.extend(!0,m,A,L),p=n.getErrorMessageFromSet(m,l,u),this.set({errorMsg:p,uploadState:E,uploadResponse:u})}}else if(this.uploader.isSystemFile())this._clearError(),this.set({uploadState:S,bytesLoaded:this.get("size"),totalBytes:this.get("size"),percentComplete:100,uploadResponse:u});else{var _;if(this._clearError(),this.uploader.options.repository_file)if(this.uploader.options.use_cdt){_=u;var v=t.has(_,"versionInfo")&&t.has(_.versionInfo,"data")&&t.isArray(_.versionInfo.data)&&_.versionInfo.data.length>0;_.version&&!v&&(_.versionInfo=_.versionInfo||{},_.versionInfo.data=[{latestVersion:_.version}],t.has(_,"publishedVersion")&&(_.versionInfo.data[0].publishedVersion=_.publishedVersion))}else _=this.needCaaSResponse(u)&&this.getCaasGuid(u)?this.getCaaSItem(this.getCaasGuid(u)):r.parse_AR_UPLOAD_DIGITAL_ASSET(u);else _=r.parse_CHECKIN_UNIVERSAL(u);if(this.uploader.options.digitalAssetUpload&&(_.digitalAssetUpload=this.uploader.options.digitalAssetUpload),this.set({id:_.id,name:t.unescape(_.name),revision:_.version||_.revision,uploadState:S,bytesLoaded:this.get("size"),totalBytes:this.get("size"),percentComplete:100,uploadResponse:_}),(_.revision&&_.revision>1||_.versionInfo&&_.versionInfo.data&&!t.isEqual(_.versionInfo.data[0].latestVersion,"0.1"))&&this.set("isNewDocument",!1),!_.isAdvancedVideo&&_.size){var C=parseInt(_.size,10);if(0===C&&C!==this.get("size")){var b=docs.i18n.t("ERROR_UPLOAD_SIZE_DIFFERENCE",_.name,_.revision,this.get("size"),C),I=docs.i18n.t("ERROR_UPLOAD_SIZE_DIFFERENCE_ACTION",this.get("originalName"));this._setError(b,I,T)}}_.isAdvancedVideo&&this.set({advancedVideo:!0,videoStatus:_.status}),docs.events.trigger("file:uploaded",this.getResponse(),this.uploader.id)}this.debug("uploadComplete",this.get("name")),this._logUploadTimings(this),this._finishUpload()},_finishUpload:function(){this.isChunkedUpload&&t.contains([E,T],this.get("uploadState"))?(this.isChunkComplete=!0,this.isChunkError=!0,this.uploader.cleanupFailedUpload(this).done(t.bind((function(e){e&&(f(e),this._getCleanupError(e)),this.queue.childFinished(this)}),this)).fail(t.bind((function(e,t){f(e,t);var i=this.get("errorMsg");i+="\n==\n"+e,this.set("errorMsg",i),this._getCleanupError(t),this.queue.childFinished(this)}),this))):this.queue.childFinished(this)},_getCleanupError:function(e){if(e){var t=s.checkResponseForError(e);if(t){var i=this.has("errorMsg")?this.get("errorMsg"):"";i+="\n==\n"+t.errorMsg,this.set("errorMsg",i)}}},needCaaSResponse:function(e){if(r.convertToRealJson(e),e&&e.ResultSets&&e.ResultSets.AssetInfo&&e.ResultSets.AssetInfo.length>0){var i=e.ResultSets.AssetInfo[0],s=!t.isEmpty(i.xARLanguageVariationSetId);return!(!isNaN(i.dRevLabel)&&1===parseInt(i.dRevLabel,10))||!s}return!1},getCaasGuid:function(e){return r.convertToRealJson(e),e&&e.ResultSets&&e.ResultSets.AssetInfo&&e.ResultSets.AssetInfo.length>0?e.ResultSets.AssetInfo[0].xARCaaSGUID:null},getCaaSItem:function(t){var i,s="/content/management/api/v1.1/items/"+t;return s+="?expand=tags,collections,channels,publishedChannels,taxonomies,publishInfo,versionInfo&includeAdditionalData=true",e.ajax({url:s,type:"GET",async:!1,dataType:"json",beforeSend:function(e){d.setAuthorizationHeader(e)},success:function(e){i=e},error:function(e){e.errorHandled=!0}}),i},uploadAborted:function(){this._setError(docs.i18n.t("ERROR_UPLOAD_WAS_CANCELED"),"","aborted"),this.queue.childFinished(this)},uploadCanceled:function(){this._setError(docs.i18n.t("ERROR_UPLOAD_WAS_CANCELED"),"",b)},uploadFailed:function(){this._setError(docs.i18n.t("ERROR_UNABLE_TO_UPLOAD_FILE"),"",E),this.queue.childFinished(this)},setError:function(e,t,i){i=i||E,this._setError(e,t,i)},modelType:function(){return"queueItem"},getDisplayName:function(){return this.get("name")},getExtension:function(){return this.get("extension")},getThumbnailUrl:function(i,s,n,o){function r(e){return l.getUrl({extension:e.get("extension"),size:n?"extra-large":i?"large":"small",wantGeneric:!0})}if(o)return r(this);if(this.has("docItemType"))return"docs"===this.get("docItemType")?l.getUrl({extension:this.get("extension"),id:this.get("id"),revision:this.get("revision"),onDemand:s,size:n?"extra-large":i?"large":"small",inTrash:!1,infected:!1,wantGeneric:o,thumbDetailsCB:a.getThumbDetails}):(this.get("docItemType"),l.getUrl({extension:this.get("extension"),size:n?"extra-large":i?"large":"small",wantGeneric:!0}));if(this.has("convertAsset")){var u=this.get("thumbDetails"),d=docs.common.Globals.staticRoot+"images/thumbs/no_media_available_redwood.svg";const e=this.get("extension");if(u&&u.thumbSVG){var c=t.isEqual(u.thumbSVG,"others_redwood.svg")?"others_asset_redwood.svg":u.thumbSVG;d=docs.common.Globals.staticRoot+"images/thumbs/"+c}var g="/content/management/api/v1.1/assets/"+this.get("id");return h("svg.thumbnail")&&e&&"svg"===e.toLowerCase()?g+="/native/"+encodeURIComponent(this.get("name")):u.isImage?g+="/thumbnail/?format="+l.getThumbnailFormat(e)+"&type=uithumbnail":d}const m=this.has("extension")?this.get("extension").toLowerCase():"";var f,_;if(h("svg.thumbnail")&&"svg"===m){f=this.get("item"),_=e.Deferred();var v=new FileReader;return v.addEventListener("load",(function(){_.resolve(v.result)}),!1),v.readAsDataURL(f),_}return t.contains(["jpg","jpeg","png","gif","webp"],m)?(f=this.get("item"),_=e.Deferred(),h("addasset.objurl")?(this.set("thumbnailId",this.queue.processThumbnail({url:URL.createObjectURL(f),revokeObjUrl:!0},_)),_):window.localStorage.getItem("dev.resizeUploadThumbsWorkers")?(this.set("thumbnailId",this.queue.processThumbnail(new Promise(((e,t)=>{var i=new Worker(p);i.onmessage=function(t){i.terminate(),e(t.data.result)},i.postMessage(f)})),_)),_):(this.set("thumbnailId",this.queue.processThumbnail(new Promise(((e,t)=>{var i=new FileReader;i.addEventListener("load",(function(){e(i.result)}),!1),i.readAsDataURL(f)})),_)),_)):r(this)},getRevision:function(){if(this.has("docItemType")&&"docs"===this.get("docItemType"))return this.get("revision")},getUpdateDate:function(){return this.get("modifiedAt")},useChunkedUpload:function(){if(this.uploader.canChunkUpload()){var e=_();return e.enabled&&this.hasSizeData()&&this.get("item").size>e.minFileSize}return!1},startChunkedUpload:function(){return this.startUpload(),this.isChunkedUpload=!0,this.chunks=new w(null,{comparator:!1}),this.chunks.queueItem=this,this.chunks.setFile(this.get("item")),this.listenTo(this.chunks,"change:status",t.bind((function(e,t){if(f("status changed",e.get("sequenceId"),t),"error"===t){var i=this.chunks.computeProgressData();f("status changed",i),this.set(i),this._updateQueue()}}),this)),this.dfd=e.Deferred(),this.dfd.notify(),this.dfd.promise()},uploadChunkComplete:function(e,t,i,n){var o=s.parseJSON(t),a=s.checkResponseForError(o),r=this.chunks.findWhere({sequenceId:e});r&&(a?r.setChunkError(a,o):r.setChunkComplete(o)),this.chunks.isUploadComplete()?(this.isChunkComplete=!0,this.dfd.resolve(),this.chunks.logChunkData(),this.chunks.logChunkTimingData()):(this.chunks.logChunkData(),this.dfd.notify())},uploadChunkFailed:function(e,t,i,n){var o=s.parseJSON(t),a=s.checkResponseForError(o),r=this.chunks.findWhere({sequenceId:e});r&&a&&r.setChunkError(a,o),this.chunks.logChunkData(),this.dfd.notify()},_logConfigData:function(){var e=_();e.configError&&(console.info("****"),console.warn(e.configError),console.info("****")),e.useLogging&&(e.usageMessage&&(console.info(e.usageMessage),console.info("****")),e.devMessage&&(console.info(e.devMessage),console.info("****")),console.info("ChunkedUpload feature flag:",h("ChunkedUpload")),console.info("Chunk Upload Config:",t.omit(e,["configError","usageMessage","devMessage"])))},_logUploadTimings:function(e){if(_().useLogging){var t=e.get("totalBytes")/m,i=(e.get("timing:uploadComplete")-e.get("startTime"))/1e3,s=(e.get("timing:fileUploaded")-e.get("startTime"))/1e3,n=0;e.chunks.each((function(e){var t=e.get("progress");n+=t.time100-t.timeBegin})),n/=1e3;var o={total_Mb:t,time_Upload:s,time_Server_Checkin:(e.get("timing:uploadComplete")-e.get("timing:fileUploaded"))/1e3,time_Total:i,time_Upload_Chunks:n,Mbps_Upload:t/n,Mbps_Total:t/i,upload_start:new Date(this.get("startTime")).toISOString(),upload_file:new Date(e.get("timing:fileUploaded")).toISOString(),upload_end:new Date(this.get("endTime")).toISOString()};this.isChunkedUpload&&(o.chunkSizeMb=e.chunks.chunkSize/m,o.numChunks=e.chunks.totalChunks),f(o)}},cleanup:function(){this.stopListening(),this.queue.removeProcessThumbnail(this.get("thumbnailId"))}}),docs.upload.QueueItem})),define("common/upload/model/UploadQueue",["backbone","underscore","core/util/Service","core/util/Globals","core/util/Utils","common/notification/model/Progressable","common/upload/model/ProgressMessages","docs/notification/template/ProgressViewLink.template","common/upload/model/QueueItem"],(function(e,t,i,docs,s,n,o,a){"use strict";var r=docs.common.Globals,l={canceled:"UPLOAD_DETAILS_TITLE_CANCELED",no_items_in_queue:"UPLOAD_DETAILS_TITLE_NO_ITEMS",progress_pct:"UPLOAD_DETAILS_TITLE_PCT",progress_nopct:"UPLOAD_DETAILS_TITLE_NO_PCT",complete:"UPLOAD_DETAILS_TITLE_COMPLETE",initial:"UPLOAD_DETAILS_TITLE"};const u=e.Model.extend({_doResizeImage:function(e){let i=e,s=!1;return t.isObject(e)&&(i=e.url,s=e.revokeObjUrl),new Promise(((e,t)=>{var n=new Image;n.onload=function(){s&&URL.revokeObjectURL(i);var o=document.createElement("canvas");if(o.getContext){var a=o.getContext("2d");const t=36;let i=n.width,s=n.height;i>s?i>t&&(s*=t/i,i=t):s>t&&(i*=t/s,s=t),o.width=i,o.height=s,a.drawImage(n,0,0,i,s);var r=o.toDataURL("image/jpeg");e(r)}else t()},n.src=i}))},initialize:function(){t.bindAll(this,"work"),this.items=[]},work:function(){if(!this.items||!this.items[0])return;if(this.items[0].working)return;this.items[0].removed&&this.items.shift();const e=this.items[0];e&&(e.working=!0,Promise.resolve(e.urlPromise).then((i=>{if(e.removed){if(t.isObject(i)&&i.revokeObjUrl)try{URL.revokeObjectURL(i.url)}catch(e){console.log(e)}return new Promise(((e,s)=>{e(t.isObject(i)?i.url:i)}))}return this._doResizeImage(i)})).then((t=>(e.removed||e.dfd.resolve(t),new Promise(((e,t)=>{e()}))))).then((()=>(this.items.shift(),new Promise(((e,t)=>{setTimeout((()=>e()),0)}))))).then(this.work).catch((t=>{e.dfd.reject(t)})))},add:function(e,i){const s=t.uniqueId("tq_");return this.items.push({urlPromise:e,dfd:i,id:s}),1===this.items.length&&this.work(),s},remove:function(e){const i=t.findWhere(this.items,{id:e});i&&(i.removed=!0)}});var d=e.Collection.extend({model:docs.upload.QueueItem});return docs.upload.UploadQueue=n.extend({className:"UploadQueue",logger:"Upload",defaults:{percentComplete:0,totalItems:0,currentIndex:0,uploadState:"stopped",uploadedItems:0,errorItems:0,errorMessages:[]},initialize:function(e){n.prototype.initialize.call(this,e),t.bindAll(this,"progressTitle","completeTitle","getTitle","progressMessage","completeMessage","_getMessage","cancelUpload","cancelItem","_checkFinished"),this.items=new d,this.set("totalItems",this.items.length),this.singleFile=!1,this.idCounter=0,this.titleStrings=l;var i=this.getConnector();i&&t.isFunction(i.getUserContentTypes)&&(i.has("userTypes")?this.trigger("change:userTypes"):this.listenToOnce(i,"change:userTypes",t.bind((function(){this.trigger("change:userTypes")}),this))),this.thumbnailQueue=new u},processThumbnail:function(e,t){return this.thumbnailQueue.add(e,t)},removeProcessThumbnail:function(e){this.thumbnailQueue.remove(e)},setTitleStrings:function(e){this.titleStrings=e},getConnector:function(){return this.get("connector")},getProgressStrings:function(){var e=this.getConnector();if(e)return e.progressBarStrings},isRepositoryChooserOnly:function(){var e=this.getConnector();return!!e&&e.repositoryChooserOnly},isAllSelect:function(){var e=this.getConnector();return!!e&&e.isAllSelect},getAssetContentTypes:function(){var e=this.getConnector();if(e&&t.isFunction(e.getAssetContentTypes))return e.getAssetContentTypes(this.items)},getUserContentTypes:function(){var e=this.getConnector();if(e&&t.isFunction(e.getUserContentTypes))return e.getUserContentTypes()},updatePreUploadStatus:function(e,i){var s=this.getConnector();s&&t.isFunction(s.updatePreUploadStatus)&&s.updatePreUploadStatus(e,this.items),s&&t.isFunction(s.checkRepositoryCompatibility)&&(this.repositoryCompatibility=s.checkRepositoryCompatibility(i,e))},getPreUploadStatusProblem:function(){var e=this.getConnector(),i={};return e&&t.isFunction(e.getPreUploadStatusProblem)&&(i=t.extend({},e.getPreUploadStatusProblem(this.items)||{})),i=t.extend(i,this.repositoryCompatibility||{})},setUploader:function(e){this.uploader=e},getUploader:function(){return this.uploader},getCurrentIndex:function(){return this.get("currentIndex")},setSingleFile:function(e){this.singleFile=e},getSingleFile:function(){return this.singleFile},setParentModel:function(e){if(e)if(e.cid){var i=e.has("damCollectionId");this.set({parentModel:{id:e.get("id"),name:e.get("name"),isFile:"file"===e.get("type"),isCollection:i,isAsset:e.has("varSetId"),ownedByOther:!e.isOwned()}})}else this.set({parentModel:{id:e.id,name:e.name,isFile:e.isFile,ownedByOther:e.ownedByOther}});if("stopped"===this.get("uploadState")){var s=this.get("parentModel");if(s&&!s.isFile){var n=s.get?s.get("id"):s.id;t.each(this._getQueueItems(),(function(e){e.set("parentId",n)}),this)}}this.trigger("parentModelChanged")},getParentModel:function(){return this.has("parentModel")?this.get("parentModel"):this.has("repositoryId")?{id:this.get("repositoryId"),name:this.get("repositoryName"),isRepository:!1,ownedByOther:!1}:void 0},getStartData:function(){return this.startData},updateAttributes:function(){this.trace("updateAttributes","start");var e={uploadLengthComputable:!0,bytesLoaded:0,totalBytes:0,percentComplete:0},i=0,s=this._getActiveUploads();t.each(s,(function(t){e.bytesLoaded+=t.bytesLoaded(),e.totalBytes+=t.totalBytes()})),i+=s.length;var n=(s=this.items.where({uploadState:"skipped"})).length,o=(s=this.items.where({uploadState:"finished"})).length;t.each(s,(function(t){e.bytesLoaded+=t.bytesLoaded(),e.totalBytes+=t.totalBytes()})),i+=o,s=this.items.where({uploadState:"warning"}),t.each(s,(function(t){e.bytesLoaded+=t.bytesLoaded(),e.totalBytes+=t.totalBytes()})),i+=s.length,o+=s.length,s=this.items.where({uploadState:"finished-with-error"}),t.each(s,(function(t){e.bytesLoaded+=t.bytesLoaded(),e.totalBytes+=t.totalBytes()})),i+=s.length,s=this._getQueueItems(),t.each(s,(function(t){e.totalBytes+=t.totalBytes()}));var a=this._getErrorMessages(),r=this._getAbortedMessages();0===e.totalBytes&&(e.totalBytes=1),i=i+a.length+r.length,"canceled"!==this.get("uploadState")&&(e.percentComplete=Math.floor(100*e.bytesLoaded/e.totalBytes)),this.set({skippedItems:n,uploadedItems:o,errorItems:a.length,errorMessages:a,abortedItems:r.length,currentIndex:i}),this.trace("progress data",e),this.set(e),this.updateTransferData((new Date).getTime(),100),this.trace("updateAttributes","end")},_getErrorMessages:function(){var e=this.items.where({uploadState:"error"}),i=this.items.where({uploadState:"finished-with-error"}),s=[];return t.each(e,(function(e){s.push(e.getErrorMessage())})),t.each(i,(function(e){s.push(e.getErrorMessage())})),s},_getAbortedMessages:function(){var e=this.items.where({uploadState:"aborted"}),i=[];return t.each(e,(function(e){i.push(e.getErrorMessage())})),i},add:function(e){if(e.id||(e.id=this._getUniqueId()),0===this.items.where({id:e.id}).length){e.queue=this,e.setUploader(this.getUploader());var t=this.items.add(e),i=e.get("size");this.trace("itemSize",i),this.set({totalBytes:this.get("totalBytes")+i,totalItems:this.items.length}),this.trigger("add",t)}},_getUniqueId:function(){return this.idCounter=this.idCounter+1,this.cid+"_"+this.idCounter},getItem:function(e){var t=this.items.where({id:e});return 1===t.length?t[0]:null},startAllItems:function(e){this._start(e,t.bind(this.doAll,this))},doAll:function(){var e=this.getSingleFile();t.each(this._getQueueItems(),(function(t){this.uploader.uploadItem(t,e)}),this),this.updateAttributes()},startUpload:function(e){this._start(e,t.bind(this.doNext,this))},startAdd:function(e){this._start(e,t.noop)},_start:function(e,t){"stopped"===this.get("uploadState")&&(this.startData=e,this.debug("startUpload","total bytes = ",this.get("totalBytes")),this.startTimer(),this.set({uploadState:"active",percentComplete:0}),t())},doNext:function(){this.trace("entering doNext");var e=this.get("uploadState");if("canceled"!==e&&"stopped"!==e){var i=this.getNumberOfActiveUploads();if(this.trace("current active uploads =",i),i>=this.uploader.getMaxUploads())this.trace("exiting doNext","maxUploads = ",this.uploader.getMaxUploads());else{var s=this.getNextItem();if(s){var n=this;docs.events.trigger("uploader:item-starting",s,(function(){n.uploader.uploadItem(s,n.getSingleFile()),n.updateAttributes()}))}else{if(i>0)return void this.trace("exiting doNext","not finished");this.debug("upload complete"),this.setFinished(),t.defer(this.uploader.finishedUpload)}this.trace("exiting doNext","normal exit")}}else this.trace("exiting doNext","upload state = ",e)},_checkFinished:function(){this.trace("entering checkFinished"),this.uploadsPending()?this.trace("exiting checkFinished, uploads pending"):(this.debug("upload complete"),this.setFinished(),t.defer(this.uploader.finishedUpload),this.trace("exiting checkFinished","normal exit"))},childProgress:function(){this.updateAttributes()},childFinished:function(e,i){i=i||{},e&&"canceled"===e.get("uploadState")?t.defer(this.cancelItem,e):this.updateAttributes(),i.updateAttributesOnly?t.defer(this._checkFinished):this.doNext()},skipItem:function(e,t){if(null!==e){var i=e.get("size");e.set({itemSize:0}),e.setError(t,null,"skipped"),this.set({totalBytes:this.get("totalBytes")-i,totalItems:this.get("totalItems")-1},{silent:!0}),this.updateAttributes()}},cancelItem:function(e){if(null!==e){this.items.remove(e);var t=e.get("size");this.set({totalBytes:this.get("totalBytes")-t,totalItems:this.items.length},{silent:!0}),this.updateAttributes(),this.trigger("remove",e.id)}},cancelUpload:function(){this.debug("cancelUpload"),this.set({uploadState:"canceled",percentComplete:0}),t.each(this._getActiveUploads(),(function(e){e.stopUpload()})),t.each(this._getQueueItems(),(function(e){e.uploadCanceled()})),this.uploader.cancelUpload()},uploadsPending:function(){return(this._getQueueItems().length>0||this._getActiveUploads().length>0)&&("active"===this.get("uploadState")||"stopped"===this.get("uploadState"))},uploadWasCanceled:function(){return"canceled"===this.get("uploadState")},isNotStarted:function(){return"stopped"===this.get("uploadState")},isFinished:function(){var e=this.get("uploadState");return"finished"===e||"finished-with-error"===e},isFinishedWithoutError:function(){return"finished"===this.get("uploadState")},setFinished:function(){var e=this.items.pluck("uploadState");t.every(e,(function(e){return"aborted"===e||"canceled"===e}))?this.set({uploadState:"canceled",percentComplete:0}):t.some(e,(function(e){return"error"===e||"finished-with-error"===e}))?this.set({uploadState:"finished-with-error",percentComplete:100}):this.set({uploadState:"finished",percentComplete:100})},finishedItems:function(){var e=0;return this.items.each((function(t){"finished"!==t.get("uploadState")&&"warning"!==t.get("uploadState")||(e+=1)})),e},hasWarnings:function(){return!!this.items.findWhere({uploadState:"warning"})},updateErrors:function(){var e=this._getErrorMessages(),t=this._getAbortedMessages();this.set({errorItems:e.length,errorMessages:e,abortedItems:t.length})},getWarningCount:function(){return this.items.where({uploadState:"warning"}).length},getErrorCount:function(){return this.get("errorItems")},getCanceledCount:function(){return this.get("abortedItems")},getErrorMessages:function(){return this.get("errorMessages")},getNumberOfActiveUploads:function(){return this._getActiveUploads().length},_getActiveUploads:function(){return this.items.where({uploadState:"active"})},getActiveItems:function(){return this._getActiveUploads()},getQueuedItems:function(){return this._getQueueItems()},findQueuedItemById:function(e){var t,i=this.items.where({id:e});return i.length>0&&(t=i[0]),t},findActiveQueuedItemById:function(e){var t,i=this.items.where({id:e,uploadState:"active"});return i.length>0&&(t=i[0]),t},findQueuedItemByCaaSId:function(e){return this.items.find((function(t){return t.get("docItem").folderItem.get("id")===e}))},_getQueueItems:function(){return this.items.where({uploadState:"stopped"})},getNextItem:function(){var e=null,t=this._getQueueItems();return t.length>0&&(e=t[0]),e},progressTitle:function(){return this.getTitle()},completeTitle:function(){return this.getTitle()},getTitle:function(){var e=null;return null===(e=this.isNotStarted()?this.uploadsPending()?docs.i18n.t(this.titleStrings.initial):docs.i18n.t(this.titleStrings.no_items_in_queue):this.uploadWasCanceled()?docs.i18n.t(this.titleStrings.canceled,this.finishedItems(),this.get("totalItems")):this.uploadsPending()?this.uploader.supportsProgress?docs.i18n.t(this.titleStrings.progress_pct,this.get("currentIndex"),this.get("totalItems"),this.get("percentComplete")):docs.i18n.t(this.titleStrings.progress_nopct,this.get("currentIndex"),this.get("totalItems")):docs.i18n.t(this.titleStrings.complete))&&(e=docs.i18n.t(this.titleStrings.initial)),e},progressMessage:function(){return this._getMessage()},completeMessage:function(){return this._getMessage()},_getMessage:function(){var e={status:{canceled:this.uploadWasCanceled(),pending:this.uploadsPending()},item:this.items.models[0],items:{currentIndex:this.get("currentIndex"),finished:this.finishedItems(),error:this.getErrorCount(),canceled:this.getCanceledCount(),total:this.get("totalItems"),percentage:this.get("percentComplete")},links:this._locationLink(this.get("totalItems")),linkTemplate:a,supportsProgress:this.progress,messageStrings:this.getProgressStrings()};return o.getMessageText(e)},_locationLink:function(e){var t,n,o,l=a,u=this.getParentModel();return-1!==u.id.indexOf("FLD_SEARCH:")||u.isFile||(t=r.embed||r.isAppLink?i.breakWords(u.name):l({href:s.getLocation(u.id),name:i.breakWords(u.name)})),1===e&&(o=this.items.models[0],n=i.breakWords(o.get("name"))),{locationLink:t,fileLink:n}},setCollectionContainer:function(e){this.items.container=e},cleanup:function(){this.items.each((function(e){e.cleanup&&e.cleanup()}))}}),docs.upload.UploadQueue})),define("common/upload/view/BaseUploader",["jquery","underscore","backbone","core/util/Globals","core/dialog/MessageDialog","core/util/Service","core/util/Session","common/assets/settings","core/util/FeatureFlags","core/util/AppLink","core/util/Logger","core/view/MessageBar","common/notification/view/UploadProgressBar","common/upload/model/UploadQueue","common/upload/model/QueueItem"],(function(e,t,i,docs,s,n,o,a,r){"use strict";var l=docs.common.Globals,u=0;return docs.upload.BaseUploader=i.View.extend({objectName:"BaseUploader",logger:"Upload",maxUploads:1,initialize:function(e){return t.bindAll(this,"addFiles","finishedUpload"),this.uploadQueue=new docs.upload.UploadQueue,this.uploadQueue.setUploader(this),e=e||{},t.isUndefined(e.use_cdt)&&(e.use_cdt=!1),t.isUndefined(e.show_progress)&&(e.show_progress=!0),t.isUndefined(e.single_selection)&&(e.single_selection=!1),t.isUndefined(e.uploadNew)&&(e.uploadNew=!1),t.isUndefined(e.applyButtonClasses)&&(e.applyButtonClasses=!0),e.parentModel&&this.setParent(e.parentModel),t.isUndefined(e.system_file)&&(e.system_file=!1),t.isUndefined(e.waitForStart)&&(e.waitForStart=!1),this},render:function(){return this.options.original_id&&!this.options.noUI&&(this.isMenuUploader()?this.createMenuUploader():this.createButtonUploader()),this},onClose:function(){this.isMenuUploader()?this.removeMenuUploader():this.removeButtonUploader()},classLogId:function(){return"["+this.objectName+":"+this.cid+"]"},debug:function(){var e=[];e[0]=this.classLogId(),docs.common.Logger(this.logger).debug.apply(void 0,e.concat([].slice.apply(arguments)))},error:function(){var e=[];e[0]=this.classLogId(),docs.common.Logger(this.logger).error.apply(void 0,e.concat([].slice.apply(arguments)))},warn:function(){var e=[];e[0]=this.classLogId(),docs.common.Logger(this.logger).warn.apply(void 0,e.concat([].slice.apply(arguments)))},info:function(){var e=[];e[0]=this.classLogId(),docs.common.Logger(this.logger).info.apply(void 0,e.concat([].slice.apply(arguments)))},trace:function(){var e=[];e[0]=this.classLogId(),docs.common.Logger(this.logger).trace.apply(void 0,e.concat([].slice.apply(arguments)))},close:function(){t.isFunction(this.onClose)&&this.onClose(),this.remove(),this.unbind()},getUploadQueue:function(){return this.uploadQueue},setParent:function(e){this.parentModel=e,this.uploadQueue.setParentModel(e)},setParentFolder:function(e){this.uploadQueue.setParentModel(e)},getParentFolder:function(){return this.uploadQueue.getParentModel()},destroy:function(){return this.options.waitForStart&&this.uploadQueue.items.length>0&&this.uploadQueue.isNotStarted()&&this.isMenuUploader()?(delete this.options.waitForStart,this.removeMenuEvents(),!1):(this.close(),!0)},supportsProgress:!1,isFileAllowed:function(e,t){var i,s=!0;return t&&("function"==typeof t.webkitGetAsEntry?i=t.webkitGetAsEntry():"function"==typeof t.getAsEntry&&(i=t.getAsEntry()),(s=i&&i.isFile)||this.debug("skipping non-file: name="+e.name)),s&&n.isRealFile(e,docs.common.Logger(this.logger))},confirmUpload:function(e){var i=this._getConfirmationInfo(this.parentModel,e);if(t.isUndefined(i)||t.isNull(i))this.addFiles(e),this.handleCallbacks();else{var n=this;s.show({title:i.title,message:i.message,okButtonText:docs.i18n.t("YES"),callback:function(){n.addFiles(e),n.handleCallbacks()},cancelButtonText:docs.i18n.t("NO"),cancelCallback:function(){n.handleCallbacks()},reverseButtons:"no",defaultButton:"ok"})}},getAcceptExtensions:function(){return t.isFunction(this.options.accept_extensions)?this.options.accept_extensions.call(this,this.parentModel):this.options.accept_extensions},addFiles:function(e,i){if(e&&e.length>0){i&&i.length>e.length&&(this.debug("files and items not the same length"),i=t.where(i,{kind:"file"}),this.debug("files and items length now",e.length,i.length));var s=0,o=0;if(t.each(e,(function(e,a){if(!this.isFileAllowed(e,i?i[a]:null))return o++,!0;s+=1;var r=this.getAcceptExtensions();if(n.isAcceptableExtension(e,r,docs.common.Logger(this.logger))){var u=this.options.waitForStart&&this.options.use_cdt;if(e.size>l.maxFileSize&&!u)return new docs.views.MessageBar({messageText:docs.i18n.t("ERROR_MAX_FILE_SIZE_EXCEEDED",n.convertNumber(e.size,n.ConversionMultiplier.toMB,null,!0)+" "+docs.i18n.t("UNITS_MEGABYTES"),n.convertNumber(l.maxFileSize,n.ConversionMultiplier.toMB,null,!0)+" "+docs.i18n.t("UNITS_MEGABYTES")),messageType:"warning"}),s-=1,void this.debug("max file size reached");if(n.hasInvalidCharacters(e.name)&&!u)return new docs.views.MessageBar({messageText:docs.i18n.t("ERROR_NAME_CONTAINS_INVALID_CHARACTERS",e.name),messageType:"warning"}),s-=1,void this.debug("contains invalid characters");if(this.parentModel)if(this.parentModel.isFolder||this.parentModel.isSite||this.parentModel.isTheme||this.parentModel.isApp||this.parentModel.isCollection||this.parentModel.isContentType||this.isTemplate)this.uploadQueue.add(new docs.upload.QueueItem({item:e,parentId:this.parentModel.get("id")}));else if(this.parentModel.isAssetsSearch)this.uploadQueue.add(new docs.upload.QueueItem({item:e}));else{var d={item:e,parentId:this.parentModel.get("parentID"),isNewDocument:!1,digitalAssetUpload:this.parentModel.isImageEditor||this.parentModel.isAsset&&this.parentModel.isDigitalAsset()};d.digitalAssetUpload?d.urlParameters={itemPrefix:"arCaaSGUID:",versionProp:"arCaaSVersion",id:this.parentModel.get("id"),revision:this.parentModel.get("version")}:d.fFileGUID=this.parentModel.get("targetID")?this.parentModel.get("targetID"):this.parentModel.get("id"),this.uploadQueue.add(new docs.upload.QueueItem(d));var c,h=this.options.parentFolder?this.options.parentFolder.get("id"):void 0;if(h&&(h.indexOf("FLD_SEARCH")>=0||h.indexOf("FLD_FAVORITES")>=0)){var p=this.parentModel.get("path");if(p&&p.items.length>0){var g=t.last(p.items);c={id:g.id,name:g.name,isFile:!1,ownedByOther:!this.parentModel.isOwned()},this.uploadQueue.setParentModel(c)}}else this.options.digitalAssetUpload?t.noop():this.options.parentFolder&&this.uploadQueue.setParentModel(this.options.parentFolder)}else this.uploadQueue.add(new docs.upload.QueueItem({item:e}))}else{var m=new docs.upload.QueueItem({item:e});this.uploadQueue.add(m),m.setError(docs.i18n.t("ERROR_INVALID_EXTENSION",r.toString()),"","error")}t.isFunction(this.postAddFile)&&this.postAddFile(e)}),this),o>0&&new docs.views.MessageBar({messageText:docs.i18n.t("UPLOAD_FOLDER_MESSAGE","/documents/install"),messageType:"warning",disableScriptProtection:!0}),0===s)return void this.debug("no files were added");this.uploadQueue.setSingleFile(1===e.length),this._beforeStart(),this.options.waitForStart||this.startUpload()}else new docs.views.MessageBar({messageText:docs.i18n.t("UPLOAD_FOLDER_MESSAGE","/documents/install"),messageType:"warning",disableScriptProtection:!0}),this.debug("no files were found")},_beforeStart:function(){t.isFunction(this.beforeStartUpload)&&this.beforeStartUpload()},resumeUpload:function(e){this.startUpload(e)},resetUpload:function(){this.uploader_id&&docs.events.trigger("uploader:reseting",this.uploader_id)},startUpload:function(e){this.debug("startUpload","total items =",this.uploadQueue.get("totalItems")),this.uploader_id&&docs.events.trigger("uploader:starting",this.uploader_id,this.uploadQueue),this.options.show_progress&&new docs.views.UploadProgressBar({type:this.options.type,model:this.uploadQueue,progress:this.supportsProgress,hideDetails:this.options.hideDetails,dialogStrings:this.options.dialogStrings,locationHref:this.options.locationHref,fileviewHref:this.options.fileviewHref,skipLinks:this.options.skipLinks}),this.uploadQueue.startUpload(e)},cancelUpload:function(){this.debug("cancelUpload"),this.uploader_id&&docs.events.trigger("uploader:canceled",this.uploader_id)},finishedUpload:function(){this.debug("finishedUpload"),this.uploader_id&&docs.events.trigger("uploader:finished",this.uploader_id,this.uploadQueue)},getMaxUploads:function(){return this.maxUploads},uploadItem:function(){throw"override uploadItem to perform the upload"},isMenuUploader:function(){return!0===this.options.is_menu},isToolbarUploader:function(){return!0===this.options.is_toolbar},_getUploadElement:function(){return e("#"+this.options.original_id)},createMenuUploader:function(){throw"Derived uploader must override createMenuUploader function"},removeMenuUploader:function(){throw"Derived uploader must override removeMenuUploader function"},removeMenuEvents:function(){throw"Derived uploader must override removeMenuEvents function"},createButtonUploader:function(){throw"Derived uploader must override createButtonUploader function"},removeButtonUploader:function(){throw"Derived uploader must override removeButtonUploader function"},_assignIds:function(){var e=u++;this.options.upload_bb_id=this.options.id+"_bb_"+e,this.options.upload_input_id=this.options.upload_bb_id+"_input"},_styleWrapper:function(e,t,i,s){e.css({cursor:"pointer","overflow-x":"hidden","overflow-y":"hidden",position:"relative",display:t,height:i,width:s})},_styleInputElement:function(e,t,i){e.css({position:"absolute",left:-9999,top:-99999,cursor:"pointer",display:"inline-block",height:t,width:i,"font-size":"100px",filter:"alpha(opacity=1)","-moz-opacity":.01,opacity:.01})},_positionInputElement:function(e,t){try{e.position({my:"right center",at:"right center",of:t})}catch(e){}},handleCallbacks:function(){t.isFunction(this.options.input_click_callback)&&t.defer(this.options.input_click_callback)},getCloudServiceParameters:function(e,t){return this.options.use_cdt?this._getCaasServiceParameters(e,t):this._getDocsServiceParameters(e,t)},_getDocsServiceParameters:function(e,i){this.chunkCount=(this.chunkCount||0)+1;var s={IdcService:this.getServiceName(e),IsJson:"1",UserTimeZone:"utc"};if(""!==n.getIdcToken()&&(s.idcToken=n.getIdcToken()),n.linkId&&(n.isAppLink?(s.dAppLinkID=n.linkId,s.dAppLinkAccessToken=docs.common.AppLink.getAccessToken()):s.dLinkID=n.linkId),!s.IdcService.startsWith("FILECHUNK_"))if(this.isSystemFile()||(n.linkId&&"F"!==n.linkId[1]||(s.parent="fFolderGUID:"+e.get("parentId")),s.ReservedBy=l.userid),e.isUpdate()&&i&!this.options.uploadNew){if(this.options.digitalAssetUpload){delete s.parent;var o=e.get("urlParameters");s.item=o.itemPrefix+o.id,s[o.versionProp]=o.revision}else s.item="fFileGUID:"+e.get("fFileGUID");this.options.iosDevice&&"image.jpg"===e.get("name").toLowerCase()&&(s.ConflictResolutionMethod="ResolveDuplicates.TimeStampSuffix")}else this.options.iosDevice&&"image.jpg"===e.get("name").toLowerCase()?s.ConflictResolutionMethod="ResolveDuplicates.TimeStampSuffix":s.ConflictResolutionMethod="ReviseDuplicates";return this.options.additional_params_callback&&t.isFunction(this.options.additional_params_callback)&&this.options.additional_params_callback(s,e),s},_getCaasServiceParameters:function(e){if(!e.isUpdate()){var i={name:e.get("name"),type:e.get("assetType"),description:e.get("description"),fileExtension:e.get("extension"),repositoryId:e.queue.get("repositoryId"),fields:e.get("contentItemModel")?e.attributes.contentItemModel.attributes.fields:{}};return e.get("contentItemModel")&&e.get("contentItemModel").has("translatable")&&(i.translatable=e.get("contentItemModel").get("translatable")),e.has("contentItemModel")&&(i.language=e.get("contentItemModel").get("language")),e.get("contentItemModel")&&(i.languageIsMaster=e.get("contentItemModel").get("languageIsMaster"),i.varSetId=e.get("contentItemModel").get("varSetId"),i.sourceId=e.get("contentItemModel").get("sourceId"),i.type=e.get("contentItemModel").get("type"),i.slug=e.get("contentItemModel").get("slug")),this.options.additional_caas_params_callback&&t.isFunction(this.options.additional_caas_params_callback)&&this.options.additional_caas_params_callback(i,e),i}},getCloudServiceMethod:function(e){return e.isChunkedUpload||!this.options.use_cdt?"POST":e.isUpdate()?"PUT":"POST"},getCloudServiceURL:function(e){if(e.isChunkedUpload||!this.options.use_cdt)return n.formatServiceUrl(this.getServiceName(e));var t=a.endpoints.serverURL+"/items";return e.isUpdate()&&(t+="/"+e.get("urlParameters").id,t+="?expand=tags,collections,channels,publishedChannels,taxonomies,publishInfo,versionInfo,changes,workflows&includeAdditionalData=true"),t},setHeaders:function(e){this.options.use_cdt&&e&&(o.setAuthorizationHeader(e),e.setRequestHeader("X-Requested-With","XMLHttpRequest"))},addFormData:function(e,i){if(this.options.use_cdt){if(t.isObject(i)){var s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"});e.append("item",s)}}else for(var n in i)i.hasOwnProperty(n)&&e.append(n,i[n])},getInputName:function(){return this.options.use_cdt?"file":this.options.input_name?this.options.input_name:"primaryFile"},getServiceName:function(e){var i;if(this.canChunkUpload()&&e.isChunkedUpload)if(e.isChunkError)i="FILECHUNK_BULK_DELETE";else if(e.isChunkComplete)i="CHECKIN_CHUNKED_FILE";else{var s=e.getChunkConfig();i=s.forceServiceError&&t.isNumber(this.chunkCount)&&this.chunkCount%s.serviceErrorFreq==0?"FILECHUNK_CREATE_BAD":"FILECHUNK_CREATE"}else i=this.options.service_name?this.options.service_name:"CHECKIN_UNIVERSAL";return i},canChunkUpload:function(){return!(this.options.use_cdt||this.options.service_name&&"CHECKIN_UNIVERSAL"!==this.options.service_name)},isSystemFile:function(){return this.options.system_file},_getConfirmationInfo:function(e,i){if(!this.options.confirm)return null;if(e&&e.isFile){var s=e.get("name"),n=t.pluck(i,"name").join();return{title:"UPLOAD_NEW_VERSION_CONFIRM_TITLE",message:s===n?docs.i18n.t("UPLOAD_NEW_VERSION_CONFIRM_MSG_SAME",s):docs.i18n.t("UPLOAD_NEW_VERSION_CONFIRM_MSG_DIFF",s,n)}}return null}}),docs.upload.BaseUploader})),define("common/upload/view/H5Uploader",["jquery","underscore","core/util/Service","core/util/Globals","common/upload/view/BaseUploader","core/util/FeatureFlags"],(function(e,t,i){"use strict";docs.common.Globals;return docs.upload.H5Uploader=docs.upload.BaseUploader.extend({objectName:"H5Uploader",supportsProgress:!0,initialize:function(e){return docs.upload.BaseUploader.prototype.initialize.call(this,e),t.bindAll(this,"_clickInput","filesDropped"),this.render()},createMenuUploader:function(){var t=this._getUploadElement(),i=t.find("a");this._assignIds(),this.debug("creating menu input element",this.options.original_id,this.options.upload_input_id);var s=this._createInput();s.on("change.uploader",this.filesDropped),e("#"+this.options.uploadContainerId).append(s),s.hide(),i.on("click.uploader",null,{button:t,input:s,buttonClass:"ui-state-hover ui-state-active"},this._clickInput)},removeMenuUploader:function(){if(this.options.original_id){var e=this._getUploadElement().find("a");this._removeHtml5Input(this.options.upload_input_id),e.off(".uploader")}},removeMenuEvents:function(){this.options.original_id&&this._getUploadElement().find("a").off(".uploader")},_removeHtml5Input:function(t){this.trace("removing HTML 5 input",t);var i=e("#"+t);i.off(".uploader"),i.remove()},createButtonUploader:function(){var t=this._getUploadElement();this._assignIds(),this.trace("creating button input element",this.options.original_id,this.options.upload_input_id);var i,s=t.outerHeight(!0)+"px",n=t.outerWidth(!0)+"px",o=this._createInput();o.on("change.uploader",this.filesDropped),this.isToolbarUploader()?e("#"+this.options.uploadContainerId).append(o):(t.wrap('<div id="'+this.options.upload_bb_id+'" class="file-input-wrapper file-input-button"></div>'),i=e("#"+this.options.upload_bb_id),this._styleWrapper(i,"inline",s,n),i.append(o),this._styleInputElement(o,s,n),this._positionInputElement(o,t)),o.hide(),t.on("click.uploader keydown.uploader",null,{button:t,input:o,buttonClass:"ui-state-hover ui-state-active"},this._clickInput),this.options.focusOnCreate&&t.focus()},removeButtonUploader:function(){if(this.trace("removing button input",this.options.original_id),this.options.original_id){var e,t=this._getUploadElement();this.isToolbarUploader()?this._removeHtml5Input(this.options.upload_input_id):((e=t.next()).off(".uploader"),e.remove(),t.unwrap()),t.off(".uploader")}},_createInput:function(){var t=e('<input type="file" />').attr({id:this.options.upload_input_id,name:this.getInputName(),"aria-hidden":"true",title:docs.i18n.t("UPLOAD_BUTTON_TOOLTIP"),tabindex:-1});!1===this.options.single_selection&&t.attr("multiple","multiple");var i=this.getAcceptExtensions();return i&&t.attr("accept",i.join(",")),t},_clickInput:function(t){if("keydown"!==t.type&&"click"===t.type||t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER){this.debug("input button clicked",t.data.input.attr("id")),t.data.input.show(),t.data.input.css({visibility:"hidden"});var i=t.data;i.input.click(),i.button.removeClass(t.data.buttonClass)}},filesDropped:function(e){this.debug("files dropped");var t=e.target.files;null==t&&e.originalEvent.dataTransfer&&(t=e.originalEvent.dataTransfer.files),this.confirmUpload(t)},beforeStartUpload:function(){var t=e("#"+this.options.upload_input_id);t.off("change"),t.remove()},uploadItem:function(s,n){var o,a,r,l;if(this.debug("uploadItem",s.get("name")),this.useChunkedUpload(s)){var u=s.startChunkedUpload();u.progress(t.bind((function(){this._startChunk(s,n)}),this)),u.done(t.bind((function(){s.timerSnapshot("timing:fileUploaded"),(a=this.getCloudServiceParameters(s,n)).OriginalFileName=s.get("name");var o=s.getUploadChunks().getChunkDataRS(),r=this._createHdaText(a,[o]);e.ajax(this.getCloudServiceURL(s),{type:"POST",async:!0,data:r,contentType:"text/hda; charset=utf-8"}).done((function(e,t,n){i.checkResponseForError(e)&&(n.errorHandled=!0),s.endTimer(),s.uploadComplete(e,n.status,t)})).fail(t.bind((function(e,t,i){console.log(r),e.errorHandled=!0,this.uploadFailed(s,{target:e})}),this))}),this))}else s.startUpload(),a=this.getCloudServiceParameters(s,n),l=(r=s.get("item")).name,"main",o={progress:this.uploadProgress,load:this.uploadComplete,error:this.uploadFailed,abort:this.uploadAborted},this.xhr=this._uploadBlob(s,a,o,r,l,"main")},_startChunk:function(e,i){var s=e.getUploadChunks();s.canStartNextChunk()&&s.getNextUploadChunk().then(t.bind((function(t){if(t){var n=this.getCloudServiceParameters(e,i),o=t.get("blob"),a=t.get("sequenceId"),r={progress:this.uploadProgress,load:this.chunkedUploadComplete,error:this.chunkedUploadFailed,abort:this.uploadAborted};t.xhr=this._uploadBlob(e,n,r,o,null,a),s.canStartNextChunk()&&this._startChunk(e,i)}}),this))},_uploadBlob:function(i,s,n,o,a,r){if(o){var l;this.trace("upload parameters",s),(l=new window.XMLHttpRequest).open(this.getCloudServiceMethod(i),this.getCloudServiceURL(i)),this.setHeaders(l);var u=new window.FormData,d=i.getChunkConfig();d.forceTokenError&&t.isNumber(this.chunkCount)&&this.chunkCount%d.tokenErrorFreq==0&&delete s.idcToken,this.addFormData(u,s),u.append(this.getInputName(),o,a),l.upload.addEventListener("progress",e.proxy(n.progress,this,i,r),!1),l.addEventListener("load",e.proxy(n.load,this,i,r),!1),l.addEventListener("error",e.proxy(n.error,this,i,r),!1),l.addEventListener("abort",e.proxy(n.abort,this,i,r),!1),i.startTimer();try{l.send(u)}catch(e){console.log(e)}return l}},logXHR:function(e,t){this.debug(t,e.readyState,e.status,e.statusText)},uploadProgress:function(e,t,i){var s=this._getProgressData(i,t);this.trace("uploadProgress",i,s),e.updateProgress(s)},_getProgressData:function(e,t){var i={};return i.uploadLengthComputable=e.lengthComputable,i.bytesLoaded=e.loaded,e.lengthComputable&&(i.totalBytes=e.total,i.percentComplete=100*e.loaded/e.total),i.sequenceId=t,i},uploadComplete:function(e,t,i){this.debug("uploadComplete"),this.logXHR(i.target,"complete"),e.endTimer(),e.uploadComplete(i.target.responseText,i.target.status,i.target.statusText)},uploadFailed:function(e,t,s){this.debug("upload failed response data",s.target.responseText),i.isSSOLoginPage(s.target)||(this.logXHR(s.target,"failed"),e.uploadFailed(s.target.status,s.target.statusText,t))},uploadAborted:function(e,t){this.debug("upload was aborted"),e.uploadAborted(t)},stopUpload:function(e){this.debug("stop upload"),this.useChunkedUpload(e)||this.xhr&&this.xhr.abort()},chunkedUploadComplete:function(e,t,i){this.debug("chunkedUploadComplete"),this.logXHR(i.target,"chunk complete"),e.uploadChunkComplete(t,i.target.responseText,i.target.status,i.target.statusText)},chunkedUploadFailed:function(e,t,s){this.debug("upload failed response data",s.target.responseText),i.isSSOLoginPage(s.target)||(this.logXHR(s.target,"failed"),e.uploadChunkFailed(t,s.target.responseText,s.target.status,s.target.statusText))},useChunkedUpload:function(e){return!this.options.use_cdt&&(e.isChunkedUpload||e.useChunkedUpload())},cleanupFailedUpload:function(s){var n=e.Deferred(),o=s.getUploadChunks().getDeleteChunkDataRS();if(o){var a=this.getCloudServiceParameters(s),r=this._createHdaText(a,[o]);e.ajax(this.getCloudServiceURL(s),{type:"POST",async:!0,data:r,contentType:"text/hda; charset=utf-8"}).done((function(e,t,s){i.checkResponseForError(e)&&(s.errorHandled=!0),n.resolve(e)})).fail(t.bind((function(e,t,i){e.errorHandled=!0,n.reject(i,e.responseJSON)}),this))}else n.resolve();return n.promise()},_createHdaText:function(e,i){var s="IsJava=1\n<?hda jcharset=UTF-8?>\n@Properties LocalData\n";return t.each(t.keys(e),(function(t){s+=t+"="+e[t]+"\n"})),s+="@end\n",t.each(i,(function(e){s+="@ResultSet "+e.name+"\n",s+=e.fields.length+"\n",t.each(e.fields,(function(e){s+=e.name+"\n"})),t.each(e.rows,(function(e){t.each(e,(function(e){s+=e+"\n"}))})),s+="@end\n"})),s}}),docs.upload.H5Uploader})),define("common/upload/Manager",["jquery","underscore","backbone","core/util/Globals","core/util/Service","core/dialog/MessageDialog","core/util/Logger","common/upload/view/H5Uploader"],(function(e,t,i,docs,s,n,o,a){"use strict";var r={},l=new(i.View.extend({DROP_WRAPPER_ID:".containerview",DROP_MODEL_KEY:"dndmodel",DROP_FOLDER_KEY:"dndfolder",DROP_VIEW_KEY:"dndpageview",DROP_OPTIONS_KEY:"dndoptions",objectName:"UploadManager",logger:"Upload",tagName:"div",className:"upload-hide",id:"upload_manager",initialize:function(){t.bindAll(this,"_isFileTransfer","_fileDragHoverPage","_fileDroppedPage","_fileDragEnter","_fileDragHover","_fileDropped","_onRoute","_navigate","_showNewVersionDialog"),this.idCounter=0;var e=new window.XMLHttpRequest;e&&"upload"in e&&(this.xhr2Support=!0,"onprogress"in e.upload&&(this.xhr2ProgressSupport=!0)),window.File&&window.FileList?this.fileApiSupport=!0:this.fileApiSupport=!1,this.dragAndDrop=this.fileApiSupport,this.multipleFileSelection=this.fileApiSupport;var i=window.navigator.userAgent.toLowerCase();-1===i.indexOf("iphone")&&-1===i.indexOf("ipad")&&-1===i.indexOf("ipod")||(this.iosDevice=!0),-1!==i.indexOf("safari")&&-1===i.indexOf("chrome")&&(-1!==i.indexOf("mac os x")?this.multipleFileSelection=!0:this.multipleFileSelection=!1),this.iosDevice&&(this.multipleFileSelection=!1),this.xhr2Support&&this.fileApiSupport?(o(this.logger).debug("Browser supports upload."),this.uploadDisabled=!1):(o(this.logger).debug("Browser doesn't support upload. Upload disabled."),this.uploadDisabled=!0),o(this.logger).debug("User Agent",i),o(this.logger).debug("XHR2 support",this.xhr2Support),o(this.logger).debug("XHR2 progress support",this.xhr2ProgressSupport),o(this.logger).debug("File API support",this.fileApiSupport),o(this.logger).debug("Drag-n-Drop support",this.dragAndDrop),o(this.logger).debug("Multiple-File Selection support",this.multipleFileSelection),o(this.logger).debug("Client is iOS",this.iosDevice),document.documentMode&&o(this.logger).debug("IE Document Mode=",document.documentMode),this._bindToEvents(),this.render()},close:function(){this._unbindEvents()},_onRoute:function(){this._navigate()},_bindToEvents:function(){i.history.bind("route",this._onRoute),this.listenTo(docs.events,"uploader:starting",this._uploaderStarting),this.listenTo(docs.events,"uploader:reseting",this._uploaderStarting),this.listenTo(docs.events,"uploader:finished",this._uploaderFinished),this.listenTo(docs.events,"uploader:item-starting",this._uploaderItemStarting)},_unbindEvents:function(){i.history.unbind("route",this._onRoute),this.stopListening()},render:function(){return e(this.el).appendTo("#content-wrapper"),this},_newUploader:function(e,t){e||(e={}),e.single_selection||!1!==this.multipleFileSelection||(e.single_selection=!0),this.iosDevice&&(e.iosDevice=this.iosDevice),e.uploadContainerId=this.id;var i=e.browse_button_id?e.browse_button_id:void 0;if(i||t||e.noUI){o(this.logger).debug("options.id",e.id),e.original_id=i,e.id=e.id||this._getUniqueId(),t&&(t.uploader_id=e.id);var s=r[e.id];if(void 0===s){o(this.logger).trace("creating new uploader");this.uploadDisabled||((s=new a(e)).uploader_id=e.id,r[e.id]=s,o(this.logger).trace("number of uploaders",Object.keys(r).length),e&&e.uploader_created_cb&&e.cbContext&&e.uploader_created_cb.call(e.cbContext,e.id),t&&this._startDndUpload(t))}else o(this.logger).trace("uploader exists"),(s=r[e.id]).render(),o(this.logger).trace("number of uploaders",Object.keys(r).length);return e.id}o(this.logger).debug("uploader not created: no browse button id")},_uploaderStarting:function(e){this._destroyUploader(e)},_uploaderFinished:function(){},_uploaderItemStarting:function(e,i){i&&t.isFunction(i)&&t.delay(i,1e3)},_destroyUploader:function(e,t){o(this.logger).debug("_destroyUploader",e,t);var i,s,n=r[e];n&&(n.options&&n.options.uploader_destroyed_cb&&n.options.cbContext&&n.options.uploader_destroyed_cb.call(n.options.cbContext,e),!t&&n.options.persist&&((i=n.options).focusOnCreate=!0,s=n.getParentFolder()),n.destroy()?(o(this.logger).debug("destroyed uploader",e),delete r[e]):this._relocate(e),i&&(o(this.logger).debug("persist uploader"),this._newUploader(i),r[e].setParentFolder(s)));o(this.logger).trace("number of uploaders",Object.keys(r).length)},_setParent:function(e,t){var i=r[e];i&&i.setParent(t)},_setParentFolder:function(e,t){var i=r[e];i&&i.setParentFolder(t)},_getParentFolder:function(e){var t=r[e];return t?t.getParentFolder():null},_getContainerId:function(e){return e?"%%NONE%%"===e?void 0:e:this.id},_relocate:function(t){var i,s=r[t];if(s){var n="#"+s.options.upload_input_id;o(this.logger).debug("need to relocate uploader",t,n),delete r[t],i=t+"_reloc",s.uploader_id=i,s.options.original_id=void 0,r[i]=s;var a=e(n);a.detach(),e("#"+this.id).append(a)}return i},_fileDragHoverPage:function(t){var i=e(t.target).closest(this.DROP_WRAPPER_ID);return this._togglePageHighlight(i,t.type,this._isFileTransfer(t)),this._toggleDropEffect(i,t),t.stopPropagation(),t.preventDefault(),t.originalEvent.returnValue=!1,!1},_postionPageDTH:function(t){var i=t,s=t,n=e(".drop-target-dth-l"),o=e(".drop-target-dth-r"),a=e(".drop-target-dth-t"),r=e(".drop-target-dth-b"),l=e(".drop-target-dth-v"),u=e(".drop-target-dth-h"),d={};d.top=i.offset().top,d.left=i.offset().left,d.bottom=s.offset().top+s.height()-l.width(),d.right=s.offset().left+s.width()-l.width(),d.height=d.bottom-d.top,d.width=d.right-d.left+l.width(),n.offset({top:d.top,left:d.left}),o.offset({top:d.top,left:d.right}),l.height(d.height),a.offset({top:d.top,left:d.left}),r.offset({top:d.bottom,left:d.left}),u.width(d.width)},_togglePageHighlight:function(i,s,n){"dragover"===s&&n?(i.addClass("drop-target"),this._postionPageDTH(i),this.dthHideTimer&&(window.clearTimeout(this.dthHideTimer),delete this.dthHideTimer),t.defer((function(){e(".drop-target-dth").show()}))):(i.removeClass("drop-target"),this.dthHideTimer=window.setTimeout((function(){delete this.dthHideTimer,e(".drop-target-dth").hide()}),0))},_toggleHighlight:function(e,t,i){"dragover"===t&&i?e.addClass("drop-target").addClass("drop-target-highlight"):e.remove("drop-target").removeClass("drop-target-highlight")},_toggleDropEffect:function(e,t){if(t.originalEvent.dataTransfer){var i=e.hasClass("drop-target")?"copy":"none";t.originalEvent.dataTransfer.dropEffect=i}},_fileDroppedPage:function(t){if(void 0!==t.originalEvent.dataTransfer&&this._isFileTransfer(t)){var i=e(t.target).closest(this.DROP_WRAPPER_ID);this._togglePageHighlight(i,t.type,this._isFileTransfer(t));var s=t.target.files||t.originalEvent.dataTransfer.files,n=t.originalEvent.dataTransfer.items,a=i.data(this.DROP_MODEL_KEY),r=i.data(this.DROP_OPTIONS_KEY);o(this.logger).debug("drop on current (parent) folder",a.get("id"),s,n),this._newDndUploader(a,s,void 0,r,n)}},_isFileTransfer:function(e){if(void 0===e.originalEvent.dataTransfer)return!0;var t=0;if(e.originalEvent.dataTransfer.types){o(this.logger).debug("e.originalEvent.dataTransfer.types",e.originalEvent.dataTransfer.types,e.originalEvent.dataTransfer);for(var i=!1,s=!1,n=!1,a=0;a<e.originalEvent.dataTransfer.types.length;a++)switch(e.originalEvent.dataTransfer.types[a]){case"Files":i=!0,t++;break;case"text/x-moz-url":case"Url":s=!0;break;case"text/uri-list":case"Text":n=!0}if(o(this.logger).debug("files",i,"fileCount",t,"mozUrl",s,"uriList",n),i&&s&&n)return!1;if(i)return!0}return!1},_fileDragEnter:function(e){return e.stopPropagation(),e.preventDefault(),e.originalEvent.returnValue=!1,!1},_fileDragHover:function(t){var i=e(t.target).closest(".containerview-item");return this._toggleHighlight(i,t.type,this._isFileTransfer(t)),this._toggleDropEffect(i,t),t.stopPropagation(),t.preventDefault(),t.originalEvent.returnValue=!1,!1},_fileDropped:function(i){if(void 0!==i.originalEvent.dataTransfer&&this._isFileTransfer(i)){var n=e(i.target).closest(".containerview-item");this._toggleHighlight(n,i.type,this._isFileTransfer(i));var a=i.target.files||i.originalEvent.dataTransfer.files,r="drop on folder";n.hasClass("folderview-filerow")&&(r="drop on file"),o(this.logger).debug(r,n.attr("id"),a);var l=n.data(this.DROP_MODEL_KEY),u=n.data(this.DROP_FOLDER_KEY),d=n.data(this.DROP_OPTIONS_KEY);return o(this.logger).debug(r,l.get("id"),a),l.isFile&&1===a.length&&l.get("name")!==a[0].name&&s.isRealFile(a[0],o(this.logger))?t.defer(this._showNewVersionDialog,l,a,u,d):this._newDndUploader(l,a,u,d),!1}},_showNewVersionDialog:function(e,i,s,o){var a=this,r=docs.i18n.t("UPLOAD_NEW_VERSION_CONFIRM_MSG_DIFF",e.get("name"),i[0].name);n.show({title:docs.i18n.t("UPLOAD_NEW_VERSION_CONFIRM_TITLE"),message:r,okButtonText:docs.i18n.t("YES"),callback:function(){a._newDndUploader(e,i,s,o)},cancelButtonText:docs.i18n.t("NO"),cancelCallback:t.noop,reverseButtons:"no",defaultButton:"ok"})},_newDndUploader:function(t,i,s,n,a){o(this.logger).debug("_newDndUploader",t,i),this._newUploader(e.extend({parentModel:t,parentFolder:s,uploadNew:n?n.uploadNew:void 0},n),{files:i,items:a})},_startDndUpload:function(e){o(this.logger).debug("_startDndUpload",e);var t=r[e.uploader_id];t&&t.addFiles(e.files,e.items)},_getUniqueId:function(){return this.idCounter=this.idCounter+1,this.cid+"_"+this.idCounter},_supportsDragDrop:function(){return this.dragAndDrop},_navigate:function(){e(this.DROP_WRAPPER_ID).off(".dnd")},_getInputId:function(e){var t=r[e];return t?t.options.upload_input_id:null},_getUploadQueue:function(e){var t=r[e];return t?t.getUploadQueue():null},_resumeUpload:function(e,t){var i=r[e];if(i)return i.resumeUpload(t)}}));return docs.upload.Manager={DEFAULT_CONTAINER:"%%NONE%%",newUploader:function(e,t){return l._newUploader(e,t)},destroyUploader:function(e){return l._destroyUploader(e,!0)},setParent:function(e,t){l._setParent(e,t)},setParentFolder:function(e,t){l._setParentFolder(e,t)},getParentFolder:function(e){return l._getParentFolder(e)},supportsDragDrop:function(){return l._supportsDragDrop()},supportsProgress:function(){return l.progress},relocate:function(e){return l._relocate(e)},setupPageDnDUpload:function(t,i,n){var o=n.containerView||e(l.DROP_WRAPPER_ID);o.off(".dnd");var a=i.has("roleName")&&s.hasRole(i.get("roleName"),"contributor");!i.isTrash&&(i.isAllowedAction("folderWrite")||a)&&l._supportsDragDrop()&&(o.on("dragenter",l._fileDragEnter).on("dragover.dnd",l._fileDragHoverPage).on("dragleave.dnd",l._fileDragHoverPage).on("drop.dnd",l._fileDroppedPage),o.data(l.DROP_MODEL_KEY,i),o.data(l.DROP_VIEW_KEY,t),o.data(l.DROP_OPTIONS_KEY,n))},setupDnDUpload:function(t,i,s,n){s.isTrash||s.isSearchResults||s.isFavorites||!(i.isFolder&&i.isAllowedAction("folderUpdate")||i.isFile&&i.isAllowedAction("fileUpdate"))||!l._supportsDragDrop()||(e(t.el).on("dragenter",l._fileDragEnter).on("dragover",l._fileDragHover).on("dragleave",l._fileDragHover).on("drop",l._fileDropped),e(t.el).data(l.DROP_MODEL_KEY,i),e(t.el).data(l.DROP_FOLDER_KEY,s),e(t.el).data(l.DROP_OPTIONS_KEY,n))},isInputElement:function(e){return/\_bb_\d+_input/.test(e)},isInputWrapper:function(e){return/view\d+_\d+_bb_\d+/.test(e)},getInputId:function(e){return l._getInputId(e)},getUploadQueue:function(e){return l._getUploadQueue(e)},resumeUpload:function(e,t){return l._resumeUpload(e,t)}},docs.upload.Manager})),define("common-docs-upload-15b22b9.cache",(function(){}));