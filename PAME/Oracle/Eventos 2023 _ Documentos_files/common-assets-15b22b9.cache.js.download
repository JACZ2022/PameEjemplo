define("common/assets/ComponentCache",["core/util/Logger"],(function(e){var t={},i=e("componentcache");return{put:function(e,r){if(!e||!r)throw new Error("key and value should be present");t[e]=r,i.debug("Adding component: "+e+" to component cache")},get:function(e){if(!e)throw new Error("key should be present");return i.debug("Getting value for component: "+e+" from component cache"),t[e]},delete:function(e){e&&(i.debug("Removing component: "+e+" from component cache"),delete t[e])},reset:function(){i.debug("Resetting component cache"),t={}}}})),define("common/assets/backend",["jquery","underscore","core/util/Globals","core/util/Service","core/util/Session","core/util/Jsonify","core/util/Logger","common/asset/AssetsJsonify","core/util/SitesJsonify","common/assets/settings","core/view/MessageBar","common/assets/ComponentCache"],(function(e,t,docs,i,r,s,n,o,a,l,c,u){"use strict";var d=n("backend");function p(e){var i=[];return function r(s){if(!s)return;s.level||(s.level=1);i.push(s),s.children&&s.children.length>0&&s.children.forEach((function(i){r(function(i,r){var s=t.find(e,{id:i});s&&(s.level=r+1);return s}(i,s.level))}))}(e[0]),i}return{sendRequest:function(t,i){var r=e.Deferred();return(i=i||{}).success=function(e,t,i){r.resolve(e,t,i)},i.error=function(e,t,i){r.reject(e,t,i)},e.ajax(t,i),r.promise()},getAllLayouts:function(){var t=e.Deferred();return e.get({url:i.formatServiceUrl("SCS_BROWSE_APPS"),data:{appType:"contentlayout",appCount:-1,returnAllPublishedOrSharedApps:1},success:function(e){var i=sites.common.SitesJsonify.parse_SCS_BROWSE_APPS_METADATA(e).map((function(e){return e.scsName})).sort((function(e,t){return e.localeCompare(t)}));t.resolve(i)},error:function(e,i,r){d.debug("Error fetching  layouts  :",r),t.reject(e,i,r)}}),t.promise()},getAllSites:function(){var t=e.Deferred();return e.get({url:i.formatServiceUrl("SCS_BROWSE_SITES"),data:{sitesSortField:"fFolderName",siteCount:-1},success:function(e){var sites=a.parse_SCS_BROWSE_SITES_METADATA(e).sort((function(e,t){return e.scsName.localeCompare(t.scsName)}));t.resolve(sites)},error:function(e,i,r){d.debug("Error fetching  sites  :",r),t.reject(e,i,r)}}),t.promise()},getSitePages:function(t){var r=i.formatServiceUrl("SCS_GET_STRUCTURE"),s=[],n=e.Deferred();return r+="&siteId="+t,r+="&IsJson=1",e.ajax(r,{type:"GET",success:function(e){s=p(s=e.base&&e.base.pages?e.base.pages:[]),n.resolve(s)},error:function(e,t,i){d.debug("Error fetching  sites  :",i),n.reject(e,t,i)}}),n.promise()},getContentItems:function(t){var i=l.endpoints.serverURL+l.endpoints.items+'?q=((type%20eq%20"'+t+'"))',s=e.Deferred();return e.ajax(i,{type:"GET",contentType:"application/json",beforeSend:function(e){r.setAuthorizationHeader(e)},success:function(e){return s.resolve(e)},error:function(e,t,i){d.debug("Error fetching content items :",i),s.reject(e,t,i)}}),s.promise()},fetchLocalizedLanguageNames:function(i){var r=e.Deferred(),s=docs.common.Globals.localizedLangNames;if(i=i||docs.common.Globals.lang,s[i])r.resolve(s[i]);else{var n=[],o=0;n.push(this.getLanguageCodes(i,o)),n[0].done(function(a){if(a.hasMore)for(var l=a.count,c=Math.ceil(a.totalResults/l),u=1;u<c;u++)o+=l,n.push(this.getLanguageCodes(i,o));e.when.apply(e,n).done((function(){var e,n=[];t.each(arguments,(function(e){var i;if(Array.isArray(e)){var r=t.find(e,(function(e){return e.items}));r&&(i=r.items)}else e.items&&(i=e.items);i&&(n=n.concat(i))})),e=t.map(n,(function(e){var i;return"default"!==e.languageType&&e.description?i=e.description:(i=e.language,e.territory&&(i+=" ("+e.territory+")")),t.extend(e,{id:e.code,name:i})})),t.sortBy(e,"id"),s[i]=e,r.resolve(e)})).fail((function(e){r.reject(e)}))}.bind(this)).fail((function(e){r.reject(e)}))}return r.promise()},getLanguageCodes:function(t,i){var r="/content/management/api/v1.1/l10n/languageCodes?links=none&totalResults=true&limit=300&lang="+t;return i&&(r+="&offset="+i),e.ajax(r,{type:"GET",contentType:"application/json"})},getChannelTokens:function(){return new Promise((function(t,i){e.ajax("/content/management/api/v1.1/channels?offset=0&fields=channelTokens&limit=1000",{success:function(e){t(e)},error:function(e,t,r){d.debug("Error getting channels:",r),i("Error retrieving channels")}})}))},getCustomFieldEditors:function(r){var s=e.Deferred(),n=this;return e.get({url:i.formatServiceUrl("SCS_BROWSE_APPS"),data:{appType:"fieldeditor",appCount:-1,returnAllPublishedApps:1},success:function(e){var i=a.parse_SCS_BROWSE_APPS_METADATA(t.clone(e)).filter((function(e){return e.scsIsActive})).filter((function(e){return!r||!r.editorNames||r.editorNames.includes(e.scsName)})).map((function(e){return e.scsName})).sort((function(e,t){return e.localeCompare(t)}));i&&i.length>0?n.getAppInfoFiles(i).then((function(e){var t=e;r&&r.datatype&&(t=t.filter((function(e){var t=e.supportedDatatypes;return t&&-1!==t.indexOf(r.datatype)}))),d.debug("List of custom field  editors returned:",t),s.resolve(t)})).catch((function(e){d.debug("Error getting appInfo for: ",i.join(",")),s.resolve([])})):s.resolve([])},error:function(e,t,i){d.debug("Error fetching  attribute editors :",i),s.reject(e,t,i)}}),s.promise()},getAppInfoFiles:function(r){var s=[],n=e.Deferred(),o=!0;if(t.each(r,(function(e){var t=u.get(e);t?s.push(t):o=!1})),o)return n.resolve(s),n.promise();var a=i.formatServiceUrl("SCS_GET_APP_INFO_BATCH");return a+="&appNames="+r.join(","),a+="&includeSecurityInfo=1",d.debug("Components for which appinfo is asked:",r),e.ajax(a,{type:"GET",success:function(e){d.debug("Appinfo files  Response :",e);var i=e;t.each(r,(function(e){var t=i[e].appinfo;t.id=e,t.name=e,s.push(t),u.put(e,t)})),n.resolve(s)},error:function(e,t,i){e.errorHandled=!0,new c({messageText:r.length>1?docs.i18n.t("DOCS_FAILED_GET_APPINFO_COMPONENTS_MULTIPLE",r.join(", ")):docs.i18n.t("DOCS_FAILED_GET_APPINFO_COMPONENTS_SINGLE",r.join(", ")),messageType:"error"}),d.debug("Error fetching  appinfo files for components : :",i),n.reject(e,t,i)}}),n.promise()},getCustomContentForms:function(r){var s=e.Deferred(),n=this;return e.get({url:i.formatServiceUrl("SCS_BROWSE_APPS"),data:{appType:"contentform",appCount:-1,returnAllPublishedApps:1},success:function(e){var i=a.parse_SCS_BROWSE_APPS_METADATA(t.clone(e)).filter((function(e){return e.scsIsActive})).filter((function(e){return!r||!r.editorNames||r.editorNames.includes(e.scsName)})).map((function(e){return e.scsName})).sort((function(e,t){return e.localeCompare(t)}));i&&i.length>0?n.getAppInfoFiles(i).then((function(e){var t=e;d.debug("List of custom forms returned:",t),s.resolve(t)})).catch((function(e){d.debug("Error getting appInfo for: ",i.join(",")),s.resolve([])})):s.resolve([])},error:function(e,t,i){d.debug("Error fetching  custom content forms :",i),s.reject(e,t,i)}}),s.promise()},getAppInfoFile:function(t){var r,s=e.Deferred(),n=u.get(t);if(n)return s.resolve(n),s.promise();var o=i.formatServiceUrl("SCS_GET_APP_INFO_FILE");return o+="&appName="+t,o+="&includeSecurityInfo=1",e.ajax(o,{type:"GET",async:!1,success:function(e,i,n){(r=e.appinfo).id=t,r.name=t,u.put(t,r),s.resolve(r)},error:function(e,t,i){d.debug("Error fetching  attribute editors :",i),s.reject(e,t,i)}}),s.promise()}}})),define("common/assets/CaasTranslationErrors",["jquery","underscore","core/util/Globals"],(function(e,t,docs){"use strict";return{errorMessages:{CAAS_API_ERROR_MESSAGE_0:"Both contentIds and collectionId are provided for translation export",CAAS_API_ERROR_MESSAGE_1:"Collection '{0}' contains no content item for translation export",CAAS_API_ERROR_MESSAGE_2:"Error reading the type of the item translation being imported",CAAS_API_ERROR_MESSAGE_3:"Exception reading the zip {0}",CAAS_API_ERROR_MESSAGE_4:"Failed to create translations for the language: {0}",CAAS_API_ERROR_MESSAGE_5:"Failed to export translation for item '{0}' as it is not in source language",CAAS_API_ERROR_MESSAGE_6:"Failed to generate and check in translation zip",CAAS_API_ERROR_MESSAGE_7:"Failed to get configuration for collection '{0}'",CAAS_API_ERROR_MESSAGE_8:"Failed to get repository Id from collection '{0}'",CAAS_API_ERROR_MESSAGE_9:"Failed to retrieve '{0}' language variation for item '{1}'",CAAS_API_ERROR_MESSAGE_10:"Failed to validate item '{0}' - id might be invalid",CAAS_API_ERROR_MESSAGE_11:"Failed to validate item '{0}'",CAAS_API_ERROR_MESSAGE_13:"Cannot find items for all the target languages",CAAS_API_ERROR_MESSAGE_14:"Failed to validate type '{0}' - name might be invalid",CAAS_API_ERROR_MESSAGE_15:"Get Job Status Failed",CAAS_API_ERROR_MESSAGE_16:"Insufficient privilege on Type: {0}",CAAS_API_ERROR_MESSAGE_17:"Insufficient privilege on export folder",CAAS_API_ERROR_MESSAGE_18:"Insufficient privilege on repository",CAAS_API_ERROR_MESSAGE_19:"Invalid Zip: ContentItems is required in the job.json",CAAS_API_ERROR_MESSAGE_20:"Invalid Zip: Invalid ContentItems in the job.json",CAAS_API_ERROR_MESSAGE_21:"Invalid Zip: sourceLanguage is required in the job.json",CAAS_API_ERROR_MESSAGE_22:"Invalid Zip: targetLanguages is required in the job.json",CAAS_API_ERROR_MESSAGE_23:"Invalid job name",CAAS_API_ERROR_MESSAGE_24:"Invalid job type",CAAS_API_ERROR_MESSAGE_25:"Invalid jobName",CAAS_API_ERROR_MESSAGE_26:"Invalid targetLanguages is provided for translation export",CAAS_API_ERROR_MESSAGE_27:"Invalid variation data for the guid: {0}",CAAS_API_ERROR_MESSAGE_28:"Invalid zip: Incorrect job.json",CAAS_API_ERROR_MESSAGE_29:"Invalid zip: Repositoryid in the import zip is required",CAAS_API_ERROR_MESSAGE_30:"Invalid zip: contentTypes in the job.json is required",CAAS_API_ERROR_MESSAGE_31:"Invalid zip: invalid contentTypes in the job.json is required",CAAS_API_ERROR_MESSAGE_32:"Invalid zip: job.json not found",CAAS_API_ERROR_MESSAGE_33:"Neither contentIds nor collectionId is provided for translation export",CAAS_API_ERROR_MESSAGE_34:"No fFolderGUID is provided for translation export",CAAS_API_ERROR_MESSAGE_35:"No item is defined in source language for translation export",CAAS_API_ERROR_MESSAGE_36:"No sourceLanguage is provided for translation export",CAAS_API_ERROR_MESSAGE_37:"No targetLanguages is provided for translation export",CAAS_API_ERROR_MESSAGE_38:"Not Found",CAAS_API_ERROR_MESSAGE_39:"RepositoryId Validation failed",CAAS_API_ERROR_MESSAGE_40:"Translation export job submit failed",CAAS_API_ERROR_MESSAGE_41:"Translation import job submit failed",CAAS_API_ERROR_MESSAGE_42:"Type Validation failed",CAAS_API_ERROR_MESSAGE_43:"Unable to check user's privilege on folder '{0}' - the id might be invalid",CAAS_API_ERROR_MESSAGE_44:"Unable to check user's privilege on repository '{0}' - the id might be invalid",CAAS_API_ERROR_MESSAGE_45:"Unable to load the variation sets for the guid: {0}",CAAS_API_ERROR_MESSAGE_46:"Unable to search for assets under collection '{0}'",CAAS_API_ERROR_MESSAGE_47:"Unable to update the variation for the guid: {0} Variation not found",CAAS_API_ERROR_MESSAGE_48:"Validation of the import zip failed",CAAS_API_ERROR_MESSAGE_49:"'status' is not defined in translation job update request",CAAS_API_ERROR_MESSAGE_50:"Cannot import to translation job '{0}'",CAAS_API_ERROR_MESSAGE_51:"Cannot resubmit export for translation job '{0}'",CAAS_API_ERROR_MESSAGE_52:"DELETE translation job failed for id '{0}'",CAAS_API_ERROR_MESSAGE_53:"Failed to create translation job '{0}'",CAAS_API_ERROR_MESSAGE_54:"Failed to get translation job '{0}' - the job no longer exists or user has no access to it.",CAAS_API_ERROR_MESSAGE_55:"Failed to import from the zip for translation job '{0}'",CAAS_API_ERROR_MESSAGE_56:"Failed to update status for translation job '{0}' to {1}",CAAS_API_ERROR_MESSAGE_57:"Failed to update translation job '{0}'",CAAS_API_ERROR_MESSAGE_58:"Failed to update translation job '{0}' post export",CAAS_API_ERROR_MESSAGE_59:"Failed to update translation job '{0}' post import",CAAS_API_ERROR_MESSAGE_60:"Failed to validate item '{0}'. Item belongs to a different reposiotry.",CAAS_API_ERROR_MESSAGE_61:"Failed to validate items for export. Some items have no variation in source language '{0}'.",CAAS_API_ERROR_MESSAGE_62:"Get Async Job Task Status Failed",CAAS_API_ERROR_MESSAGE_63:"GET translation job error failed",CAAS_API_ERROR_MESSAGE_64:"GET translation job failed for id '{0}'",CAAS_API_ERROR_MESSAGE_65:"GET translation job status failed",CAAS_API_ERROR_MESSAGE_66:"GET translation jobs failed",CAAS_API_ERROR_MESSAGE_67:"Import zip is for a different translation job than the one defined in import request",CAAS_API_ERROR_MESSAGE_68:"Import zip targets to a different repository than the one defined by import request",CAAS_API_ERROR_MESSAGE_69:"Invalid Zip: ContentItems is required in the job.json",CAAS_API_ERROR_MESSAGE_70:"Invalid Zip: Invalid ContentItems in the job.json",CAAS_API_ERROR_MESSAGE_71:"Invalid zip: invalid contentTypes in the job.json",CAAS_API_ERROR_MESSAGE_72:"Invalid Zip: sourceLanguage is required in the job.json",CAAS_API_ERROR_MESSAGE_73:"Invalid Zip: targetLanguages is required in the job.json",CAAS_API_ERROR_MESSAGE_74:"PUT translation job failed for id '{0}'",CAAS_API_ERROR_MESSAGE_75:"Translation job '{0}' was not created successfully",CAAS_API_ERROR_MESSAGE_76:"translationJobs create failed",CAAS_API_ERROR_MESSAGE_77:"Unable to parse response",CAAS_API_ERROR_MESSAGE_78:"Updating the data of a translation job is not supported",CAAS_API_ERROR_MESSAGE_79:"Updating the file GUID of a translation job is not supported",CAAS_API_ERROR_MESSAGE_80:"Updating the folder GUID of a translation job is not supported",CAAS_API_ERROR_MESSAGE_81:"Updating the id of a translation job is not supported",CAAS_API_ERROR_MESSAGE_82:"Updating the name of a translation job is not supported",CAAS_API_ERROR_MESSAGE_83:"Updating the pending languages of a translation job is not supported",CAAS_API_ERROR_MESSAGE_84:"Updating the name of a translation job is not supported",CAAS_API_ERROR_MESSAGE_85:"Updating the type of a translation job is not supported",CAAS_API_ERROR_MESSAGE_86:"Unable to update translation job. Translation job doesn't exist.",CAAS_API_ERROR_MESSAGE_87:"Unable to get translation job. Translation job doesn't exist.",CAAS_API_ERROR_MESSAGE_88:"Failed to validate content types for import.",CAAS_API_ERROR_MESSAGE_200:"'{0}' is not a valid mode",CAAS_API_ERROR_MESSAGE_201:"'data' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_202:"'fFileGUID' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_203:"'fFolderGUID' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_204:"'id' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_205:"'name' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_206:"'pendingLanguages' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_207:"'repositoryId' specified in the update request is different than current translation job",CAAS_API_ERROR_MESSAGE_208:"'status' must be specified in a translation job update request",CAAS_API_ERROR_MESSAGE_209:"'type' specified in the job update request is different than current translation job",CAAS_API_ERROR_MESSAGE_210:"Cannot find items for all the target languages",CAAS_API_ERROR_MESSAGE_211:"Cannot update a translation job that is in {0} status",CAAS_API_ERROR_MESSAGE_212:"Cannot update the status of a translation job from READY to {0}",CAAS_API_ERROR_MESSAGE_213:"contentIds and collectionId are mutually exclusive and only one of them should be provided",CAAS_API_ERROR_MESSAGE_214:"Dependent item {0} ({1}) is in '{2}' instead of source language '{3}'",CAAS_API_ERROR_MESSAGE_215:"Each target language must be different than the source language",CAAS_API_ERROR_MESSAGE_216:"Failed to create translations for the language: {0} : {1}",CAAS_API_ERROR_MESSAGE_217:"Failed to read item by id '{0}'",CAAS_API_ERROR_MESSAGE_218:"Import zip is not associated with any translation job",CAAS_API_ERROR_MESSAGE_219:"invalid contentTypes in the job.json: externalDocType not found in Job.json",CAAS_API_ERROR_MESSAGE_220:"Invalid variation data for the guid: {0} : {1}",CAAS_API_ERROR_MESSAGE_221:"Invalid variation data for the guid: {0}",CAAS_API_ERROR_MESSAGE_222:"Invalid variation data for the guid: {0}in language {1} : {2}",CAAS_API_ERROR_MESSAGE_223:"It is not an assets translation job",CAAS_API_ERROR_MESSAGE_224:"Item '{0}' belongs to a different repository '{1}'.",CAAS_API_ERROR_MESSAGE_225:"Item '{0}' has no variation in '{1}'",CAAS_API_ERROR_MESSAGE_226:"Job name '{0}' contains illegal character '{1}'",CAAS_API_ERROR_MESSAGE_227:"Job type is required and cannot be null",CAAS_API_ERROR_MESSAGE_228:"jobName is required and cannot be null or empty",CAAS_API_ERROR_MESSAGE_229:"No job folder GUID was returned for translation job '{0}'",CAAS_API_ERROR_MESSAGE_230:"No job ID was returned for translation job '{0}'",CAAS_API_ERROR_MESSAGE_231:"No repositoryId returned from collection configuration '{0}'",CAAS_API_ERROR_MESSAGE_232:"One of contentIds and collectionId is required and it cannot be empty or null",CAAS_API_ERROR_MESSAGE_233:"Only a failed translation job can be resubmitted for export",CAAS_API_ERROR_MESSAGE_234:"Repository with repository Id: {0} does not exist",CAAS_API_ERROR_MESSAGE_235:"Server error",CAAS_API_ERROR_MESSAGE_236:"sourceLanguage is required and it cannot be empty or null",CAAS_API_ERROR_MESSAGE_237:"targetLanguages is required and it cannot be empty or null",CAAS_API_ERROR_MESSAGE_238:"There is another import in progress for the same translation job",CAAS_API_ERROR_MESSAGE_239:"There is no content item under collection '{0}'",CAAS_API_ERROR_MESSAGE_240:"There is no item defined in '{0}' for translation export",CAAS_API_ERROR_MESSAGE_241:"This job has no associated folder to store exported translations",CAAS_API_ERROR_MESSAGE_242:"This job has no data that defines export details",CAAS_API_ERROR_MESSAGE_243:"Translation job in status '{0}' is not ready for importing yet",CAAS_API_ERROR_MESSAGE_244:"User cannot specify where to export translation zip",CAAS_API_ERROR_MESSAGE_245:"User has insufficient privilege on export folder '{0}'",CAAS_API_ERROR_MESSAGE_246:"User has insufficient privilege on repository '{0}'",CAAS_API_ERROR_MESSAGE_247:"User has insufficient privilege on repository '{0}'",CAAS_API_ERROR_MESSAGE_248:"User has insufficient privilege on type :'{0}",CAAS_API_ERROR_MESSAGE_249:"User has insufficient privilege to access the repository with id {0}",CAAS_API_ERROR_MESSAGE_250:" IdcService:SCS_CREATE_TRANS_JOB,Unable to create translation job. Translation job with the name '{0}' already exists.",CAAS_API_ERROR_MESSAGE_251:"Repository does not exist",CAAS_API_ERROR_MESSAGE_252:"RepositoryID from import request should match with what's defined in job.json of import zip",CAAS_API_ERROR_MESSAGE_253:"User has insufficient privilege on type : {0}",CAAS_API_ERROR_MESSAGE_254:"Unsupported encoding of file(s) in the Zip",CAAS_API_ERROR_MESSAGE_255:"All the files in the translation import zip should be UTF-8 encoded",CAAS_API_ERROR_MESSAGE_256:"User has insufficient privilege on type",CAAS_API_ERROR_MESSAGE_257:"Repository of an item cannot be null or empty",CAAS_API_ERROR_MESSAGE_258:"Item Language cannot be null or empty",CAAS_API_ERROR_MESSAGE_259:"Language may not have whitespace: '{0}'",CAAS_API_ERROR_MESSAGE_260:"Invalid or unsupported languages: name field cannot be empty or null",CAAS_API_ERROR_MESSAGE_261:"Number of characters in the name field should be less than or equal to 64",CAAS_API_ERROR_MESSAGE_262:"The following Characters are not permitted in the name field: Single quote('),double quote (\"), semicolon (;), colon (:), less than (<), greater than (>), percent (%), question mark (?),asterisk (*)",CAAS_API_ERROR_MESSAGE_263:"Number of characters in the slug field should be less than or equal to 512",CAAS_API_ERROR_MESSAGE_264:"Number of characters in the description field should be less than or equal to 128",CAAS_API_ERROR_MESSAGE_265:"Item id cannot be null or empty",CAAS_API_ERROR_MESSAGE_266:"Item type cannot be null or empty",CAAS_API_ERROR_MESSAGE_267:"These required fields cannot be null: {0}",CAAS_API_ERROR_MESSAGE_268:"You do not have permission to translate some content items in the job.",CAAS_API_ERROR_MESSAGE_269:"No item is published to site channel for translation export.",CAAS_API_ERROR_MESSAGE_270:"No item is published",CAAS_API_ERROR_MESSAGE_271:"No item is published for translation export",CAAS_API_ERROR_MESSAGE_272:"No translatable items for translation export"},noDetailOnErrors:["CAAS_API_ERROR_MESSAGE_1","CAAS_API_ERROR_MESSAGE_7","CAAS_API_ERROR_MESSAGE_8","CAAS_API_ERROR_MESSAGE_11","CAAS_API_ERROR_MESSAGE_18","CAAS_API_ERROR_MESSAGE_44","CAAS_API_ERROR_MESSAGE_46","CAAS_API_ERROR_MESSAGE_61","CAAS_API_ERROR_MESSAGE_86","CAAS_API_ERROR_MESSAGE_87"],translateErrorString:function(e){for(var t=e,i=Object.keys(this.errorMessages),r=0;r<i.length;r++){var s=this.errorMessages[i[r]];try{var n=new RegExp("^"+s.replace(/{\d}/g,"(.*)")+"$"),o=e.match(n);if(o){o[0]=i[r],t=docs.i18n.t.apply(null,o);break}}catch(e){}}return t},showDetailOnError:function(e){for(var t=-1,i=Object.keys(this.errorMessages),r=0;r<i.length;r++){var s=this.errorMessages[i[r]];try{var n=new RegExp("^"+s.replace(/{\d}/g,"(.*)")+"$");if(e.match(n)){t=r;break}}catch(e){}}return-1===t||-1===this.noDetailOnErrors.indexOf(i[t])},getPresentationMessage:function(e,t){var i=this.translateErrorString(e);return this.showDetailOnError(e)&&t&&(i+=" ("+this.translateErrorString(t)+")"),i},getMessageOfImmediateFailure:function(e){var t="";if(e.responseJSON&&e.responseJSON.title){var i=e.responseJSON.title,r=e.responseJSON.detail;t=this.getPresentationMessage(i,r)}else t=e.statusText;return t},hasExtendedErrorDetails:function(e){if(e&&e.responseJSON){if(e.responseJSON["o:errorCode"])return e.responseJSON.translationJobErrorDetails}else{if(e.LocalData.AssetValidation)return"false"===JSON.parse(e.LocalData.AssetValidation).valid;if(e.LocalData.CaaSExportValidation){var t=JSON.parse(e.LocalData.CaaSExportValidation);return t.invalidItems&&t.invalidItems.length>0}}return""},getErrorDialogColumnsHeader:function(e){var t=[];switch(e){case"TRANSJOB-IMPORT-VALIDATION-ERROR-INVALID_CONTENT_TYPES":t.push(docs.i18n.t("VALIDATE_TRANSLATION_ERROR_CONTENT_TYPE")),t.push(docs.i18n.t("VALIDATE_TRANSLATION_ERROR_DETAIL"));break;case"TRANSJOB-EXPORT-VALIDATION-NO-VARIATION-IN-SOURCE-ERROR":t.push(docs.i18n.t("VALIDATE_TRANSLATION_ERROR_ASSETS"));break;default:t.push(docs.i18n.t("VALIDATE_TRANSLATION_ERROR_NAME"))}return t}}})),define("common/assets/model/AssetItemMember",["jquery","underscore","backbone","core/util/Service","core/util/Globals","common/share/model/ShareUser","core/util/FeatureFlags","common/assets/settings"],(function(e,t,i,r,docs,s,n,o){"use strict";var a=docs.common.Globals;return s.extend({initialize:function(e,t){this.options=t||{},this.options.restAPI=!0,s.prototype.initialize.call(this,e,t),this.item=t.item},getValidRoles:function(){var e=this.item.modelType();return"contenttype"===e?["manager"]:"collection"===e?["contributor","manager"]:["viewer","contributor","manager","custom"]},updateRole:function(t){if(t!==this.get("role")){var i={operations:{share:{resource:{id:this.item.id,name:this.item.get("name"),type:"contenttype"===this.item.modelType()?"type":this.item.modelType()},roles:[{name:t,users:[{name:this.get("loginId"),type:this._getMemberType(),groupType:this.get("groupOriginType")}]}]}}};e.ajax(o.endpoints.serverURL+"/permissionOperations?links=none",{type:"POST",data:JSON.stringify(i),contentType:"application/json"}).done(function(e){if(e&&e.operations&&e.operations.share&&e.operations.share.failedRoles&&e.operations.share.failedRoles.length>0){var i=e.errorThrown||{detailMessage:e.operations.share.failedRoles[0].users[0].message};this.trigger("updateRole:error",this,i,"error",e)}else this.set("role",t),this.trigger("updateRole:success",this);this.get("id")!==a.userid&&this.get("id")!==a.userLogin||window.location.reload(!0)}.bind(this))}},removeRole:function(){this._sendUnshareRequest().done(function(e,t,i){if(e&&e.operations&&e.operations.unshare&&e.operations.unshare.failedUsers&&e.operations.unshare.failedUsers.length>0){var r=i.errorThrown||{detailMessage:e.operations.unshare.failedUsers[0].message};this.trigger("unshare:error",this,r,t,i)}else{var s=e.operations.unshare.successUsers[0].name||e.operations.unshare.successUsers[0].id;s!==a.userid&&s!==a.userLogin||docs.events.trigger("assetItem:leave",this.get("itemId")),this.trigger("destroy",this)}}.bind(this)).fail(function(e,i){var r=null;e.errorThrown?r=e.errorThrown:e.responseJSON&&(r=t.extend({detailMessage:e.message},e.responseJSON)),this.trigger("unshare:error",this,r,i,e)}.bind(this))},_sendUnshareRequest:function(){var t={operations:{unshare:{resource:{id:this.item.id,name:this.item.get("name"),type:"contenttype"===this.item.modelType()?"type":this.item.modelType()},users:[{name:this.get("loginId"),type:this._getMemberType(),groupType:this.get("groupOriginType")}]}}};return e.ajax(o.endpoints.serverURL+"/permissionOperations?links=none",{type:"POST",data:JSON.stringify(t),contentType:"application/json"})},_getMemberType:function(){return this.has("type")?this.get("type"):this.isGroup()?"group":"user"}})})),define("common/assets/model/AssetItemMembersList",["jquery","underscore","backbone","core/util/Globals","core/util/ErrorMsg","common/share/model/SharedUserList","common/share/ShareErrorMap","common/assets/model/AssetItemMember","common/assets/settings"],(function(e,t,i,docs,r,s,n,o,a){"use strict";var l=docs.common.Globals;return s.extend({model:o,modelId:function(e){return e.id+"."+e.type+"."+e.groupOriginType},initialize:function(e,t){this.options=t||{},this.options.restAPI=!0,s.prototype.initialize.call(this,e,this.options),this.fetched=!1,this.item=t.item},url:function(){var e=this.item.url().split("?")[0]+"/permissions";return e+="?offset=0&limit=1000&links=none","collection"===this.item.modelType()&&(e+="&isCollectionOnly=true"),e},parse:function(e){var i,r,s=l.userLogin,n=this.item.get("createdBy"),a=t.chain(e.items).map((function(e){return{id:e.id,name:t.isNull(e.fullName)?e.email:e.fullName,type:e.type,value:e.email,role:e.roleName,loginId:e.id,itemId:this.item.id,groupOriginType:e.groupType}}),this).filter((function(e){var t=!0;return e.id===s?(i=e,t=!1):e.id===n&&(r=e,t=!1),t})).value();return n===s?i?i.role="owner":i={id:l.userid,name:l.userName,loginId:l.userLogin,type:"user",role:"owner"}:(r?r.role="owner":r={id:this.item.get("createdBy"),name:this.item.get("createdByName"),type:"user",loginId:this.item.get("createdByLoginId"),role:"owner"},this.owner=new o(r,{item:this.item})),i&&(this.you=new o(i,{item:this.item})),this.item.collaborators=this,this.fetched=!0,a},addCollaborators:function(i,r,s){var n={operations:{share:{resource:{id:this.item.id,name:this.item.get("name"),type:"contenttype"===this.item.modelType()?"type":this.item.modelType()},roles:[{name:r,message:s,users:t.map(i,(function(e){return{name:e.loginId,type:e.type,groupType:e.groupOriginType}}))}]}}};e.ajax(a.endpoints.serverURL+"/permissionOperations?links=none",{type:"POST",data:JSON.stringify(n),contentType:"application/json",success:function(e){this.processPermOpsResponse(e,i)}.bind(this),error:function(e,t,r){!r.errorMsgKey||-1===r.errorMsgKey.indexOf("csFldDoesNotExist")&&-1===r.errorMsgKey.indexOf("csItemInTrash")?e&&e.operations&&e.operations.share&&(e.operations.share.successRoles||e.operations.share.failedRoles)?this.processPermOpsResponse(e,i):this.trigger("addCollaborators:error",i,r,t,e):docs.events.trigger("FolderViewDetail:reload")}.bind(this)})},isEditable:function(){return this.item.hasRole("manager")},processPermOpsResponse:function(e,i){var s=e.operations.share.successRoles?e.operations.share.successRoles:[],o=e.operations.share.failedRoles?e.operations.share.failedRoles:[],a={item:this.item};if(s.length>0&&0===o.length)this.add(i,a),this.trigger("addCollaborators:success",i,e);else{if(s.length>0){var l=[];t.chain(s).pluck("users").flatten().each((function(e){var r=t.findWhere(i,{loginId:e.name});l.push(r)}),this);var c=t.pluck(l,"loginId");i=t.reject(i,(function(e){return t.contains(c,e.name)})),this.add(l,a)}var u=o[0].users[0].message;0===u.indexOf("!cs")&&(u=r.getErrorMessageFromSet(n.SharingErrorMap,{errorMsgKey:u},{LocalData:{folderName:this.item.get("name"),dUserIDs:o[0].users[0].id}})),this.trigger("addCollaborators:error",i,null,u,e)}}})})),define("common/assets/model/Channel",["jquery","underscore","backbone","core/util/Globals","core/util/Service","common/container/config","common/container/model/ContainerItem","common/assets/model/AssetItemMembersList","common/assets/settings","core/util/FeatureFlags"],(function(e,t,i,docs,r,s,n,o,a,l){"use strict";var c=docs.common.Globals;return n.extend({isFolder:!1,isChannel:!0,sideboards:function(){return["channel_properties"]},initialize:function(e,t){this.options=t||{},this.options.restAPI=!0,this.setUxIcon(),n.prototype.initialize.call(this,e,this.options)},url:function(e){e=e||this.options;var t=a.endpoints.serverURL+"/channels";return this.id&&(t+="/"+this.id),e.fields?"none"!==e.fields&&(t+="?includeAdditionalData=true&fields="+this.options.fields):t+="?includeAdditionalData=true&fields=all",t},fetch:function(t){return this.isNew()?(this.fetchDfd=e.Deferred(),this.trigger("change"),this.fetchDfd.resolve()):this.fetchDfd=i.Model.prototype.fetch.call(this,t),this.fetchDfd},validate:function(e){return e.name&&0!==e.name.trim().length?e.name.search(/[';":?<%>{}\\#\/*]/)>-1?"!nameIllegalChars":["CON","PRN","AUX","NUL","COM0","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT0","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"].indexOf(e.name.trim().toLocaleUpperCase())>-1?"!nameReservedWord":void 0:"!missingName"},uxIcon:"oj-ux-ico-custom-publishing-channel-edit",setUxIcon:function(){this.get("isSiteChannel")&&(this.uxIcon="oj-ux-ico-custom-publishing-channel")},getThumbnailUrl:function(){return this.get("isSiteChannel")?c.staticRoot+"images/iconmap/Site_Publishing_Channel_white_48.png":c.staticRoot+"images/iconmap/Custom_Publishing_Channel_white_48.png"},getCollaborators:function(){var e;return this.collaborators?e=this.collaborators:(e=new o([],{item:this})).fetch({item:this}),e},modelType:function(){return"channel"},refreshToken:function(){var t=this.url();t.indexOf("?")>-1?t+="&refreshTokens=true":t+="?refreshTokens=true";var i=this;return e.ajax(t,{type:"PUT",success:function(e){i.set(e)}})},getChannelSecret:function(){var t=this.url({fields:"none"});t+="/channelSecret";var i=this;return e.ajax(t,{type:"POST",success:function(e){e&&(i.channelSecret=e.channelSecret,i.trigger("change:channelSecret"))}})},refreshChannelSecret:function(){var t=this.url({fields:"none"});t+="/channelSecret";var i=this;return e.ajax(t,{type:"PUT",success:function(e){e&&(i.channelSecret=e.channelSecret,i.trigger("change:channelSecret"))}})},revokeChannelSecret:function(){var t=this.url({fields:"none"});t+="/channelSecret";var i=this;return e.ajax(t,{type:"DELETE",success:function(){delete i.channelSecret,i.trigger("change:channelSecret")}})}})})),define("common/assets/model/LocalizationPolicy",["jquery","underscore","backbone","core/util/Globals","core/util/Service","common/container/config","common/container/model/ContainerItem","common/asset/AssetsJsonify","common/assets/model/AssetItemMembersList","common/assets/settings"],(function(e,t,i,docs,r,s,n,o,a,l){"use strict";var c=docs.common.Globals;return n.extend({urlRoot:l.endpoints.serverURL+"/localizationPolicies",isFolder:!1,isLocalizationPolicy:!0,initialize:function(e,i){(i=i||{}).restAPI=!0,n.prototype.initialize.call(this,e,i),e=t.defaults(e||{},{name:"",description:""}),this.set(e)},modelType:function(){return"localization"},fetch:function(t){return this.isNew()?(this.fetchDfd=e.Deferred(),this.trigger("change"),this.fetchDfd.resolve()):this.fetchDfd=i.Model.prototype.fetch.call(this,t),this.fetchDfd},validate:function(e){return e.name&&0!==e.name.trim().length?e.name.search(/[';":?<%>{}\\#\/*]/)>-1?"!nameIllegalChars":void 0:"!missingName"},uxIcon:"oj-ux-ico-domain",getThumbnailUrl:function(){return c.staticRoot+"images/iconmap/Localization_Policy_white_48.png"},getCollaborators:function(){return null}})})),define("common/assets/CaasJobUtils",["jquery","underscore","backbone","core/util/Session","common/assets/settings","core/extensions"],(function(e,t,i,r,s){"use strict";var n=i.Klass.extend({},{getIdsFromJobLink:function(i){var s=[];return t.isEmpty(i)||e.ajax(i,{type:"GET",async:!1,dataType:"json",beforeSend:function(e){r.setAuthorizationHeader(e)},success:function(e){if(s=e.items,s=e.items,e.hasMore&&e.links&&e.links.length>0){var i=t.findWhere(e.links,{rel:"next"});if(i&&!t.isEmpty(i.href)){var r=n.getIdsFromJobLink(i.href);t.isArray(r)&&(s=s.concat(r))}}},error:function(e){e.errorHandled=!0}}),s},pollJob:function(i,s,o){e.ajax(i,{type:"GET",contentType:"application/json",beforeSend:r.setAuthorizationHeader,success:function(e,r,a){e&&e.status?"submitted"===e.status.toLowerCase()||"inprogress"===e.status.toLowerCase()||"processing"===e.status.toLowerCase()||"pending"===e.status.toLowerCase()?(t.delay(n.pollJob,200,i,s,o),o&&e.statusPercent&&o.set("percentComplete",Number(e.statusPercent))):"success"===e.status.toLowerCase()||"completed"===e.status.toLowerCase()||"succeeded"===e.status.toLowerCase()?(s.resolve(e),o&&o.set("percentComplete",100)):"failed"===e.status.toLowerCase()&&s.reject(a,e.status,e.message):s.reject(a,e.status,e.message)},error:function(e,t,i){e.errorHandled=!0,s.reject(e,t,i)}})},pollBulkJobStatus:function(i,s,o){o=o||{},e.ajax(i,{type:"GET",contentType:"application/json",beforeSend:r.setAuthorizationHeader,success:function(e,r,a){if(!e||"pending"!==e.progress&&"processing"!==e.progress&&"paused"!==e.progress)"succeeded"===e.progress?s.resolve(e):s.reject(a,e.status,e.message);else{s.notify(e);var l=200;t.isNumber(o.pollingFrequency)&&(l=o.pollingFrequency),t.isNumber(o.maxFrequency)&&(l=Math.min(o.maxFrequency,l)),t.isNumber(o.frequencyStep)&&(o.pollingFrequency=l+o.frequencyStep),t.delay(n.pollBulkJobStatus,l,i,s,o)}},error:function(e,t,i){e.errorHandled=!0,s.reject(e,t,i)}})},getBulkJobStatusOperationResult:function(e,t){return e&&e.result&&e.result.body&&e.result.body.operations&&e.result.body.operations[t]||void 0},getBulkJobStatusIdsLink:function(e,t){var i=this.getBulkJobStatusOperationResult(e,t);return i&&i.ids&&i.ids.length?i.ids[0].href:void 0},bulkItemsOperation:function(i){i=i||{};var o=e.Deferred(),a=i.noQuery?void 0:this._qetQueryParameter(i),l={operations:i.operation};return i.noQuery||(l.q=a),e.ajax(s.endpoints.serverURL+"/bulkItemsOperations",{type:"POST",data:JSON.stringify(l),contentType:"application/json",beforeSend:function(e){r.setAuthorizationHeader(e),t.isBoolean(i.preferAsync)&&i.preferAsync&&e.setRequestHeader("prefer","respond-async")},success:function(e,r,s){if(202===s.status){var a=s.getResponseHeader("location");t.delay(n.pollBulkJobStatus,i.pollingFrequency||200,a,o,i)}else o.resolve(e)},error:function(e,t,i){e.errorHandled=!0,o.reject(e,t,i)}}),o},_qetQueryParameter:function(e){var i=e.query;return t.isEmpty(i)&&(t.isEmpty(e.ids)||(i=t.map(e.ids,(function(e){return'id eq "'+e+'"'})).join(" OR "))),t.isEmpty(i)&&(i=t.map(e.assets,(function(e){return'id eq "'+e.get("id")+'"'})).join(" OR ")),i},apiRequest:function(i){i=i||{};var o=e.Deferred(),a=i.payload;return e.ajax(s.endpoints.serverURL+i.endpoint,{type:i.type,data:JSON.stringify(a),contentType:"application/json",beforeSend:function(e){r.setAuthorizationHeader(e),t.isBoolean(i.preferAsync)&&i.preferAsync&&e.setRequestHeader("prefer","respond-async")},success:function(e,r,s){if(202===s.status&&i.statusUrl&&"location_header"===i.statusUrl){var a=s.getResponseHeader("location");t.delay(n.pollBulkJobStatus,200,a,o)}else o.resolve(e)},error:function(e,t,i){e.errorHandled=!0,o.reject(e,t,i)}}),o}});return n})),define("common/assets/utils",["jquery","underscore","marked","common/assets/settings","core/util/Globals","core/util/Thumbs","core/util/Service","core/util/Utils","common/assets/constants","core/router/DocsController"],(function(e,t,i,r,docs,s,n,o,a){"use strict";return{isSeededAssetType:function(e){return t.contains(["Image","File","Video","Video-Plus"],e)},getThumbOverlayText:function(e){var t=function(e){var t=e.match(/\.([a-zA-Z0-9]+)$/);return(t&&t[1]||"").toLowerCase()}(e);return s.getThumbDetails(t).overlayText},getCaasImageThumbnailURL:function(e,t,i,n){var o=r.endpoints.serverURL+r.endpoints.assets+"/"+e;return checkFeatureFlag("svg.thumbnail")&&t&&"svg"===t.toLowerCase()?(o+="/native?&timeStamp="+(new Date).getTime(),n&&(o+="&asOf=latestPublished&timeStamp="+(new Date).getTime())):(o+="/thumbnail",i&&(o+="?format="+s.getThumbnailFormat(t)+"&type=uithumbnail&timeStamp="+(new Date).getTime(),n&&(o+="&asOf=latestPublished&timeStamp="+(new Date).getTime()))),o},encodeHtmlEntities:function(e){var i=e;return t.isString(e)&&(i=e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))),i},removeInlineEventAttributes:function(t){if(!t)return null;var i=e("<div></div>").append(e.parseHTML(t));return e("*",i).each((function(t,r){var s=[];e.each(this.attributes,(function(e,t){t.name&&t.name.toLowerCase().startsWith("on")&&s.push(t.name)})),e.each(s,(function(t,s){e(r,i).removeAttr(s)}))})),i.html()},blockNoAccessLinks:function(t){if(!t)return"";var i=this.i18n.t("NO_PERMISSION_TO_VIEW_ASSET"),r=this.i18n.t("BP_ASSET_NO_PERMISSION_MSG"),s=e("<div></div>").append(e.parseHTML(t)),n=new RegExp(a.general.NO_REF_ACCESS_IMAGE+"\\?id=(CONT[A-Z0-9]+|CORE[A-Z0-9]+)\\?*([^\"')]{0,})","g");return e("*",s).each((function(t,o){e.each(this.attributes,(function(t,s){if(s.name&&"href"===s.name.toLowerCase()){var a=s.value;if(a)a.match(n)&&(e(o).attr("title",r),e(o).attr("onclick","alert('"+i+"');event.preventDefault();event.stopPropagation()"))}})),e.each([],(function(t,i){e(o,s).removeAttr(i)}))})),s.html()},isString:function(e){return t.isString(e)},isArray:function(e){return t.isArray(e)},isFunction:function(e){return t.isFunction(e)},isBoolean:function(e){return t.isBoolean(e)},isObject:function(e){return t.isObject(e)},isEqual:function(e,i){return t.isEqual(e,i)},clone:function(){for(var t=[!0,{}],i=0;i<arguments.length;i++)t.push(arguments[i]);return e.extend.apply(null,t)},extend:function(){return e.extend.apply(null,arguments)},getCurrentLocale:function(){return docs.common.Globals.lang},i18n:{t:function(){return docs.i18n.t.apply(docs.i18n,arguments)}},renderTemplate:function(e,t){if(!e)throw new Error("No template function passed in");return(t=t||{}).i18n=docs.i18n,e(t)},router:{navigate:docs.router.navigate.bind(docs.router)},getBoilerplateHtml:function(e){var t=docs.common.Globals.staticRoot;return o.getGenericBoilerplateHtml("bp-large bp-redwood-illustration",t+"images/Boilerplate_Error.png",e.summary,e.detail)},getMarkdownHTML:function(e){return e?i.parse(e):e},getDrawerClass:function(e){var i;if(e&&t.isString(e))switch(e.toLowerCase()){case"responsive100":case a.drawerSize.FULL:i="flex-100-width-dialog";break;case"responsive50":case a.drawerSize.HALF:i="half-width-dialog";break;case"fixedsmall":case a.drawerSize.SMALL:i="flex-small-width-dialog";break;case"fixedlarge":case a.drawerSize.LARGE:i="flex-large-width-dialog";break;case a.drawerSize.MEDIUM:i="flex-medium-width-dialog"}return i},canAccess:function(e,t){var i=!0;return e&&Array.isArray(e)&&(i=e.some((function(e){return e.action===t}))),i},canEditAsset:function(e){var t={isEditable:!0,reason:""};if(!e)return t.isEditable=!1,t.reason="No item response",t;if(!(!e.lockInfo||!e.lockInfo.data)&&e.lockInfo.data.isLocked&&!(!(!e.lockInfo||!e.lockInfo.data)&&(!e.lockInfo.data.lockedBy||e.lockInfo.data.lockedBy===docs.common.Globals.userLogin)))return t.isEditable=!1,t.reason="Editing asset is not permitted as the asset is currently locked by another user.",t;if(e.permissions){var i=e.permissions.data||[];if(!this.canAccess(i,"update"))return t.isEditable=!1,t.reason="You do not have permission to edit this asset",t}return t},getComponentPath:function(e,t){var i="/_themes/_components/"+e+"/publish/assets/edit.html#"+t;if(checkFeatureFlag("ComponentCacheKey")){var r=docs.common.Globals.componentCacheKey;r&&(i="/_compdelivery/"+r+"/"+e+"/assets/edit.html#"+t)}return i}}})),define("common/assets/CaasServiceUtils",["jquery","core/util/Globals","core/util/Session","core/util/Logger","common/assets/settings"],(function(e,docs,t,i,r){"use strict";new i("CaasServiceUtils");return{isSlugUnique:function(i,s){var n=r.endpoints.serverURL+r.endpoints.slugQueriesURL,o=e.Deferred();return e.ajax({url:n,type:"get",data:{slugquery:i,GUID:s||""},dataType:"json",beforeSend:function(e){t.setAuthorizationHeader(e)},success:function(e,t,i){o.resolve(!(e.totalResults>0))},error:function(e,t,i){o.reject(i)}}),o.promise()},isTaxonomyPropertyUnique:function(i,s,n){var o=r.endpoints.serverURL+"/taxonomies/"+s+"/categoryProperties?",a=e.Deferred();return o+='q=(apiName eq "'+i+'" ',e.ajax({url:o,type:"GET",contentType:"application/json",beforeSend:function(e){t.setAuthorizationHeader(e)},success:function(e,t,r){if(e&&e.items&&e.items.length>0){var s=e.items.filter((function(e){return e.id!==n})),o=[];s&&s.length>0&&(o=s.filter((function(e){return e.apiName===i}))),a.resolve(!(o.length>0))}else a.resolve(!0)},error:function(e,t,i){a.reject(i)}}),a.promise()},isCategoryAPINameUnique:function(i,s,n){var o=r.endpoints.serverURL+"/taxonomies/"+s+"/categories?",a=e.Deferred();return o+='q=(apiName eq "'+i+'" ',o+='and (status eq "draft" or status eq "promoted" or status eq "published")',o+=")",e.ajax({url:o,type:"GET",contentType:"application/json",beforeSend:function(e){t.setAuthorizationHeader(e)},success:function(e,t,i){if(e&&e.items&&e.items.length>0){var r=e.items.filter((function(e){return e.id!==n}));a.resolve(!(r&&r.length>0))}else a.resolve(!0)},error:function(e,t,i){a.reject(i)}}),a.promise()},getCurrentWindowOrigin:function(){return window.location.origin}}})),define("common/assets/utils/ValidatorUtils",["underscore","ajv/ajv.min","core/util/FeatureFlags","common/assets/CaasServiceUtils","text!ajv/lib/refs/json-schema-draft-04.json"],(function(e,t,i,r,s){"use strict";function n(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function o(e){this.options=e||{},this.errorMessageSummary=e.errorMessageSummary||"",this.errorMessageDetail=e.errorMessageDetail||"",this.handlesMultivalued=e.handlesMultivalued||!1}function a(e){this.options=e}function l(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),this.errorMessageDetail=e&&e.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_SPACE_PREFIX")}function c(e){this.options=e}function u(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function d(t){this.options=t,this.max=t&&e.isNumber(t.max)?t.max:256,this.min=t&&e.isNumber(t.min)?t.min:0,this.ignoreEmpty=!(!t||void 0===t.ignoreEmpty)&&t.ignoreEmpty}function p(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function m(e){this.options=e}function h(t){this.options=t,this.max=t&&e.isNumber(t.max)?t.max:2147483647,this.min=t&&e.isNumber(t.min)?t.min:-2147483648,this.errorMessageSummaryMin=t&&t.errorMessageSummaryMin||"",this.errorMessageSummaryMax=t&&t.errorMessageSummaryMax||"",this.errorMessageDetailMin=t&&t.errorMessageDetailMin||"",this.errorMessageDetailMax=t&&t.errorMessageDetailMax||""}function g(e){this.options=e,this.collection=e.collection,this.prop=e.prop,this.indexInCollection=e.indexInCollection,this.errorMessageSummary=e.errorMessageSummary,this.errorMessageDetail=e.errorMessageDetail,this.mixedCase=e&&e.mixedCase||!1,this.isNew=!!e.isNew,this.exists=!!e.exists}function f(e){this.arrayObj=e.arrayObj,this.getArrayObj=e.getArrayObj,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||"",this.isCaseInsensitive=e.caseInsensitive||!1}function A(e){this.options=e}function _(e){this.options=e}function R(e){this.options=e}function E(e){this.options=e,this.fields=e.fields||[],this.schema=e.schema,this.isRequired=e.isRequired}function S(e){this.options=e,this.schema=e.schema}function y(e){this.options=e}function I(e){this.options=e,this.testProfile=e.profile,this.testProfiles=e.profiles}function v(e){this.options=e,this.attributeView=e.attributeView,this.form=e.form}function O(e){this.options=e}function M(e){this.options=e,this.typesCollection=e.typesCollection}function D(e){if(this.options=e,this.ootbCategories=[],e&&e.ootbCategories&&Array.isArray(e.ootbCategories))for(var t=0;t<e.ootbCategories.length;t++)this.ootbCategories.push(e.ootbCategories[t].toLowerCase())}function C(e){this.options=e}function T(e){this.options=e}function b(e){this.options=e}function P(e){this.options=e}function N(e){this.options=e}function L(e){this.options=e,this.regex=e.regex,this.flags=e.flags,this.validOnMatch=void 0===e.validOnMatch||e.validOnMatch,this.errorMessageSummary=e.errorMessageSummary,this.errorMessageDetail=e.errorMessageDetail}function V(e){if(e&&"function"==typeof e.match){var t=e.match(/(\d{4}-\d{2}-\d{2})T.*/);if(!t||2!==t.length)throw new Error("Expecting date as an ISO8601 string");e=t[1]+"T00:00:00";var i=new Date(e),r=i.getTime();return i=new Date(r)}}function x(e){if(e){this.options=e;var t=V(e.min),i=V(e.max);this.min=t?t.getTime():null,this.max=i?i.getTime():null}}function G(e){this.options=e}function j(e){this.options=e}function F(e){this.options=e,this.handlesMultivalued=this.options&&this.options.handlesMultivalued,this.min=this.options&&this.options.min||0,this.max=this.options&&this.options.max||Number.MAX_SAFE_INTEGER}function w(e){this.options=e,this.GUID=e.GUID,this.async=!0}function U(e){this.options=e,this.taxonomyId=e.taxonomyId,this.taxonomyPropertyId=e.taxonomyPropertyId,this.async=!0}function k(e){this.options=e,this.taxonomyId=e.taxonomyId,this.categoryId=e.categoryId,this.apiNamePrefix=e.apiNamePrefix||"",this.async=!0}function q(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function J(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function H(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function B(e){this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function z(e){this.reservedWords=["name","description","tags"],this.options=e,this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}function W(e){this.options=e}function X(e){this.options=e}function Y(e){this.options=e,this.fieldProps=e.fieldProps}function $(e){this.options=e,this.allowedFileTypes=e.allowedFileTypes||[],this.errorMessageSummary=e&&e.errorMessageSummary||"",this.errorMessageDetail=e&&e.errorMessageDetail||""}return n.prototype={validate:function(e){return null==e||""===e?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_EMPTY"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_EMPTY_DETAIL")}:{isValid:!0}},changeEvent:"keyup"},o.prototype={validate:function(e){var t=!1;if(this.handlesMultivalued){if(e&&Array.isArray(e))for(var i=0;i<e.length;i++){if(Array.isArray(e[i])){if(e[i].some((function(e){return!!e}))){t=!0;break}}else if(e[i]){t=!0;break}}}else if(e&&Array.isArray(e))for(var r=0;r<e.length;r++){var s=e[r];if(null!=s&&""!==s){t=!0;break}}return!1===t?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_EMPTY"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_EMPTY_DETAIL")}:{isValid:!0}}},a.prototype={validate:function(e){return e&&/[';":?<%>{}#]/.test(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL")}:{isValid:!0}}},a.prototype.changeEvent="keyup",l.prototype={validate:function(e){return e&&0===e.indexOf(" ")?{isValid:!1,errorMessageSummary:this.errorMessageSummary,errorMessageDetail:this.errorMessageDetail}:{isValid:!0}}},c.prototype={validate:function(e){return e&&/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/.test(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_ALPHANUMERIC_DETAIL")}:{isValid:!0}}},u.prototype={validate:function(e){return e&&/[!@$%^&*\-()+|~=`\\#{}\[\]:";'<>?,.\/]/.test(e)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL_GENERIC")}:{isValid:!0}},changeEvent:"keyup"},d.prototype={validate:function(t){var i={isValid:!0};if(e.isString(t)&&(0===t.length&&this.ignoreEmpty||(t.length>this.max?i={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_INVALID_TEXT"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_LENGTH_MAX",this.max)}:t.length<this.min&&(i={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_INVALID_TEXT"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_LENGTH_MIN",this.min)}))),Array.isArray(t)&&t.length>0)for(var r=0;r<t.length;r++)null!==t[r]&&(t[r].length>this.max?i={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_INVALID_TEXT"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_LENGTH_MAX",this.max)}:t[r].length<this.min&&(i={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_INVALID_TEXT"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_LENGTH_MIN",this.min)}));return i}},p.prototype={validate:function(e){return isNaN(e)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_NUMBER"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NAN_DETAIL")}:null===e?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("INVALID_VALUE"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NULL_DETAIL")}:{isValid:!0}}},m.prototype={validate:function(e){var t={isValid:!0};if(e){var i="function"==typeof e.match?e.match(/^(.*[0-9])%/):null;if(i&&2===i.length){var r=Number(i[1]);r>0&&r<=100||(t={isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_PERCENTAGE"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_PERCENTAGE_DETAIL")})}else(isNaN(e)||Number(e)<=0)&&(t={isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_NUMBER"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NAN_DETAIL")})}else t={isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("INVALID_VALUE"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NULL_DETAIL")};return t}},h.prototype={validate:function(t){return e.isFunction(this.options.min)&&(this.min=this.options.min.apply()),e.isFunction(this.options.max)&&(this.max=this.options.max.apply()),e.isFunction(this.options.errorMessageSummaryMin)&&(this.errorMessageSummaryMin=this.options.errorMessageSummaryMin.apply(this,[{min:this.min,value:t}])),e.isFunction(this.options.errorMessageDetailMin)&&(this.errorMessageDetailMin=this.options.errorMessageDetailMin.apply(this,[{min:this.min,value:t}])),e.isFunction(this.options.errorMessageSummaryMax)&&(this.errorMessageSummaryMax=this.options.errorMessageSummaryMax.apply(this,[{max:this.max,value:t}])),e.isFunction(this.options.errorMessageDetailMax)&&(this.errorMessageDetailMax=this.options.errorMessageDetailMax.apply(this,[{max:this.max,value:t}])),e.isNumber(t)?t>this.max?{isValid:!1,errorMessageSummary:this.errorMessageSummaryMax||docs.i18n.t("ERROR_VALIDATION_NUMBER"),errorMessageDetail:this.errorMessageDetailMax||docs.i18n.t("ERROR_VALIDATION_NUMBER_MAX",this.max)}:t<this.min?{isValid:!1,errorMessageSummary:this.errorMessageSummaryMin||docs.i18n.t("ERROR_VALIDATION_NUMBER"),errorMessageDetail:this.errorMessageDetailMin||docs.i18n.t("ERROR_VALIDATION_NUMBER_MIN",this.min)}:{isValid:!0}:{isValid:!0}}},g.prototype={validate:function(e){for(var t,i,r,s=[],n=0;n<this.collection.length;n++){if(t=this.collection.models[n],this.exists?n!==this.indexInCollection:this.isNew||n!==this.indexInCollection){var o=(i=this.prop,r=t.attributes,i.split(".").reduce((function(e,t){return e?e[t]:void 0}),r));!0===this.mixedCase?s.push(o.toLowerCase()):s.push(o)}}return!0===(!0===this.mixedCase?e&&s.indexOf(e.toLowerCase())>=0:s.indexOf(e)>=0)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_SUMMARY"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_DETAIL")}:{isValid:!0}},changeEvent:"keyup"},f.prototype={validate:function(e){var t=this.arrayObj,i=this;return"function"==typeof this.getArrayObj&&(t=this.getArrayObj()),t.some((function(t){return t&&e&&i.isCaseInsensitive?t.toLowerCase()===e.toLowerCase():t===e}))?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_SUMMARY"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_DETAIL")}:{isValid:!0}}},A.prototype={validate:function(e){if(e)try{return"object"==typeof e&&(e=JSON.stringify(e)),JSON.parse(e),{isValid:true}}catch(e){return{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_SYNTAX"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_JSON_SUMMARY")}}return{isValid:true}}},_.prototype={validate:function(e){var t=!0;if(e)try{var i=JSON.parse(e);if(i.options){Array.isArray(i.options)||(t=!1);for(var r=0;r<i.options.length;r++)i.options[r].hasOwnProperty("value")&&i.options[r].hasOwnProperty("label")||(t=!1)}return i.defaultValues&&(Array.isArray(i.defaultValues)||(t=!1)),!1===t?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON")}:{isValid:t}}catch(e){return{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON")}}return{isValid:t}}},R.prototype={validate:function(i){var r=!0,n=new t({schemaId:"id"});if(n.addMetaSchema(JSON.parse(s)),i){try{i=JSON.parse(i)}catch(e){return{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_SYNTAX"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_JSON_SUMMARY")}}try{if(n.compile(i),"object"===i.type)r=!0;else if("array"===i.type&&i.items){var o=i.items;e.isArray(o)?e.each(o,(function(e){"object"!==e.type&&(r=!1)})):e.isObject(o)&&"object"!==o.type&&(r=!1)}else r=!1;if(!r)return{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_SCHEMA"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_JSON_SCHEMA_OBJECT_SUMMARY")}}catch(e){return console.error("Error in validating JSON Schema. "+e),{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_SCHEMA"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_JSON_SCHEMA_SUMMARY")}}}return{isValid:r}}},E.prototype={validate:function(t){var i=!0;if(this.schema&&Array.isArray(this.schema.required)&&this.schema.required.length){var r=this.schema.required;this.isRequired||"object"==typeof t&&e.keys(t).length?this.fields.forEach((function(e){-1!==r.indexOf(e.name)&&e.validate()})):this.isRequired||null!==t||this.fields.forEach((function(e){-1!==r.indexOf(e.name)&&"object"==typeof e.validation&&e.validation.notOptional&&(e.validation.notOptional.status=!0)}))}return this.fields.forEach((function(e){e.isValid()||(i=!1)})),i?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_JSON_FORM"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_JSON_FORM_SUMMARY")}}},S.prototype={validate:function(e){var i=new t({schemaId:"id"});if((i.addMetaSchema(JSON.parse(s)),e)&&("string"==typeof e&&(e=JSON.parse(e)),!i.compile(this.schema)(e)))return console.error(i.errors),{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_DATA"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_JSON_DATA_SUMMARY")};return{isValid:!0}}},y.prototype={validate:function(e){return e&&/[;":?<%>{}/\\\|*#]/.test(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL_GENERIC")}:{isValid:!0}},changeEvent:"keyup"},I.prototype={validate:function(e){if(this.testProfiles)return e!==this.testProfile.get("name")&&-1!==this.testProfiles.models.map((function(e){return e.get("name").toLowerCase()})).indexOf(e?e.toLowerCase():null)?{isValid:!1,errorMessageSummary:docs.i18n.t("TEST_PROFILE_NAME_EXISTS"),errorMessageDetail:docs.i18n.t("TEST_PROFILE_NAME_EXISTS_DETAIL",e)}:{isValid:!0}},changeEvent:"keyup"},v.prototype={validate:function(e){if(this.attributeView)for(var t=this.form.widgets,i=0,r=t.length;i<r;i++){var s=t[i];if(s!==this.attributeView.attrNameSelect&&"testProfileUniqueAttr"===s.model.attributes.validation.validators[0].type&&s.model.attributes.value===e)return{isValid:!1,errorMessageSummary:docs.i18n.t("PROFILE_ATTRIBUTE_ALREADY_USED"),errorMessageDetail:docs.i18n.t("PROFILE_ATTRIBUTE_ALREADY_USED")}}return{isValid:!0}}},O.prototype={validate:function(e){return e&&/[;":?<%>{}/\\\|*]/.test(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL_GENERIC")}:{isValid:!0}},changeEvent:"keyup"},M.prototype={validate:function(e){return this.typesCollection&&-1!==this.typesCollection.items.map((function(e){return e.get("name").toLowerCase()})).indexOf(e?e.toLowerCase():null)?{isValid:!1,errorMessageSummary:docs.i18n.t("CAAS_ASSET_TYPE_EXISTS"),errorMessageDetail:docs.i18n.t("CAAS_ASSET_TYPE_EXISTS_DETAIL",e)}:{isValid:!0}},changeEvent:"keyup"},D.prototype={validate:function(e){return e?(e=e.toLowerCase(),-1!==this.ootbCategories.indexOf(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("CAAS_CATEGORY_EXISTS"),errorMessageDetail:docs.i18n.t("CAAS_CATEGORY_EXISTS_DETAIL",e)}:{isValid:!0}):{isValid:!0}}},C.prototype={validate:function(e){return!e||/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/.test(e)?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_URL"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_URL_DETAIL")}}},T.prototype={validate:function(e){return!e||/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_EMAIL"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_EMAIL_DETAIL")}}},b.prototype={validate:function(e){return e&&null!==e.match(/["-#|%-&|:-@|\[-^|{-}`~/]/g)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_URL_CHARS_DETAIL",'" # % &  : ; < > = ? @ [ ] \\ ^ ` { } | ~ /')}:{isValid:!0}}},P.prototype={validate:function(e){return e&&null!==e.match(/["-#|%-&|:-@|\[-^|{-}`~]/g)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_URL_CHARS_DETAIL",'" # % &  : ; < > = ? @ [ ] \\ ^ ` { } | ~ ')}:{isValid:!0}}},N.prototype={validate:function(e){return e&&null!==e.match(/[\\'"<`|>]/g)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_URL_CHARS_DETAIL",'"  < >  \\ ^ ` | ')}:{isValid:!0}}},L.prototype={validate:function(e){var t;try{t=this.flags?new RegExp(this.regex,this.flags):new RegExp(this.regex)}catch(i){return t=null,e?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_REGEX"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_REGEX_CANNOT_MATCH_DETAIL","")}:{isValid:!0}}var i=t.test(e);return this.validOnMatch?i||!e?{isValid:!0}:{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_REGEX"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_REGEX_DETAIL",this.regex)}:i&&e?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_REGEX"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_REGEX_CANNOT_MATCH_DETAIL",this.regex)}:{isValid:!0}}},x.prototype={validate:function(t){if(e.isFunction(this.options.min)&&(this.min=new Date(this.options.min.apply()).getTime()),e.isFunction(this.options.max)&&(this.max=new Date(this.options.max.apply()).getTime()),Object.prototype.hasOwnProperty.call(this.options,"validateOnEachValue")&&!this.options.min&&!this.options.max)return{isValid:!1};if(t&&t.value){var i=new Date(t.value).getTime();return this.min&&i<this.min?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_DATE_RANGE"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_DATE_MIN",new Date(this.min).toLocaleString())}:this.max&&i>this.max?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_DATE_RANGE"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_DATE_MAX",new Date(this.max).toLocaleString())}:{isValid:!0}}return{isValid:!0}}},G.prototype={validate:function(e){var t;try{t=new RegExp(e)}catch(e){t=null}return t?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_REGEX"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_REGEX_DETAIL")}}},j.prototype={validate:function(e){var t=!0;if(e&&/u|y/.test(e))t=!1;else try{new RegExp("a",e)}catch(e){t=!1}return t?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_REGEX_FLAGS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_REGEX_FLAGS_DETAIL")}}},F.prototype={validate:function(t){var i,r;e.isFunction(this.options.min)&&(this.min=this.options.min.apply()),e.isFunction(this.options.max)&&(this.max=this.options.max.apply()),this.handlesMultivalued?(t&&(r=t[0]),i=r&&r.length||0):(r=t,i=t&&t.length||0);var s={isValid:!0};if(i<this.min?s={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_RANGE"),errorMessageDetail:1===this.min?docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MIN_SINGULAR"):docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MIN",this.min)}:i>this.max&&(s={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_RANGE"),errorMessageDetail:1===this.max?docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MAX_SINGULAR"):docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MAX",this.max)}),this.min>0){var n=0;r.forEach((function(e){""!==e&&null!=e&&n++})),n<this.min&&(s={isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_RANGE"),errorMessageDetail:1===this.min?docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MIN_SINGULAR"):docs.i18n.t("ERROR_VALIDATION_CAAS_FIELD_ENTRIES_MIN",this.min)})}return s}},w.prototype={validate:function(e){return r.isSlugUnique(e,this.GUID).then((function(e){return e?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_CAAS_UNIQUE_SLUG_SUMMARY"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_CAAS_UNIQUE_SLUG_DETAIL")}}))}},U.prototype={validate:function(e){return r.isTaxonomyPropertyUnique(e,this.taxonomyId,this.taxonomyPropertyId).then((function(t){return t?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("TAXONOMY_PROPERTY_UNIQUE"),errorMessageDetail:docs.i18n.t("TAXONOMY_PROPERTY_EXISTS",e)}}))}},k.prototype={validate:function(e){return r.isCategoryAPINameUnique(this.apiNamePrefix+e,this.taxonomyId,this.categoryId).then((function(e){return e?{isValid:!0}:{isValid:!1,errorMessageSummary:docs.i18n.t("CATEGORY_APINAME_UNIQUE"),errorMessageDetail:docs.i18n.t("CATEGORY_APINAME_EXISTS")}}))}},q.prototype={validate:function(e){return e&&/^[a-z0-9\-_]+\s*$/i.test(e)?{isValid:!0}:{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("FILE_INVALID_NAME_TITLE"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("FILE_INVALID_CHARS","< >  ? : / \\ |")}}},J.prototype={validate:function(e){return e&&/[\/\\*"<>|?':]/.test(e)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL_GENERIC")}:{isValid:!0}},changeEvent:"keyup"},H.prototype={validate:function(e){return e&&/[\/\\*"?':<%>{}]/.test(e)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_DETAIL_GENERIC")}:{isValid:!0}},changeEvent:"keyup"},B.prototype={validate:function(e){var t=e.trim(),i=t.match(/^(\.|\.\.|con|prn|aux|clock\$|nul|null|com[0-9]|lpt[0-9]|\.ds_store)$/i);return t.length>0&&null!==i?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_RESERVED_WORD"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_RESERVED_WORD_DETAIL",t)}:{isValid:!0}}},z.prototype={validate:function(e){return e&&this.reservedWords.indexOf(e.toLowerCase())>=0?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("ERROR_VALIDATION_RESERVED_WORD"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("ERROR_VALIDATION_RESERVED_WORD_DETAIL",e)}:{isValid:!0}}},W.prototype={validate:function(e){return e&&/[;":?<%>{}#]/.test(e)?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_INVALID_CHARS_GROUP_DETAIL")}:{isValid:!0}}},W.prototype.changeEvent="keyup",X.prototype={validate:function(e){var t=!1;if(e&&Array.isArray(e)){var i=e.map((function(e){return null!=e?e.id:null}));t=i.some((function(e,t){return null!==e&&i.indexOf(e)!=t}))}return t?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_MUTLI_REFERENCE_VALUE"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_NON_UNIQUE_MUTLI_REFERENCE_VALUE_DETAIL")}:{isValid:!0}}},Y.prototype={validate:function(e){return e&&this.fieldProps.valuecountMin>1?{isValid:!1,errorMessageSummary:docs.i18n.t("ERROR_VALIDATION_DEFAULT_VALUE_NOT_ALLOWED"),errorMessageDetail:docs.i18n.t("ERROR_VALIDATION_DEFAULT_VALUE_NOT_ALLOWED_DETAIL")}:{isValid:!0}}},$.prototype={validate:function(t){if(t&&this.allowedFileTypes){var i="";return t&&t.extension?i=t.extension:t&&t.name&&(i=e.last(t.name.split("."))),-1===this.allowedFileTypes.map((function(e){return e.toLowerCase()})).indexOf(i?i.toLowerCase():null)?{isValid:!1,errorMessageSummary:this.errorMessageSummary||docs.i18n.t("CAAS_WRONG_FILE_TYPE"),errorMessageDetail:this.errorMessageDetail||docs.i18n.t("CAAS_WRONG_FILE_TYPE_DETAIL",i)}:{isValid:!0}}return{isValid:!0}}},{validators:{required:n,multiRequired:o,xss:a,length:d,numrange:h,isNumber:p,isNumberOrPercentage:m,uniqueInCollection:g,uniqueInArray:f,contentType:M,isJSON:A,jsonOptions:_,isJSONSchema:R,validJSONForm:E,validJSONSchemaData:S,url:C,email:T,urlchars:b,urlcharsWithSlash:P,urlPlaceholder:N,"custom-regex":L,daterange:x,recommendationItemName:y,testProfile:I,testProfileUniqueAttr:v,caasItemName:O,category:D,nonAlphaNumeric:c,nonAlphaNumericNonHyphan:u,spacePrefix:l,validRegex:G,validRegexFlags:j,caasEditorRange:F,uniqueSlug:w,uniqueCategoryAPIName:k,uniqueTaxonomyProperty:U,duplicateMultiValue:X,noDefaultValue:Y,fileName:q,jobName:J,sitePlanName:H,reservedWords:B,fieldReservedWords:z,groupName:W,fileType:$,custom:function(e){this.options=e,this.validate=e.validate||function(){return{}}}},getValidator:function(t){var i,r;e.isString(t)?(i=t,r=null):(i=t.type,r=t.options);var s=this.validators[i];if(s){var n=new s(r);return n.type=i,n}},validate:function(t,i,r){var s,n={isValid:!0},o=[];e:for(var a=0;a<i.length;a++){var l=i[a];if(l.options&&l.options.validateOnEachValue&&e.isArray(t)){if(t.length>0){for(var c=0;c<t.length;c++)if(s=l.validate(t[c]),l.async)o.push(s);else if(!s.isValid){n=s;break e}}else if(s=l.validate(void 0),l.async)o.push(s);else if(!s.isValid){n=s;break}}else if(s=l.validate(t),l.async)o.push(s);else if(!s.isValid){n=s;break}}return o.length&&(n.validationPromises=o),n}}})),define("common/assets/utils/ConverterUtils",["underscore"],(function(e){"use strict";function t(e){this.options=e,this.style=e.style,this.minimumFractionDigits=void 0!==e.minimumFractionDigits?e.minimumFractionDigits:0,this.maximumFractionDigits=void 0!==e.maximumFractionDigits?e.maximumFractionDigits:0,this.useGrouping=void 0!==e.useGrouping&&e.useGrouping,this.formatDuringParse=e.formatDuringParse,this.noFormat=void 0!==e.noFormat&&e.noFormat}function i(e){this.options=e,this.formatDuringParse=e&&e.formatDuringParse||!1}function r(e){this.options=e,this.formatDuringParse=e&&e.formatDuringParse||!1}function s(e){this.options=e||{},this.formatDuringParse=e&&e.formatDuringParse||!1}function n(e){this.options=e,this.validPlaceholders=e&&e.validPlaceholders}function o(e){this.options=e,this.placeholderMap=e.placeholderMap||{},this.slugify=e.slugify||!1}function a(e){this.options=e,this.formatDuringParse=e&&e.formatDuringParse||!1}function l(e){this.options=e,this.formatDuringParse=e&&e.formatDuringParse||!1}return t.prototype={parse:function(t){return null==t||""===t?null:("decimal"==this.style&&(e.isNumber(t)?i=t:e.isString(t)?(i=parseFloat(t),isNaN(i)&&(i=0)):i=0),this.formatDuringParse&&(i=parseFloat(i.toFixed(this.maximumFractionDigits))),i);var i},format:function(t){if(this.noFormat)return t;var i={style:this.style,useGrouping:this.useGrouping,minimumFractionDigits:this.minimumFractionDigits,maximumFractionDigits:this.maximumFractionDigits};return e.isNumber(t)?t.toLocaleString("en-US",i):""}},i.prototype={parse:function(t){return!0===this.formatDuringParse&&e.isString(t)&&(t=t.replace(/ /g,"-")),t},format:function(t){return e.isString(t)&&(t=t.replace(/ /g,"-")),t}},r.prototype={parse:function(t){return!0===this.formatDuringParse&&e.isString(t)&&(t=t.replace(/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"-")),t},format:function(t){return e.isString(t)&&(t=t.replace(/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"-")),t}},s.prototype={parse:function(t){return!0===this.formatDuringParse&&e.isString(t)&&e.each(this.options.conversions,(function(e){t=t.replace(e.find,e.replace)})),t},format:function(t){return e.isString(t)&&e.each(this.options.conversions,(function(e){t=t.replace(e.find,e.replace)})),t}},n.prototype={parse:function(e){var t="";if(this.validPlaceholders&&this.validPlaceholders.length){for(var i,r=this.validPlaceholders.join("|"),s=new RegExp(r,"g"),n=0;null!==(i=s.exec(e));){var o=i[0],a=i.index;t+=e.substring(n,a).replace(/ /g,"-"),t+=o,n=a+o.length}t+=e.substring(n,e.length).replace(/ /g,"-")}else t=e.replace(/ /g,"-");return t},format:function(e){return e?e.toLowerCase():""}},o.prototype={parse:function(e){return e},format:function(e){var t=this,i=e;return Object.keys(this.placeholderMap).forEach((function(e){i=i.replace(new RegExp(e,"g"),t.placeholderMap[e])})),this.slugify&&(i=i.replace(/ /g,"-")),i}},a.prototype={parse:function(t){return this.formatDuringParse&&e.isString(t)&&(t=(t=(t=t.replace(/ /g,"-")).replace(/[_\-!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"")).replace(/^(.)/,(function(e){return e.toLowerCase()}))),t},format:function(t){return e.isString(t)&&(t=(t=(t=t.replace(/ /g,"")).replace(/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"")).toLowerCase()),t}},l.prototype={parse:function(t){return this.formatDuringParse&&e.isString(t)&&(t=(t=(t=t.replace(/ /g,"-")).replace(/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"")).replace(/^(.)/,(function(e){return e.toLowerCase()}))),t},format:function(t){return e.isString(t)&&(t=(t=(t=t.replace(/ /g,"")).replace(/[!@$%^&*()+|~=`\\#{}\[\]:";'<>?,.\/]/g,"")).toLowerCase()),t}},{converters:{number:t,space:i,nonAlphaNumeric:r,customChar:s,slugify:n,"caas-placeholder":o,apiName:l,character:a},getConverter:function(t){var i,r;e.isString(t)?(i=t,r=null):(i=t.type,r=t.options);var s=this.converters[i];if(s)return new s(r)}}})),define("common/assets/model/ContentField",["underscore","backbone","common/assets/settings","common/assets/utils","common/assets/utils/ValidatorUtils","common/assets/utils/ConverterUtils"],(function(e,t,i,r,s,n){"use strict";var o="media",a="reference",l="DigitalAsset",c="DigitalAssetType";function u(e,t,i,r){for(var s=t.get(e)||{},n=s,o=0;o<i.length-1;o++)n[i[o]]=n[i[o]]||{},n=n[i[o]];n[i[i.length-1]]=r,t.set(e,s)}return t.Model.extend({constructor:function(i,s){var n=r.clone(i);!function(t){t.datatype===o?(t.caasDatatype=a,t.referenceType={types:[],typeCategory:c}):t.caasDatatype=t.datatype,t.datatype===a&&(t.referenceType&&t.referenceType.types||(t.referenceType=t.referenceType||{},t.referenceType.types=[]),Array.isArray(t.referenceType.types)&&(e.contains(t.referenceType.types,l)||t.referenceType.typeCategory===c)&&(t.datatype=o,e.contains(t.referenceType.types,l)&&(t.referenceType.types=e.without(t.referenceType.types,l)))),"json"===t.datatype&&(t.jsonSchema||(t.jsonSchema=null))}(n),function(e){e.valuecount=e.valuecount||"single",!0!==e.required&&!1!==e.required&&(e.required=!0)}(n),this.settings=function(e){var t=e.settings||{},i=t.caas||{};return i.description=i.description||"",i.valuecountRange=i.valuecountRange||null,i.customValidators=i.customValidators||[],i.editor=i.editor||{},i.editor.name=i.editor.name||"",i.editor.options=i.editor.options||{},t.caas=i,e.settings=t,i}(n),n.hint=this.settings.description,this.on("change:valuecount",(function(){"single"===this.get("valuecount")&&this.setValuecountRange(null)})),t.Model.call(this,n,s)},toCaasJSON:function(){var e=this.toJSON(),t=e.caasDatatype,i=e.hint;return e.datatype=t,delete e.caasDatatype,delete e.caasId,delete e.hint,e.settings.caas.description=i,e},isSingleValued:function(){return"single"===this.get("valuecount")},isMultivalued:function(){return"list"===this.get("valuecount")},getValuecountRange:function(){return this.settings.valuecountRange||{min:0}},setValuecountRange:function(e){u("settings",this,["caas","valuecountRange"],"list"===this.get("valuecount")&&e?{min:e.min>>>0,max:e.max?e.max>>>0:null}:null),this.trigger("change")},canHaveTranslation:function(){return"text"===this.get("datatype")||"largetext"===this.get("datatype")||"json"===this.get("datatype")},setCaasTranslation:function(e){e&&(!this.canHaveTranslation()&&e&&(delete e.translate,delete e.note),u("properties",this,["caas-translation"],e),this.trigger("change"))},isNonTranslatable:function(){var e=this.get("properties"),t=!1;return e&&e["caas-translation"]&&(t=!!e["caas-translation"].hasOwnProperty("translate")&&!e["caas-translation"].translate),t},isInheritFromMaster:function(){var e=this.get("properties"),t=!1;return e&&e["caas-translation"]&&(t=!!e["caas-translation"].hasOwnProperty("inheritFromMaster")&&e["caas-translation"].inheritFromMaster),t},getCaasTranslation:function(){var e=this.get("properties");return e&&e["caas-translation"]||{}},getPublishingDependency:function(){var e=this.get("properties");return e&&e.publishingDependency||""},setPublishingDependency:function(e){this.isReference()&&e&&(u("properties",this,["publishingDependency"],e),this.trigger("change"))},getEditorId:function(){return this.settings.editor.name||this.getDefaultEditorId()},setEditorId:function(e){u("settings",this,["caas","editor","name"],e),this.trigger("change")},setEditor:function(e){if(!e)throw new Error('Missing "editor" parameter');this.setEditorId(e.name),this.setEditorOptions(e.options),e.isCustom?this.settings.editor.isCustom=!0:delete this.settings.editor.isCustom},getEditor:function(){var e={name:this.settings.editor.name||this.getDefaultEditorId(),options:this.getEditorOptions()};return this.settings.editor.isCustom&&(e.isCustom=!0),"textarea"===this.settings.editor.name&&"json"===this.get("datatype")&&(e.name="json-textarea"),e},getDefaultEditorId:function(){return i.datatypes[this.get("datatype")].defaultEditor},getDefaultViewerId:function(){return i.datatypes[this.get("datatype")].defaultViewer},getEditorOptions:function(){return this.settings.editor.options},setEditorOptions:function(e){e&&e.defaultValues&&delete e.defaultValues,u("settings",this,["caas","editor","options"],e),this.trigger("change")},getEditorDefaultValues:function(){return this.has("defaultValue")?this.get("defaultValue"):this.settings.editor.options.defaultValues},hasCustomEditor:function(){return!!this.settings.editor.isCustom},getValidators:function(){var e=this.get("datatype"),t=(i.datatypes[e]||{}).validators||[];return(this.getCustomValidators()||[]).concat(t).map((function(e){return s.getValidator(e)}))},getCustomValidators:function(){return this.settings.customValidators||[]},setCustomValidators:function(e){u("settings",this,["caas","customValidators"],e),this.trigger("change")},getConverter:function(){var e=this.get("datatype"),t=this.getEditorId(),r=i.datatypes[e],s=r?r.editors[t]:null,o=s?s.converter:null,a=null;return o&&(a=n.getConverter(o)),a},isReference:function(){var e=this.get("datatype");return e===o||e===a},isMediaReference:function(){return this.get("datatype")===o},getReferenceType:function(){var e,t=this.get("referenceType");return t&&(e=t.type),e}})})),define("assets/model/Extension",["jquery","underscore","backbone","core/util/Globals","core/util/Service","common/assets/backend","common/assets/settings"],(function(e,t,i,docs,r,s,n){"use strict";return i.Model.extend({initialize:function(e){this.options=e||{}},url:function(){},parse:function(e){},fetch:function(e){}})})),define("assets/model/Extensions",["jquery","underscore","backbone","core/util/Globals","core/util/Session","assets/model/Extension"],(function(e,t,i,docs,r,s){"use strict";var n=i.Collection.extend({model:s,initialize:function(e){this.options=e||{},this.extensions={}},fetch:function(){return this.deferred=e.Deferred(),n.getExtensions().then(function(e){e&&(this.extensions=e,docs.common.Globals.extensions=e,this.deferred.resolve(e))}.bind(this),(function(){})),this.deferred}},{serverFileGroupMap:{"image/jpg":"Images","image/jpeg":"Images","image/gif":"Images","image/png":"Images","image/tiff":"Images","image/bmp":"Images","text/html":"Other","application/vnd.openxmlformats-officedocument.presentationml.presentation":"Documents","application/vnd.ms-powerpoint":"Documents","application/pdf":"Documents","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Documents","application/msword":"Documents","text/plain":"Documents","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Documents","application/vnd.ms-excel":"Documents","video/mp4":"Videos","video/mpeg":"Videos","video/quicktime":"Videos","video/x-flv":"Videos","video/x-ms-wmv":"Videos","video/x-ms-asf":"Videos","video/x-ms-asf-plugin":"Videos","application/x-mplayer2":"Videos","video/x-m4v":"Videos","application/vnd.rn-realmedia":"Videos","application/x-shockwave-flash":"Videos","video/x-ms-vob":"Videos","video/divx":"Videos","video/x-msvideo":"Videos","video/ogg":"Videos","video/webm":"Videos","video/3gpp":"Videos","video/3gpp2":"Videos","video/x-matroska":"Videos","application/mxf":"Videos","application/zip":"Other"},getExtensionsPromise:void 0,getExtensions:function(){if(n.getExtensionsPromise)return n.getExtensionsPromise;const i=e.Deferred();return e.ajax("/content/management/api/v1.1/fileExtensions?limit=1000&links=none",{type:"GET",contentType:"application/json",beforeSend:function(e){r.setAuthorizationHeader(e)},success:function(e){e.items.forEach((function(e){n.serverFileGroupMap[e.mimeType]?e.fileGroup=n.serverFileGroupMap[e.mimeType]:e.mimeType.startsWith("text/")?e.fileGroup="Documents":e.mimeType.startsWith("image/")?e.fileGroup="Images":e.mimeType.startsWith("video/")?e.fileGroup="Videos":e.fileGroup="Other"})),docs.common.Globals.extensions=e,docs.common.Globals.indexedExtension=t.indexBy(e.items,"fileExtension"),i.resolve(e)},error:function(e,t,r){i.reject(e,t,r)}}),n.getExtensionsPromise=i.promise(),n.getExtensionsPromise}});return n})),define("assets/renditionpolicies/RenditionPolicy",["jquery","underscore","backbone","core/util/Globals","core/util/Service","common/container/config","common/container/model/ContainerItem","common/asset/AssetsJsonify","common/assets/settings","common/notification/model/TimeredProgressable","assets/model/Extensions"],(function(e,t,i,docs,r,s,n,o,a,l,c){"use strict";var u=docs.common.Globals,d={"image-scale-width":"Scale to Width","image-scale-height":"Scale to Height","image-crop-smart":"Smart Crop","image-crop-center":"Crop To Center - By Aspect Ratio","image-crop-center-dimension":"Crop To Center - By Dimension"};return n.extend({klass:"renditionpolicy",isFolder:!1,initialize:function(e,t){(t=t||{}).restAPI=!0,n.prototype.initialize.call(this,e,t)},modelType:function(){return"renditionpolicy"},baseUrl:function(){var e=a.endpoints.serverURL+"/renditionPolicies";return this.id&&(e+="/"+this.id),e},url:function(){return this.baseUrl()+"?fields=id,name,description,input,rendition,createdDate,updatedDate"},fetch:function(r){return r=r||{},this.isNew()?(this.fetchDfd=e.Deferred(),t.defer(function(){this.trigger("change"),this.fetchDfd.resolve()}.bind(this))):this.fetchDfd=i.Model.prototype.fetch.call(this,r),this.fetchDfd},sync:function(e,r,s){return s=s||{},"patch"===e?(s.url=t.result(r,"baseUrl"),s.emulateHTTP=!1,s.emulateJSON=!1):"create"===e?(s.url=t.result(r,"baseUrl"),s.emulateJSON=!1):"delete"===e&&(s.url=t.result(r,"baseUrl"),s.emulateHTTP=!1),i.sync.apply(this,arguments)},parse:function(e,i){if(i&&i.patch)return e?t.extend(this.attributes,{updatedDate:e.updatedDate}):this.attributes;var r;switch(e.rendition.formats[0].transformations[0].type&&(r={id:e.id,name:e.name,apiName:e.rendition.name,description:e.description?e.description:"",inputFormat:e.input.include,outputFormat:e.rendition.formats[0].mimeType,imageQuality:e.rendition.formats[0].quality,transformation:d[e.rendition.formats[0].transformations[0].type],createdDate:e.createdDate,updatedDate:e.updatedDate}),e.rendition.formats[0].transformations[0].type){case"image-scale-width":r.imageWidth=e.rendition.formats[0].transformations[0].width.toString();break;case"image-scale-height":r.imageHeight=e.rendition.formats[0].transformations[0].height.toString();break;case"image-crop-smart":case"image-crop-center":r.aspectRatio=e.rendition.formats[0].transformations[0].aspectRatio;break;case"image-crop-center-dimension":if(e.rendition.formats[0].transformations[0].width){r.aspectRatio=e.rendition.formats[0].transformations[0].aspectRatio,r.imageWidth=e.rendition.formats[0].transformations[0].width.toString();break}r.aspectRatio=e.rendition.formats[0].transformations[0].aspectRatio,r.imageHeight=e.rendition.formats[0].transformations[0].height.toString()}return r},validate:function(e,t){return e.name&&e.name.trim().length>255?"!nameTooLong":e.name&&e.name.search(/[';":?<%>{}\\#\/*]/)>-1?"!nameIllegalChars":e.apiName&&e.apiName.trim().length>100?"!apiNameTooLong":t.apiNameValidation&&e.apiName&&e.apiName.search(/[';":?<%>{}\\#\/*]/)>-1?"!apiIllegalChars":e.description&&e.description.trim().length>2e3?"!descNameTooLong":e.name&&0!==e.name.trim().length&&e.apiName&&0!==e.apiName.trim().length&&e.inputFormat&&0!==e.inputFormat.length&&e.outputFormat&&0!==e.outputFormat.trim().length&&e.transformation&&0!==e.transformation.trim().length?void 0:"!missingField"},getPayloadTransformation:function(){var e=this;return Object.keys(d).find((function(t){return d[t]===e.get("transformation")}))},transformationFields:function(){switch(this.getPayloadTransformation()){case"image-scale-width":return{type:"image-scale-width",width:parseInt(this.get("imageWidth"))};case"image-scale-height":return{type:"image-scale-height",height:parseInt(this.get("imageHeight"))};case"image-crop-smart":return{type:"image-crop-smart",aspectRatio:this.get("aspectRatio")};case"image-crop-center":return{type:"image-crop-center",aspectRatio:this.get("aspectRatio")};case"image-crop-center-dimension":return this.has("imageWidth")?{type:"image-crop-center-dimension",aspectRatio:this.get("aspectRatio"),width:parseInt(this.get("imageWidth"))}:{type:"image-crop-center-dimension",aspectRatio:this.get("aspectRatio"),height:parseInt(this.get("imageHeight"))}}},toJSON:function(){var e=this.transformationFields();return{name:this.get("name"),description:this.has("description")?this.get("description"):"",input:{include:this.get("inputFormat")},rendition:{name:this.get("apiName"),formats:[{mimeType:this.get("outputFormat"),quality:parseInt(this.get("imageQuality")),transformations:[e]}]}}},outputFormatChangedCondition:function(e){return e.outputFormat!==this.get("outputFormat")},imageQualityChangedCondition:function(e){return e.imageQuality!==this.get("imageQuality")},transformationChangedCondition:function(e){return e.transformation!==this.get("transformation")},aspectRatioChangedCondition:function(e){return e.aspectRatio&&e.aspectRatio!==this.get("aspectRatio")},imageHeightChangedCondition:function(e){return e.imageHeight&&e.imageHeight!==this.get("imageHeight")},imageWidthChangedCondition:function(e){return e.imageWidth&&e.imageWidth!==this.get("imageWidth")},getUpdatedPayload:function(e){var t={},i={};return e.name!==this.get("name")&&(t.name=this.get("name")),e.description!==this.get("description")&&(t.description=""===this.get("description")?null:this.get("description")),JSON.stringify(e.inputFormat)!==JSON.stringify(this.get("inputFormat"))&&(t.input={include:this.get("inputFormat")}),e.apiName!==this.get("apiName")&&(i.name=this.get("apiName")),(this.outputFormatChangedCondition(e)||this.imageQualityChangedCondition(e)||this.transformationChangedCondition(e)||this.aspectRatioChangedCondition(e)||this.imageHeightChangedCondition(e)||this.imageWidthChangedCondition(e))&&(i.formats=[{mimeType:this.get("outputFormat"),quality:parseInt(this.get("imageQuality")),transformations:[this.transformationFields()]}]),i&&Object.keys(i).length>0&&(t.rendition=i),t},getThumbnailUrl:function(){return u.staticRoot+"images/iconmap/renditionpolicy-image-icon.svg"},close:function(){this.clean()},clean:function(){this.stopListening()},getOriginalAttributes:function(){return this.originalAttributes}})})),define("common/assets/model/ContentType",["jquery","underscore","backbone","core/util/Globals","core/util/Service","core/util/Logger","common/container/model/ContainerItem","common/asset/AssetsJsonify","common/assets/model/AssetItemMembersList","common/assets/settings","common/assets/model/ContentField","common/assets/backend","core/util/Session","assets/renditionpolicies/RenditionPolicy"],(function(e,t,i,docs,r,s,n,o,a,l,c,u,d,p){"use strict";var m=docs.common.Globals,h=s("ContentType"),g=n.extend({isFolder:!1,isContentType:!0,modelType:function(){return"contenttype"},initialize:function(e,t){(t=t||{}).restAPI=!0,this.setUxIcon(),n.prototype.initialize.call(this,e,t),this.contentFields=null,this.sideboards=["asset_types_properties"]},url:function(){var e=l.endpoints.serverURL+"/types";return this.has("name")&&(e+="/"+this.get("name")),this.options.expand&&(e+="?expand="+this.options.expand),this.options.fields&&(e.indexOf("?")>-1?e+="&fields="+this.options.fields:e+="?fields="+this.options.fields),e},readUrl:function(){return docs.common.checkFeatureFlag("RenditionPolicies")?this.options.expand?this.url()+"&fields=renditionPolicies.id,renditionPolicies.name,renditionPolicies.input,renditionPolicies.rendition,renditionPolicies.createdDate,renditionPolicies.updatedDate":this.url()+"?fields=renditionPolicies.id,renditionPolicies.name,renditionPolicies.input,renditionPolicies.rendition,renditionPolicies.createdDate,renditionPolicies.updatedDate":this.url()},isSlugEnabled:function(){var e=this.get("properties");return e&&e.caas&&e.caas.slug&&e.caas.slug.enabled||!1},setSlugEnabled:function(e){this._setPropertyInProperties(["caas","slug","enabled"],e),this.trigger("change")},setVideoPlusEnabled:function(e){this._setPropertyInProperties(["caas","videoPlus","enabled"],e),this.trigger("change")},getSlugPattern:function(){var e=this.get("properties");return e&&e.caas&&e.caas.slug&&e.caas.slug.pattern||null},setSlugPattern:function(e){this._setPropertyInProperties(["caas","slug","pattern"],e),this.trigger("change")},isSlashAllowedInSlug:function(){var e=this.get("properties");return e&&e.caas&&e.caas.slug&&e.caas.slug["allow-forward-slash"]||!1},setAllowSlashInSlug:function(e){this._setPropertyInProperties(["caas","slug","allow-forward-slash"],e),this.trigger("change")},setTranslationsProperties:function(e,t,i){this._setPropertyInProperties(["caas-translations",e,t],i),this.trigger("change")},getTranslationsProperties:function(){var e=this.get("properties");return e&&e["caas-translations"]||{}},isInheritFromMaster:function(e){var t=this.get("properties"),i=!1;return t&&e&&t["caas-translations"]&&t["caas-translations"][e]&&(i=!!t["caas-translations"][e].hasOwnProperty("inheritFromMaster")&&t["caas-translations"][e].inheritFromMaster),i},isDoNotTranslate:function(e){var t=this.get("properties"),i=!1;return t&&e&&t["caas-translations"]&&t["caas-translations"][e]&&(i=!!t["caas-translations"][e].hasOwnProperty("translate")&&!t["caas-translations"][e].translate),i},getDefaultGroupsProperty:function(){return{title:"DigitalAssetType"===this.attributes.typeCategory?docs.i18n.t("ASSET_ATTRIBUTES"):docs.i18n.t("CONTENT_ITEM_FIELDS"),collapse:!1}},hasInheritFromMaster:function(e){var t=this.get("properties"),i=!1;return t&&e&&t["caas-translations"]&&t["caas-translations"][e]&&(i=!0),i},getSlugProperty:function(){var e=this.get("properties");return e&&e.caas&&e.caas.slug||{}},getGroupsProperty:function(){var e=this.get("properties");return e&&e.groups||[]},setGroupsProperty:function(e){this._setPropertyInProperties(["groups"],e),this.trigger("change")},getCustomTileProperty:function(){var e=this.get("properties");return e&&e.customTile||{}},setCustomTileProperty:function(e){this._setPropertyInProperties(["customTile"],e)},setCustomEditorsProperty:function(e){this._setPropertyInProperties(["customEditors"],e)},getCustomEditorsProperty:function(){var e=this.get("properties");return e&&e.customEditors||[]},getPreviewLayoutProperty:function(){var e=this.get("properties");return e&&e.previewLayout||""},setPreviewLayoutProperty:function(e){this._setPropertyInProperties(["previewLayout"],e)},getCustomFormProperty:function(){var e=this.get("properties");return e&&e.customForms||""},setCustomFormsProperty:function(e){this._setPropertyInProperties(["customForms"],e)},hasCustomEditors:function(){var e=this.get("properties");return e&&e.customEditors&&e.customEditors.length>0},hasCustomForms:function(){var e=this.get("properties");return e&&e.customForms&&Array.isArray(e.customForms)&&e.customForms.length>0},getFormSettingsProperty:function(){var e=this.get("properties");return e&&e.formSettings||{}},setFormSettingsProperty:function(e){this._setPropertyInProperties(["formSettings"],e)},updateGroupsProperty:function(e,t,i){var r=this.getGroupsProperty();"update"===i?r[t]=e:"delete"===i&&r.splice(t,1),this.setGroupsProperty(r)},getContentFields:function(){if(!this.contentFields||this.hasChanged("fields")){var e=this.get("fields");e&&(this.contentFields=e.map((function(e){return new c(e)})))}return this.contentFields},getContentField:function(e){var t,i=this.getContentFields().filter((function(t){return t.get("name")===e}));return 1===i.length&&(t=i[0]),t},fetch:function(i){return i=i||{},this.has("name")?n.prototype.fetch.call(this,i).promise():(setTimeout(function(){this.trigger("change")}.bind(this),0),t.isFunction(i.error)&&i.error(this,{detailMessage:"Type name not specified"}),e.Deferred.reject())},fetchAllCustomFieldEditors:function(e){var t=this;return u.getCustomFieldEditors(e).then((function(e){t.customEditors=e}))},fetchCustomContentForms:function(e){var t=this;return u.getCustomContentForms(e).then((function(e){t.customForms=e}))},fetchCustomFieldEditorsForType:function(){var e=this;return u.getAppInfoFiles(e.getCustomEditorsProperty()).then((function(t){e.customEditors=t}))},fetchCustomContentForm:function(e){var t=this;return u.getAppInfoFile(e).then((function(e){t.customForm=e}))},setCustomForm:function(e){this.customForm=e},getCustomForm:function(e){if(this.customForm)return this.customForm;var t=[];return e&&this.customForms&&(t=this.customForms.filter((function(t){return t.id===e}))),t.length>0?t[0]:null},getCustomEditorsForDataType:function(e){var t=[];return e&&e.datatype&&this.customEditors&&(t=this.customEditors.filter((function(t){var i=t.supportedDatatypes;return i&&-1!==i.indexOf(e.datatype)}))),t},sync:function(e,t,i){return"create"===e&&(i.url=l.endpoints.serverURL+"/types"),"update"===e&&this.updatedPayload(),n.prototype.sync.call(this,e,t,i)},updatedPayload:function(){if(docs.common.checkFeatureFlag("RenditionPolicies")){var e=this.get("renditionPolicies"),i=[];t.each(e,(function(e){i.push({id:e.id})})),this.set("renditionPolicies",i)}},hasPublishedItems:function(){var t=l.endpoints.serverURL+'/items?q=(type eq "'+this.get("name")+'" AND isPublished eq "true")',i=!1,r=e.Deferred();return e.ajax(t,{type:"GET",contentType:"application/json",success:function(e){return i=e.items&&e.items.length>0,r.resolve(i)},error:function(e,t,i){h.debug("Error fetching content items :",i),r.reject(e,t,i)}}),r.promise()},fetchLayoutMapping:function(){var i=this;return this.get("layoutMapping")&&!t.isEmpty(this.get("layoutMapping"))&&this.get("layoutMapping").data?Promise.resolve(this.get("layoutMapping")):new Promise(function(t,r){var s=l.endpoints.serverURL+"/types/"+this.get("name")+"/layoutMapping";e.ajax(s,{type:"GET",contentType:"application/json",success:function(e){i.set("layoutMapping",e),t(e)},error:function(e,t,i){e.errorHandled=!0;var s=new Error("Unable to fetch layoutMapping");r(s)}})}.bind(this))},fetchInplacePreview:function(){var i=this;return this.get("inplacePreview")&&!t.isEmpty(this.get("inplacePreview"))&&this.get("inplacePreview").data?Promise.resolve(this.get("inplacePreview")):new Promise(function(t,r){var s=l.endpoints.serverURL+"/types/"+this.get("name")+"/inplacePreview";e.ajax(s,{type:"GET",contentType:"application/json",success:function(e){i.set("inplacePreview",e),t(e)},error:function(e,t,i){e.errorHandled=!0;var s=new Error("Unable to fetch inplacePreview");r(s)}})}.bind(this))},toJSON:function(){return t.clone(this.attributes)},isDigitalAssetType:function(){return"DigitalAssetType"===this.get("typeCategory")},isVideoPlusEnabled:function(){var e=this.get("properties");return e&&e.caas&&e.caas.videoPlus&&e.caas.videoPlus.enabled||!1},isSeededType:function(){var e=this.get("createdBy")||"";return this.isDigitalAssetType()&&t.isEqual(e.toLowerCase(),"system")},uxIcon:"oj-ux-ico-content-item",setUxIcon:function(){"DigitalAssetType"===this.get("typeCategory")&&("system"===this.get("createdBy")?this.uxIcon="oj-ux-ico-file-image":this.uxIcon="oj-ux-ico-image-custom")},getThumbnailUrl:function(){return"DigitalAssetType"===this.get("typeCategory")?"system"===this.get("createdBy")?m.staticRoot+"images/iconmap/seeded_digital_asset_type.png":m.staticRoot+"images/iconmap/custom_digital_asset_type.png":(this.get("typeCategory"),m.staticRoot+"images/iconmap/content_item_type.png")},getCollaborators:function(){var e;return this.collaborators?e=this.collaborators:(e=new a([],{item:this})).fetch({item:this}),e},_setPropertyInProperties:function(e,t){for(var i=this.get("properties")||{},r=i,s=0;s<e.length-1;s++)r[e[s]]=r[e[s]]||{},r=r[e[s]];r[e[e.length-1]]=t,this.set("properties",i)},parseRenditionPolicy:function(e){var t=new p(e.attributes).toJSON();return t.id=e.get("id"),t.createdDate=e.get("createdDate"),t.updatedDate=e.get("updatedDate"),t},getLimit:function(t){var i=e.Deferred();if(!m.isStarterEdition)return i.resolve({isEnabled:!0});var r="/system/api/v1/features/.by.name/"+t;return e.ajax(r,{type:"GET",contentType:"application/json",success:function(e){i.resolve({isEnabled:e.isEnabled,learnMoreUrl:"https://docs.oracle.com/pls/topic/lookup?ctx=cloud&id=CECSA-GUID-743500EB-B173-412D-996D-AFAA2C4F921A"})}}),i.promise()},getRenditionPolicies:function(){var i=e.Deferred(),r=l.endpoints.serverURL+"/renditionPolicies?limit=1000000000&offset=0&fields=id,name,input,rendition,createdDate,updatedDate";return e.ajax(r,{type:"GET",contentType:"application/json",success:function(e){var r=t.filter(e.items,(function(e){return!("Large"===e.name||"Medium"===e.name||"Small"===e.name||"Thumbnail"===e.name)}));i.resolve(r)}}),i.promise()}});return g.create=function(e){return require("common/assets/TypeCache").get(e)},Object.defineProperty(g.prototype,"klass",{value:"ContentTypeModel"}),g})),define("common/assets/RepositoryCache",["underscore","common/assets/settings","core/util/Logger"],(function(e,t,i){var r=new Map,s=i("repocache");class n{constructor(e,t){this.type=e,this.options=t,null!=t&&(this.detail=t.detail)}}return{getRepository:function(e,t){var i=$.Deferred();return s.debug("Loading repository "+e+" model"),require(["common/assets/model/Repository"],(function(r){var n=new r({id:e},t);n.fetch().then((function(){i.resolve(n)})).catch((function(t){s.error("Error creating model for "+e),i.reject(t)}))})),i.promise()},getData:function(e){if(!e)throw new Error("Repository ID is required");if(s.debug("Getting data for repository: "+e+" from repo cache"),!r.has(e)){s.debug("Repository  "+e+" is not in cache.");var t={value:$.Deferred()};r.set(e,t),$.ajax(this.getFetchUrl(e),{type:"GET",contentType:"application/json",success:function(e,i,r){t.fetchTime=Date.now(),t.value.resolve(e,i,r)},error:function(i){s.error("Error loading repository data for "+e),r.delete(e),t.value.reject(i)}})}return r.get(e).value.promise()},getFetchUrl:function(e,i){var r=t.endpoints.serverURL+"/repositories";return e&&(r+="/"+e),i&&i.expand?"none"!==i.expand&&(r+="?expand="+i.expand,this.options.includeAdditionalData&&(r+="&includeAdditionalData=true")):r+="?includeAdditionalData=true&expand=all",r},delete:function(e){e&&(s.debug("Removing repository: "+e+" from repository cache"),r.delete(e))},reset:function(){s.debug("Resetting repository cache"),r.clear()},update:function(e,t){s.debug("Updating repository "+e+" repository cache entry"),r.has(e)?r.get(e).value=$.Deferred().resolve(t):r.set(e,{fetchTime:Date.now(),value:$.Deferred().resolve(t)}),this.dispatchEvent(new n("update",{detail:{id:e,updatedDate:t.updatedDate.value,data:t}}))},addEventListener:function(e,t){this._eventListeners||(this._eventListeners=new Set),this._eventListeners.add({type:e.toLowerCase(),listener:new WeakRef(t)})},removeEventListener:function(e,t){this._eventListeners&&this._eventListeners.forEach((function(i){var r=i.listener.deref();i.type!=e||r&&r!=t||this._eventListeners.delete(i)}),this)},dispatchEvent:function(e){this._eventListeners&&(s.debug("Dispatching "+e.type+" event notifications to "+this._eventListeners.size+" listeners."),this._eventListeners.forEach((function(t){var i=t.listener.deref();if(e&&e.type&&t.type===e.type.toLowerCase()&&i){if(!1===i.apply(this,[e]))return!1}else i||this._eventListeners.delete(t)}),this));return!0}}})),define("common/assets/TypeCache",["underscore","common/assets/settings","common/assets/model/ContentType","core/util/Logger"],(function(e,t,i,r){var s={},n={},o=[],a=r("typecache"),l=new Set,c={get:function(e){if(!e)throw new Error("typeName should be provided");if(a.debug("Getting value for type: "+e+" from type cache"),!s[e]){a.debug("Type  "+e+" is not in cache .");var t=new i({name:e});s[e]=$.Deferred(),t.fetch().done((function(){s[e].resolve(t)})).fail((function(t){s[e].reject(t)}))}return s[e]},getAllTypes:function(e){var t=$.Deferred(),i=$.Deferred();return this.loadTypes(null,e,i),i.then((function(){t.resolve(o)})),t.promise()},getMulti:function(e){const t=[];for(const i of e)t.push(c.get(i));return $.when.apply($,t)},delete:function(t){t&&(a.debug("Removing type: "+t+" from type cache"),delete s[t],delete n[t],o=e.reject(o,(function(e){return e.name===t})))},reset:function(){a.debug("Resetting type cache"),s={},n={},o=[],l.clear()},update:function(e,t){s[e]=$.Deferred(),s[e].resolve(new i(t));var r=t.properties;r&&(n[e]={isVideoPlusEnabled:Boolean(r&&r.caas&&r.caas.videoPlus&&r.caas.videoPlus.enabled),sharedFile:Boolean(r&&r["caas-translations"]&&r["caas-translations"].file&&r["caas-translations"].file.inheritFromMaster)}),a.debug("Updating type: "+e+" to type cache")},getAdditionalTypeData:function(){return n},clearRepo:function(e){l.delete(e),a.debug("Repositories after clearing :",l.values())},loadTypes:function(r,c,u){if(l.has(c)&&u)u.resolve();else{var d=this;if(a.debug("Loading types....for repo:",c),!r){var p='&q=repositoryId eq "'+c+'"';r=t.endpoints.serverURL+"/types?limit=100"+p}$.ajax(r,{type:"GET",contentType:"application/json",success:function(t){if(e.each(t.items,(function(e){var t=e.name;s[t]=s[t]||$.Deferred(),s[t].resolve(new i(e)),n[t]={isVideoPlusEnabled:Boolean(e.properties&&e.properties.caas&&e.properties.caas.videoPlus&&e.properties.caas.videoPlus.enabled),sharedFile:Boolean(e.properties&&e.properties["caas-translations"]&&e.properties["caas-translations"].file&&e.properties["caas-translations"].file.inheritFromMaster)},o.push(e)})),t.hasMore){var p=e.find(t.links,(function(e){return"next"==e.rel}));r=p.href,d.loadTypes(r,c,u)}else l.add(c),a.debug("Type cache contains:",s),u&&u.resolve(n)},error:function(e,t,i){e.errorHandled=!0,u&&u.reject(e,t,i)}})}}};return c})),define("common/assets/model/Repository",["jquery","underscore","backbone","core/util/Globals","common/assets/CaasJobUtils","common/container/model/ContainerItem","common/assets/model/AssetItemMembersList","common/assets/settings","common/assets/model/ContentType","common/assets/constants","common/assets/RepositoryCache","common/assets/TypeCache","core/util/FeatureFlags"],(function(e,t,i,docs,r,s,n,o,a,l,c,u,d){"use strict";var p=docs.common.Globals,m=s.extend({isFolder:!1,isRepository:!0,sideboards:function(){return["repository_properties"]},initialize:function(e,i){this.options=i||{},this.options.restAPI=!0,t.bindAll(this,"repoUpdated"),this.setUxIcon(),s.prototype.initialize.call(this,e,this.options)},url:function(){return c.getFetchUrl(this.id,this.options)},fetch:function(r){return this.isNew()?(this.fetchDfd=e.Deferred(),t.defer(function(){this.trigger("change"),this.fetchDfd.resolve()}.bind(this))):this.options.ignoreCache?this.fetchDfd=i.Model.prototype.fetch.call(this,r):this.fetchDfd=c.getData(this.id).then(function(t,i,s){var n=this.parse(JSON.parse(JSON.stringify(t)),r);return this.set(n),c.addEventListener("update",this.repoUpdated),e.Deferred().resolve(n,i,s)}.bind(this)),this.fetchDfd},parse:function(e){return e.channels=t.sortBy(e.channels,"name"),e.contentTypes=t.sortBy(e.contentTypes,"name"),e.taxonomies=t.sortBy(e.taxonomies,"name"),e.translationConnectors=t.filter(e.connectors,(function(e){return"translation"===e.connectorType})),e.connectors=t.filter(e.connectors,(function(e){return"content"===e.connectorType})),e},save:function(e,t){return s.prototype.save.call(this,e,t).then(function(){c.update(this.id,this.toJSON())}.bind(this))},toJSON:function(){var e=t.clone(this.attributes);return e.translationConnectors&&(e.connectors?e.connectors=e.connectors.concat(e.translationConnectors):e.connectors=e.translationConnectors,delete e.translationConnectors),e},modelType:function(){return"repository"},uxIcon:"oj-ux-ico-database",setUxIcon:function(){"Business"===this.get("repositoryType")&&(this.uxIcon="oj-ux-ico-database-file")},getThumbnailUrl:function(){return this.get("repositoryType")===l.repository.BUSINESS?p.staticRoot+"images/iconmap/bus_repository_dk.svg":p.staticRoot+"images/iconmap/repository.svg"},getCollaborators:function(){var e;return this.collaborators?e=this.collaborators:(e=new n([],{item:this})).fetch({item:this}),e},validate:function(e){return e.name&&0!==e.name.trim().length?e.name.search(/[';":?<%>{}\\#\/*]/)>-1?"!nameIllegalChars":t.contains(["CON","PRN","AUX","NUL","NULL","COM0","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT0","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"],e.name.trim().toLocaleUpperCase())?"!nameReservedWord":e.defaultLanguage&&0!==e.defaultLanguage.trim().length?void 0:"!missingDefaultLang":"!missingName"},isConvertingToCDT:function(){var e=this.get("jobHistory");return!(!e||t.isEmpty(e.items))&&(e.items[0].progress&&"processing"===e.items[0].progress.toLowerCase()||"pending"===e.items[0].progress.toLowerCase())},fetchAllDigitalTypes:function(){u.loadTypes(null,this.id)},updateExpandedTypeInfo:function(){if(this.options.preloadTypes){var e=this.get("contentTypes"),i=u.getAdditionalTypeData();t.each(e,(function(e){i[e.name]&&e&&t.isEqual(e.typeCategory,"DigitalAssetType")&&i[e.name]&&(e.isVideoPlusEnabled=i[e.name].isVideoPlusEnabled,e.sharedFile=i[e.name].sharedFile)}),this)}},fetchExpandedTypeInfo:function(){var i=e.Deferred();if(t.isEmpty(this.get("contentTypes")))return i.resolve(),i.promise();var r=e.Deferred();return u.loadTypes(null,this.id,r),r.then(function(){var e=this.get("contentTypes"),r=u.getAdditionalTypeData();t.isEmpty(r)||t.isEmpty(e)||t.each(e,(function(e){r[e.name]&&(e.isVideoPlusEnabled=r[e.name].isVideoPlusEnabled,e.sharedFile=r[e.name].sharedFile)}),this),i.resolve()}.bind(this)),i.promise()},getContentType:function(e){return a.create(e)},hasConversionJobHistory:function(){var e=window.localStorage.getItem("dev.conversion.time")||15,t=this.get("jobHistory");if(t&&t.items&&t.items.length>0){var i=t.items[0];if(i.endTime&&i.endTime.value){var r=new Date(i.endTime.value),s=Math.abs(Date.now()-r);return Math.ceil(s/864e5)<e}return!0}return!1},hasConversionReport:function(){if(this.hasConversionJobHistory()){var e=this.get("jobHistory").items[0];return"succeeded"===e.progress||"failed"===e.progress}return!1},getConversionURL:function(){if(this.hasConversionReport())return this.get("jobHistory").items[0].links[0].href},isConverted:function(){return this.get("customDigitalAssetsEnabled")},conversionStatus:function(){var e;this.hasConversionJobHistory()?"pending"===(e=this.get("jobHistory").items[0].progress)&&(e="processing"):this.conversionInProgress&&(e="processing");return e},_getConversionJobURL:function(){if(this.hasConversionJobHistory()){var e=this.get("jobHistory").items[0];if(t.contains(["processing","pending"],e.progress)&&e.links)return e.links[0].href}},checkConversionJob:function(){var i=e.Deferred(),r=this._getConversionJobURL();return r?(this.conversionInProgress=!0,this.trigger("conversion:started"),require(["common/assets/CaasJobUtils"],t.bind((function(e){e.pollBulkJobStatus(r,i)}),this))):i.resolve("no-job-url"),r&&i.always(function(){c.delete(this.id),delete this.conversionInProgress}.bind(this)),i},convertToCDT:function(){var i=e.Deferred();this.conversionInProgress=!0,this.trigger("conversion:started");var r=this.get("id");return require(["core/util/Service","core/util/Session","common/assets/CaasJobUtils"],t.bind((function(s,n,o){var a="/content/management/api/v1.1/repositories/{repoId}/enableCustomDigitalAssets";a=a.replace(/{repoId}/,r),e.ajax(a,{type:"POST",data:JSON.stringify({}),contentType:"application/json",beforeSend:n.setAuthorizationHeader,statusCode:{202:function(e,r,n){if(n&&!t.isEmpty(n.getAllResponseHeaders())){var a=s.parseHttpResponseHeaders(n.getAllResponseHeaders());o.pollBulkJobStatus(a.location,i)}else i.reject(n,r,"error")}},error:function(e,t,r){i.reject(e,t,r)}})}),this)),i.always((()=>{c.delete(this.id),delete this.conversionInProgress})),i},repoUpdated:function(e){"update"===e.type&&e.detail.id===this.id&&e.detail.updatedDate!==this.get("updatedDate").value&&this.set(e.detail.data)}},{addConnectorItems:function(i,s,n,a){var l=e.Deferred(),c={operations:{addToRepository:{repositoryId:n,connectorId:s}}};return(a=a||{}).progressable&&a.progressable.startProgressTimer(),i=t.map(i,(function(e){function i(i,r){r=r||i;var s=e.get(i);return s&&t.isObject(s)&&t.has(s,"data")?s:[]}var r={externalId:e.get("id"),name:e.get("name"),fileExtension:e.get("extension"),description:e.get("description"),type:e.get("assetType"),language:e.has("contentItemModel")?e.get("contentItemModel").get("language"):void 0,fields:e.has("contentItemModel")?e.get("contentItemModel").attributes.fields:{},collections:i("collections"),channels:i("channels"),tags:i("tags"),taxonomies:{data:m.pareCategoriesDown(i("taxonomies").data)},slug:e.has("contentItemModel")&&e.get("contentItemModel").has("slug")?e.get("contentItemModel").get("slug"):void 0};return e.has("contentItemModel")&&e.get("contentItemModel").has("translatable")&&(r.translatable=e.get("contentItemModel").get("translatable")),e.has("contentItemModel")&&e.get("contentItemModel").has("sourceId")&&(r.sourceId=e.get("contentItemModel").get("sourceId")),e.has("contentItemModel")&&e.get("contentItemModel").has("varSetId")&&(r.varSetId=e.get("contentItemModel").get("varSetId")),r})),t.extend(c.operations.addToRepository,{externalItems:i}),l.done((function(e){a.progressable&&a.progressable.stopProgressTimer(),a.successCb&&a.successCb(e)})),l.progress((function(e){a.progressCb&&a.progressCb(e)})),l.fail((function(e,t,i){a.progressable&&a.progressable.stopProgressTimer(!0),a.errorCb&&a.errorCb(i)})),e.ajax(o.endpoints.serverURL+"/bulkItemsOperations",{type:"POST",data:JSON.stringify(c),contentType:"application/json",success:function(e,t,i){if(202===i.status){var s=i.getResponseHeader("location");r.pollBulkJobStatus(s,l)}else l.resolve(e)},error:function(e,t,i){e.errorHandled=!0,l.reject(e,t,i)}}),l},paramRepository:function(e){return"arCaaSGUID:"+e},paramCollections:function(e){return e&&t.isObject(e)&&t.has(e,"data")?m._paramTargets(t.pluck(e.data,"id"),"arCollectionId:"):m._paramTargets(e,"arCollectionId:")},paramChannels:function(e){return e&&t.isObject(e)&&t.has(e,"data")?m._paramTargets(t.pluck(e.data,"id"),"arChannelId:"):m._paramTargets(e,"arChannelId:")},_paramTargets:function(e,i){if(e)return e=t.isArray(e)?e:[e],e=t.map(e,(function(e){return i+e})).join(",")},paramTags:function(e){return e&&t.isObject(e)&&t.has(e,"data")?t.pluck(e.data,"name").join(","):e?t.isArray(e)?e.join(","):e:void 0},pareCategoriesDown:function(e){if(e){var i=[];return t.each(e,(function(e){var r=t.pick(e,"id","categories"),s=[];t.each(r.categories,(function(e){s.push(t.pick(e,"id"))})),r.categories=s,i.push(r)})),i}return[]},paramCategories:function(e){if(e&&t.isObject(e)&&t.has(e,"data")&&e.data.length>0){var i="";return t.each(e.data,(function(e){i+=t.isEmpty(i)?"":";",i+=e.id+":",i+=t.pluck(e.categories,"id").join(",")})),i}}});return m})),define("common/assets/UserConfig",["jquery","underscore","backbone","core/util/Globals","core/util/Service","core/extensions"],(function(e,t,i,docs,r){"use strict";var s=docs.common.Globals;return i.Klass.extend({},{set:function(i,n,o){var a=t.isNumber(n)?"number":t.isBoolean(n)?"boolean":"string",l=r.getServiceParamsForPost("SET_USER_CONFIG");return l.data.dUserState=i,l.data.dUserStateValue=n,l.data.dUserStateValueType=a,e.ajax(l.url,{type:"POST",data:l.data,async:!!o.async,success:function(){o.globalsKey&&(s[o.globalsKey]=n)},error:function(e){e.errorHandled=!0}})}})})),define("common/assets/model/Repositories",["jquery","underscore","core/util/Globals","core/util/Service","common/container/config","common/container/model/Container","common/assets/model/Repository","common/assets/UserConfig","common/assets/settings"],(function(e,t,docs,i,r,s,n,o,a){"use strict";r.itemModels.repository=n;var l=docs.common.Globals;return s.extend({sortParams:{sort_updated:"&orderBy=updatedDate:desc",sort_nameasc:"&orderBy=name:asc",sort_namedsc:"&orderBy=name:desc"},initialize:function(e,i){this.options=t.extend({},i,{restAPI:!0}),s.prototype.initialize.call(this,e,this.options),this.options.scopeKey?s.prototype.initializeFilter.call(this,i):this.set("filter",this.options.filter||"filter_all","silent: true")},url:function(){var e=a.endpoints.serverURL+"/repositories",t=this.get("filter").substr("filter_".length);e+="?limit="+this.items.pagerData.pageSize,e+="&offset="+this.items.pagerData.pageStartRow;var i=this.get("sortOrder");e+=this.sortParams[i],this.options.fields?"none"!==this.options.fields&&(e+="&fields="+this.options.fields,this.options.includeAdditionalData&&(e+="&includeAdditionalData="+this.options.includeAdditionalData)):e+="&includeAdditionalData=true&fields=all";var r=[];return this.has("role")&&r.push('roleName eq "'+this.get("role")+'"'),this.get("searchTerm")&&r.push('name mt "'+this.get("searchTerm")+'"'),"all"!==t&&r.push('repositoryType eq "'+t+'"'),r.length>0&&(e+="&q="+r.map((function(e){return"("+encodeURIComponent(e)+")"})).join(" AND ")),e},parseModel:function(){return{name:docs.i18n.t("REPOSITORIES"),type:"folder",application:"framework.assets"}},parseItems:function(e){var i,r=e.items;return i=t.each(r,(function(e){e.application=e.type="repository"}),this),this.options&&this.options.defaultRolesOnly&&(i=t.filter(i,(function(e){return"custom"!==e.roleName}))),i},listChannelRepositories:function(e){var i=[];return this.items.models.filter((function(r){t.filter(r.get("channels"),(function(t){return t.id===e})).length>0&&i.push(r.id)})),i}},{setDefaultId:function(t){t!==l.repositoryId&&e.sessionStorage("assetsAssetFilter",{}),o.set("repositoryId",t,{async:!1,globalsKey:"repositoryId"})}})})),define("common-assets-15b22b9.cache",(function(){}));