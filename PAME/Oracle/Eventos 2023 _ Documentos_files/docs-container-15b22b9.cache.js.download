define("docs/aif/model/Validator",["jquery","underscore","core/util/Globals","common/aif/Utils","common/aif/Constants"],(function(e,t,docs,i,o){"use strict";return docs.aif.models.Validator={EndPointProps:{required:["id","name","actions"],optional:["description","category","supportEmail","baseUrl","info","tenantPrefs","userPrefs","stringsMap"]},ActionProps:{required:["id","name","evaluate","invoke"],optional:["description","type","trigger","multi","presentation"]},IntActionProps:{required:["invoke"],optional:["presentation"]},PresentationProps:{required:[],optional:["view","popupWidth","popupHeight"]},InvokeProps:{required:["method","url"],optional:["data","appLinkRole","headers","token"]},validateJSON:function(e){var t={};try{t.configs=JSON.parse(e),t.invalid=!1}catch(e){t.invalidJSON=!0,t.jsonParseError=e.message,t.invalid=!0}return t},validateConfig:function(e){var i=this.validateJSON(e);if(!t.isUndefined(i.configs)){var o=t.isArray(i.configs)?i.configs:[i.configs];i.apps=[],t.each(o,(function(e){if(!e.invalid){var t=this.validateEndPoint(e);i.invalid|=t.invalid,i.apps.push(t)}}),this)}return i},validateEndPoint:function(e){var i=t.keys(e),o={invalid:!1,config:e,unknownProps:[],invalidProps:[],missingReqProps:[],missingOptProps:[]};return this.addMissingFields(this.EndPointProps,i,o),t.each(i,(function(i){var n=e[i];switch(i){case"id":case"name":case"description":case"supportEmail":t.isString(n)&&!t.isEmpty(n.trim())||o.invalidProps.push(i);break;case"baseUrl":t.isString(n)||o.invalidProps.push(i);break;case"category":this.isValidEndPointCategory(n)||o.invalidProps.push(i);break;case"info":case"tenantPrefs":case"userPrefs":var s=this.validateInternalAction(i,n,o);t.isUndefined(s)||o.actions.push(s);break;case"actions":t.isArray(n)&&!t.isEmpty(n)?(o.actions=[],t.each(n,(function(e){var i=this.validateAction(e);t.isUndefined(i)||(o.invalid|=i.invalid,o.actions.push(i))}),this)):o.invalidProps.push(i);break;case"stringsMap":this.isValidStringsMap(n)||o.invalidProps.push(i);break;default:o.unknownProps.push(i)}}),this),(o.missingReqProps.length||o.invalidProps.length||t.isUndefined(o.actions))&&(o.invalid|=!0),o},validateAction:function(e){var i=t.keys(e),o={invalid:!1,config:e,unknownProps:[],invalidProps:[],missingReqProps:[],missingOptProps:[]};return this.addMissingFields(this.ActionProps,i,o),t.each(i,(function(i){var n=e[i];switch(i){case"id":case"name":case"description":t.isString(n)&&!t.isEmpty(n.trim())||o.invalidProps.push(i);break;case"type":this.isValidActionType(n)||o.invalidProps.push(i);break;case"trigger":this.isValidTrigger(n)||o.invalidProps.push(i);break;case"multi":this.isValidBoolean(n)||o.invalidProps.push(i);break;case"evaluate":this.isValidEvaluateExression(n)||o.invalidProps.push(i);break;case"invoke":this.validateInvoke(i,n,o);break;case"presentation":this.validatePresentation(i,n,o);break;default:o.unknownProps.push(i)}}),this),(o.missingReqProps.length||o.invalidProps.length)&&(o.invalid|=!0),o},validateInternalAction:function(e,o,n){var s=t.keys(o);this.addMissingFields(this.IntActionProps,s,n,e),t.each(s,(function(t){var s=o[t];switch(t){case"presentation":this.validatePresentation(e+"."+t,s,n);break;case"invoke":this.validateInvoke(e+"."+t,s,n);break;default:n.unknownProps.push(i.fullPropName(e,t))}}),this)},validatePresentation:function(e,o,n){var s=t.keys(o);this.addMissingFields(this.PresentationProps,s,n,e),t.each(s,(function(s){var a=o[s];switch(s){case"view":this.isValidViewType(a)||n.invalidProps.push(i.fullPropName(e,s));break;case"popupWidth":case"popupHeight":t.isNumber(a)||t.isNumber(parseInt(a,10))||n.invalidProps.push(i.fullPropName(e,s));break;default:n.unknownProps.push(i.fullPropName(e,s))}}),this)},validateInvoke:function(e,o,n){var s=t.keys(o);this.addMissingFields(this.InvokeProps,s,n,e),t.each(s,(function(s){var a=o[s];switch(s){case"method":this.isValidHttpMethod(a)||n.invalidProps.push(i.fullPropName(e,s));break;case"url":case"data":var r=/.*(\{appLink\.)+.*/.test(a),l=!1,c=null;if(t.isObject(a)&&!t.isString(a))try{c=JSON.parse(JSON.stringify(a)),!t.isEmpty(c)&&t.isObject(c)&&(l=!0)}catch(e){}var d=l?i.createJSONResolveFunction(c):i.createURLResolveFunction(a);(r&&!this.isValidAppLinkRole(o.appLinkRole)||!t.isFunction(d.func))&&n.invalidProps.push(i.fullPropName(e,s));break;case"appLinkRole":this.isValidAppLinkRole(a)||n.invalidProps.push(i.fullPropName(e,s));break;case"headers":a&&!t.isObject(a)&&n.invalidProps.push(i.fullPropName(e,s));break;case"token":if(a)if(t.isString(a)){var p="PCS"===a.toUpperCase(),u="NONE"===a.toUpperCase();p||u||n.invalidProps.push(i.fullPropName(e,s))}else n.invalidProps.push(i.fullPropName(e,s));break;default:n.unknownProps.push(i.fullPropName(e,s))}}),this)},addMissingFields:function(e,o,n,s){t.each(e.required,(function(e){t.contains(o,e)||n.missingReqProps.push(i.fullPropName(s,e))})),t.each(e.optional,(function(e){t.contains(o,e)||n.missingOptProps.push(i.fullPropName(s,e))}))},isValidStringsMap:function(e){var i=t.isObject(e);return i&&(i&=t.every(t.toArray(e),(function(e){return t.isObject(e)}))),i},isValidEvaluateExression:function(e){var o=i.createQualifyingFunction(e);return t.isFunction(o.func)},isValidBoolean:function(e){return t.isBoolean(e)||t.contains(["true","false","1","0","on","off",1,0],e)},isValidEndPointCategory:function(e){return this._isValidFieldValue(e,o.EndPointCategory)},isValidActionType:function(e){return this._isValidFieldValue(e,o.ActionType)},isValidTrigger:function(e){return this._isValidFieldValue(e,o.TriggerType)},isValidViewType:function(e){return this._isValidFieldValue(e,o.ViewType)},isValidHttpMethod:function(e){return this._isValidFieldValue(e,o.HttpMethod)},isValidAppLinkRole:function(e){return this._isValidFieldValue(e,o.applinkRole)},isValidAuthType:function(e){return this._isValidFieldValue(e,o.AuthType)},_isValidFieldValue:function(e,i){return!t.isUndefined(e)&&(!t.isArray(i)&&t.isObject(i)&&(i=t.values(i)),t.isArray(i)?t.contains(i,e):i===e)}},docs.aif.models.Validator})),define("docs/aif/model/Action",["jquery","underscore","backbone","core/util/Globals","core/util/Utils","common/aif/Constants","common/aif/Utils","common/aif/API","docs/aif/model/Validator","common/aif/Manager"],(function(e,t,i,docs,o,n,s,a,r,l){"use strict";docs.common.Globals;return docs.aif.models.Action=i.Model.extend({initialize:function(e,i){this.endPoint=i.endPoint;var o=e.invoke.url;if(o&&!/^(http:\/\/|https:)/.test(o)){var n=this.endPoint.getBaseUrl();n&&(o=n+o)}var a=s.createURLResolveFunction(o);this._resolvedURL=a.func,this.needsMeta|=a.needsMeta;var r=!1,l=null;if(t.isObject(e.invoke.data)&&!t.isString(e.invoke.data))try{l=JSON.parse(JSON.stringify(e.invoke.data)),!t.isEmpty(l)&&t.isObject(l)&&(r=!0)}catch(e){}var c=r?s.createJSONResolveFunction(l):s.createURLResolveFunction(e.invoke.data);this._resolvedURLData=c.func,this.needsMeta|=c.needsMeta,this.headers=e.invoke.headers||{},this.addPCSToken=e.invoke.token&&t.isString(e.invoke.token)&&"PCS"===e.invoke.token.toUpperCase()},parse:function(e){return this.needsMeta=!1,e.type=r.isValidActionType(e.type)?e.type:n.ActionType.UI,e.trigger=r.isValidTrigger(e.trigger)?e.trigger:n.TriggerType.MENU,e.multi=this._parseBoolean(e.multi,!1),e.evaluate=this._parseEvaluate(e.evaluate),e.invoke=this._parseInvoke(e.invoke),e.presentation=this._parsePresentation(e.type,e.trigger,e.presentation),e},_parseBoolean:function(e,i){return!0===(e=t.isBoolean(e)?e:t.isString(e)?e.toLowerCase():"false")||"true"===e||"1"===e||"yes"===e||"on"===e},_parseEvaluate:function(e){e=e||"";var t=s.createQualifyingFunction(e);return this._qualify=t.func,this.needsMeta|=t.needsMeta,e},_parsePresentation:function(e,i,o){var s={};return o=o||{},s.view=r.isValidViewType(o.view)?o.view:n.ViewType.CLIENT,s.popupWidth=t.isNumber(o.popupWidth)?o.popupWidth:n.getPopupDefaultWidth(e,i),s.popupHeight=t.isNumber(o.popupHeight)?o.popupHeight:n.getPopupDefaultHeight(e,i),s},_parseInvoke:function(e){var t={};return e=e||{},t.method=r.isValidHttpMethod(e.method)?e.method:n.HttpMethod.GET,t.url=e.url?e.url:void 0,t.data=e.data?e.data:void 0,t.appLinkRole=r.isValidAppLinkRole(e.appLinkRole)?e.appLinkRole:void 0,t.headers=e.headers?e.headers:void 0,t.token=e.token?e.token:void 0,t},qualifiesFor:function(e){var i=!1;return t.isEmpty(e)||(e.length>1&&!this.isMulti()?i=!1:(this.needsMeta&&s.loadMetadata(e),i=t.every(e,(function(e){var i=e.get("flags");return(t.isUndefined(i)||!i.isInTrash)&&this.executeFilter(e)}),this))),i},executeFilter:function(e){var i=!1;if(e&&t.isFunction(this._qualify)){try{i=this._qualify(e,a,t)}catch(e){i=!1,docs.common.Logger("AIF").error("Error in qualifying action: "+this.endPoint.get("id")+"."+this.get("id")+". Error is: "+e)}delete e.aifAppLink,docs.common.Logger("AIF").debug("qualify function returned: "+i)}return i},prepareInvoke:function(i){var o,n,c=e.Deferred(),d=this.get("invoke");r.isValidAppLinkRole(d.appLinkRole)&&t.each(i,(function(e){e.aifAppLink=s.createAppLink(e,d.appLinkRole)}));try{o=this._resolvedURL(i,a,t),docs.common.Logger("AIF").debug("Resolved url FROM: "+d.url+" TO: "+o)}catch(e){docs.common.Logger("AIF").error("Error in resolving URL for action: "+this.endPoint.get("id")+"."+this.get("id")+". Error is: "+e)}try{n=this._resolvedURLData(i,a,t),docs.common.Logger("AIF").debug("Resolved data FROM: "+d.data+" TO: "+n)}catch(e){docs.common.Logger("AIF").error("Error in resolving URL data for action: "+this.endPoint.get("id")+"."+this.get("id")+". Error is: "+e)}t.isUndefined(d.appLinkRole)||t.each(i,(function(e){delete e.aifAppLink}));var p={method:d.method,url:o,data:n,role:d.appLinkRole,headers:this.headers,addPCSToken:this.addPCSToken,token:"",tokenError:!1};if(this.addPCSToken){var u=l.getPCSApplication();if(u&&u.isEnabled()){var _=u.get("endPoint"),h=_.indexOf("/bpm/"),m=(_=_.substr(0,h))+"/bpm/workspace/js/homePage.js?ts="+e.now(),f=_+"/bpm/workspace/auth/token",g=this;return e.getScript(m).done((function(t,i,o){e.ajax(f,{type:"GET",dataType:"text",xhrFields:{withCredentials:!0},success:function(e,t,i){p.token="Bearer "+e,c.resolve(p)},error:function(e){e.errorHandled=!0,e.showWebBar=!1,new docs.views.MessageBar({messageText:docs.i18n.t("AIF_DIRECT_ACTION_FAILURE_PCS_TOKEN",g.getName()),messageType:"error"}),p.tokenError=!0,c.reject(p)}})})).fail((function(e){e.errorHandled=!0,e.showWebBar=!1,new docs.views.MessageBar({messageText:docs.i18n.t("AIF_DIRECT_ACTION_FAILURE_PCS_TOKEN",g.getName()),messageType:"error"}),p.tokenError=!0,c.reject(p)})),c.promise()}return new docs.views.MessageBar({messageText:docs.i18n.t("AIF_DIRECT_ACTION_FAILURE_PCS_DISABLED",this.getName()),messageType:"error"}),p.tokenError=!0,p}return p},executeDirectInvoke:function(i){i=i||{},e.when(this.prepareInvoke(i.items)).done((function(o){var n=i.async||!0;o.method&&o.url&&e.ajax(o.url,{type:o.method,async:n,data:o.data&&t.isObject(o.data)&&!t.isString(o.data)?JSON.stringify(o.data):o.data,beforeSend:function(e){if(!t.isEmpty(o.headers)){var i=t.keys(o.headers);t.each(i,(function(t){e.setRequestHeader(t,o.headers[t])}))}o.addPCSToken&&o.token&&!t.isEmpty(o.token)&&e.setRequestHeader("Authorization",o.token)},success:function(e,o,n){t.isFunction(i.success)&&i.success(n)},error:function(e,o,n){e.reauthenticate=!1,e.errorHandled=!0,t.isFunction(i.failure)&&i.failure(e)}})}))},handleEvent:function(e){this.endPoint.handleEvent(this,e)},getName:function(){if(t.isUndefined(this.xlatedName))switch(this.get("trigger")){case n.TriggerType.INFO:this.xlatedName=docs.i18n.t("APP_INFO_ACTION_NAME",this.endPoint.getName());break;case n.TriggerType.USER_CONFIG:this.xlatedName=docs.i18n.t("APP_USER_PREFS_ACTION_NAME",this.endPoint.getName());break;case n.TriggerType.TENANT_CONFIG:this.xlatedName=docs.i18n.t("APP_TENANT_PREFS_ACTION_NAME",this.endPoint.getName());break;default:this.xlatedName=this.endPoint.translateString(this.get("name"))}return this.xlatedName},getDescription:function(){return t.isUndefined(this.xlatedDesc)&&(this.xlatedDesc=this.endPoint.translateString(this.get("description"))),this.xlatedDesc},getType:function(){return this.get("type")},getTrigger:function(){return this.get("trigger")},isMulti:function(){return this.get("multi")},getViewType:function(){return this.get("presentation").view},getViewWidth:function(){return this.get("presentation").popupWidth},getViewHeight:function(){return this.get("presentation").popupHeight}}),docs.aif.models.Action})),define("docs/aif/model/EndPoint",["jquery","underscore","backbone","core/util/Globals","core/util/Service","core/util/Jsonify","core/view/MessageBar","common/aif/Constants","docs/aif/model/Validator","docs/aif/model/Action"],(function(e,t,i,docs,o,n,s,a,r,l){"use strict";var c=docs.common.Globals;return docs.aif.models.EndPoint=i.Model.extend({defaults:{category:a.EndPointCategory.CUSTOM,baseUrl:""},initialize:function(e,o){t.bindAll(this,"enable","update"),this.viewManager=o.viewManager,this.configTransMap=this.getConfigTranslationMap(e.stringsMap);var n=i.Collection.extend({model:l});this.actions=new n(e.actions,{endPoint:this,parse:!0}),e.tenantPrefs&&(this.tenantPrefsAction=new l({id:"tenantConfigAction",description:this.getDescription(),type:a.ActionType.UI,trigger:a.TriggerType.TENANT_CONFIG,invoke:e.tenantPrefs.invoke,evaluate:!0,presentation:e.tenantPrefs.presentation},{endPoint:this,parse:!0})),e.userPrefs&&(this.userPrefsAction=new l({id:"userConfigAction",description:this.getDescription(),type:a.ActionType.UI,trigger:a.TriggerType.USER_CONFIG,invoke:e.userPrefs.invoke,evaluate:!0,presentation:e.userPrefs.presentation},{endPoint:this,parse:!0})),e.info&&(this.infoAction=new l({id:"infoAction",description:this.getDescription(),type:a.ActionType.UI,trigger:a.TriggerType.INFO,invoke:e.info.invoke,evaluate:!0,presentation:e.info.presentation},{endPoint:this,parse:!0}))},parse:function(e){return this.enabled=e.enabled||!1,this.id=e.id,t.extend(e,e.config),e.category=r.isValidEndPointCategory(e.category)?e.category:a.EndPointCategory.CUSTOM,delete e.enabled,delete e.type,delete e.config,e},getActions:function(e,i){if(this.isEnabled()){var o=this.actions.where({trigger:e});return t.filter(o,(function(e){return e.qualifiesFor(i)}))}return[]},enable:function(i){if(t.isBoolean(i)&&this.isEnabled()!==i){var s=o.getServiceParamsForPost("AF_ENABLE_DISABLE_APP");s.data.dAppName=this.id,s.data.dIsAppEnabled=i;var r=this;e.ajax(s.url,{type:a.HttpMethod.POST,data:s.data,success:function(e,t,o){var s=n.parse_AF_CONFIGURE_APPLICATION(e);r.enabled=s[0].enabled,r.trigger("aif:appStateChanged",i),docs.common.Logger("AIF").debug(r.id+" "+r.enabled?"enabled":"disabled")},error:function(e,t,i){docs.common.Logger("AIF").debug("Failed to "+(r.enabled?"enable":"disable")+" "+r.id+". Error is "+t)}})}},update:function(e){this.collection.updateEndPoint(this,e)},isEnabled:function(){return!0===this.enabled},canEnable:function(){return!0},getConfigTranslationMap:function(e){var i;if(t.isUndefined(this.configTransMap)&&e){var o=c.lang;if(t.has(e,o))i=e[o];else{var n=o.lastIndexOf("-");n>0&&(i=e[o=o.substr(0,n)])}t.isUndefined(i)&&(i=e.en)}return i},translateString:function(e){var i;return i=t.isUndefined(e)?"":this.configTransMap&&t.has(this.configTransMap,e)?this.configTransMap[e]:docs.i18n.t(e),(t.isUndefined(i)||i===e+": NOT FOUND")&&(i=e),i},handleEvent:function(e,t){this.viewManager&&this.viewManager.createView(e,t)},getName:function(){return t.isUndefined(this.xlatedName)&&(this.xlatedName=this.translateString(this.get("name"))),this.xlatedName},getDescription:function(){return t.isUndefined(this.xlatedDesc)&&(this.xlatedDesc=this.translateString(this.get("description"))),this.xlatedDesc},getCategory:function(){return this.get("category")},getBaseUrl:function(){return this.get("baseUrl")},remove:function(t){var i=o.getServiceParamsForPost("AF_DELETE_JSON_APP");i.data.dAppName=this.get("id");var n=this;e.ajax(i.url,{type:a.HttpMethod.POST,data:i.data,success:function(e,i,o){"0"===e.LocalData.StatusCode?(n.collection.remove(n),!0!==t?new s({messageText:docs.i18n.t("APP_DELETE_SUCCESS_MSG",n.getName()),messageType:"success"}):docs.common.Logger("AIF").info(n.getName()+" successfully removed.")):!0!==t?new s({messageText:docs.i18n.t("APP_DELETE_ERROR_MSG",n.getName()),messageType:"error"}):docs.common.Logger("AIF").info(n.getName()+" removal failed.")},error:function(e,i,o){!0!==t?new s({messageText:docs.i18n.t("APP_DELETE_ERROR_MSG",n.getName()),messageType:"error"}):docs.common.Logger("AIF").info(n.getName()+" removal failed."),e.errorHandled=!0}})}}),docs.aif.models.EndPoint})),define("docs/aif/model/EndPoints",["jquery","underscore","backbone","core/util/Globals","core/util/Service","core/util/Jsonify","core/view/MessageBar","docs/aif/model/EndPoint","docs/aif/model/Validator"],(function(e,t,i,docs,o,n,s,a,r){"use strict";docs.common.Globals;return docs.aif.models.EndPoints=i.Collection.extend({model:a,initialize:function(e){t.bindAll(this,"createNewEndPoint","updateEndPoint"),this.viewManager=e.viewManager},url:function(){return o.formatServiceUrl("AF_GET_ONE_OR_MANY_JSON_APP_INFO")},parse:function(e){return n.parse_AF_GET_ONE_OR_MANY_JSON_APP_INFO(e)},comparator:function(e,t){var i=e.getName()||e.id,o=t.getName()||t.id;return i.localeCompare(o)},createNewEndPoint:function(e){var i=this._createEndPoint(e,e.id,"create",!0);t.isUndefined(i)||this.add(i)},updateEndPoint:function(e,i){var o;e.id!==i.id?(o=this._createEndPoint(i,i.id,"create",e.isEnabled()),t.isUndefined(o)||e.remove(!0)):(o=this._createEndPoint(i,e.id,"update",e.isEnabled()),t.isUndefined(o)||this.remove(e)),t.isUndefined(o)||this.add(o)},_createEndPoint:function(e,i,l,c){var d;if(t.isString(i)){var p=[JSON.stringify(e)],u={IdcService:"AF_ADD_UPDATE_JSON_APP_WITH_PAYLOAD",idcToken:o.getIdcToken(),IsJson:"1",UserTimeZone:"utc",dAppName:i,dAppAction:l,appJSONFile:new Blob(p,{type:"text/plain"}),dIsAppEnabled:!0===c};t.isBoolean(c)&&(u.dIsAppEnabled=c);var _=new window.FormData;t.each(t.keys(u),(function(e){_.append(e,u[e])})),this.xhr=new window.XMLHttpRequest,this.xhr.open("POST",o.formatServiceUrl("AF_ADD_UPDATE_JSON_APP_WITH_PAYLOAD"),!1);var h=this;this.xhr.addEventListener("load",(function(e){var o,c=r.validateJSON(e.target.responseText);if(!0!==c.invalid&&"0"===c.configs.LocalData.StatusCode){var p=n.parse_AF_ADD_UPDATE_JSON_APP_WITH_PAYLOAD(c.configs);d=new a(p,{viewManager:h.viewManager,parse:!0}),o="update"===l?"APP_CONFIG_UPDATE_SUCCESS":"APP_CONFIG_CREATE_SUCCESS",new s({messageText:docs.i18n.t(o,i),messageType:"success"})}if(t.isUndefined(d)){var u=c.configs.LocalData.StatusMessageKey||"";o=u.indexOf("!csAFAppAlreadyExist")>-1?"ERROR_CONFIG_ALREADY_EXISTS":u.indexOf("!csAFJSONAppInvalidAppName")>-1?"ERROR_CONFIG_INVALID_NAME":"update"===l?"ERROR_CONFIG_UPDATE_FAILED":"ERROR_CONFIG_CREATE_FAILED",new s({messageText:docs.i18n.t(o,i),messageType:"error"})}})),this.xhr.send(_)}return d}}),docs.aif.models.EndPoints})),define("docs/folderview/model/FavoritesFolder",["jquery","underscore","core/util/Service","core/util/Jsonify","common/site/SitesUtils","core/util/Globals","docs/folderview/model/Folder"],(function(e,t,i,o,n){"use strict";var s=docs.common.Globals;return docs.models.FavoritesFolder=docs.models.Folder.extend({isFavorites:!0,noMetadata:!0,initialize:function(e,t){docs.models.Folder.prototype.initialize.call(this,e,t)},url:function(){var e=i.formatServiceUrl("FLD_BROWSE_FAVORITES");e+="&doCombinedBrowse=1&combinedCount="+this.items.pagerData.virtualPageSize,e+="&combinedStartRow="+this.items.pagerData.pageStartRow;var t=this.get("sortOrder");return e+=this.sortParams[t],this.options.foldersonly&&(e+="&itemType=Folder"),s.sites?(e+="&doRetrieveMetadata=1",e+=n.includeSiteContentOnlyServiceParams()):e+=n.excludeSiteContentServiceParams(),e},parseModel:function(e){return o.parse_GET_FAVORITE_RESULTS(e)},parseItems:function(e){return o.parse_GET_FAVORITE_ITEMS(e)},getThumbnailUrl:function(e){return s.staticRoot+"images/favorite-folder"+(e?"_120.png":".png")}}),docs.models.FavoritesFolder})),define("docs/folderview/model/HomeFolder",["jquery","underscore","core/util/Globals","core/util/Session","core/util/Service","core/util/Jsonify","docs/folderview/model/Folder","core/plugin/jquery.bitparse"],(function(e,t,docs,i,o,n){"use strict";var s=docs.common.Globals;return docs.models.HomeFolder=docs.models.Folder.extend({sideboards:s.isAppLink?["properties"]:["conversation","metadata","properties"],isHome:!0,initialize:function(e,t){this.id=i.getPersonalFolderId(),docs.models.Folder.prototype.initialize.call(this,e,t),t.filter?(this.set("filter",t.filter,"silent: true"),i.folderFilter(t.filter)):this.set("filter",i.folderFilter(),"silent: true")},url:function(){var e="FLD_BROWSE_PERSONAL",t=this.get("filter");e="all"!==(t=t?t.slice(7):"")?"FLD_BROWSE_PERSONAL&source="+t:"FLD_BROWSE_PERSONAL";var i=o.formatServiceUrl(e);i+="&doCombinedBrowse=1&combinedCount="+this.items.pagerData.virtualPageSize,i+="&combinedStartRow="+this.items.pagerData.pageStartRow;var n=this.get("sortOrder");return i+=this.sortParams[n],"Folder"!==this.options.itemType&&"File"!==this.options.itemType||(i+="&itemType="+this.options.itemType),i+="&foldersFilterParams=fApplication&fApplication=framework,framework.dam"},parseModel:function(t){return{id:i.getPersonalFolderId(),name:docs.i18n.t("DOCUMENTS"),type:"folder",ownedBy:s.userid,ownedByName:s.userName,allowedActions:e.bitParse(t.LocalData.dAllowedActions,n.allowedActions)}},getThumbnailUrl:function(e){return s.staticRoot+"images/home-folder"+(e?"_120.png":".png")}}),docs.models.HomeFolder})),define("docs/folderview/view/FolderViewHeader",["jquery","backbone","underscore","core/util/Globals","common/util/O365Edit","common/container/view/ContextToolbarView","common/aif/Manager","common/container/view/ContainerViewHeader","common/mixin/ConversationsMixin","docs/mixins/FavoritesCache","docs/mixins/FavoritesMixin","common/sidebar/SidebarConfig","common/site/SitesUtils"],(function(e,t,i,docs,o,n,s,a,r,l,c,d,p){"use strict";var u=docs.common.Globals;return a.extend(i.extend({id:"folderview-header",events:i.extend({},a.prototype.events,c.favoriteContainerEvents()),initialize:function(e){return a.prototype.initialize.call(this,e),p.isSites(this.model)&&this.$el.addClass("sites"),this},renderData:function(){return{title:i.unescape(this.model.get("name")),hideTitle:this.options.header&&!1===this.options.header.title}},headerButtonConfig:{menu:{text:"CONTEXT_TOOLBAR_MORE"},hasActions:null,items:[{action:"action_upload_to_folder",location:"left",locationOrder:3,menu:"show",menuOrder:1,weight:2,tooltip:"GENERAL_UPLOAD_TOOLTIP",title:"GENERAL_UPLOAD_TOOLTIP",text:"GENERAL_CMD_UPLOAD",isUploader:!0},{action:"action_new_folder",location:"left",locationOrder:4,menu:"show",menuOrder:2,weight:3,tooltip:"GENERAL_CREATE_FOLDER_TOOLTIP",title:"GENERAL_CREATE_FOLDER_TOOLTIP",text:"GENERAL_CMD_CREATE"},{action:"create_menu",location:"left",locationOrder:4,menu:"show",menuOrder:2,weight:3,locationType:"comboButton",tooltip:"MENU_CREATE_TT",title:"MENU_CREATE_TT",text:"MENU_CREATE"},{menuSeparator:!0,location:"menu",menuOrder:3},{action:"action_favorite",location:"menu",menu:"show",menuOrder:4,title:"ACTION_ADD_FAVORITE",text:"ACTION_ADD_FAVORITE"},{action:"action_clear_favorite",location:"menu",menu:"show",menuOrder:5,title:"ACTION_DELETE_FAVORITE",text:"ACTION_DELETE_FAVORITE"},{menuSeparator:!0,location:"menu",menuOrder:6},{action:"action_links",location:"left",locationOrder:1,menu:"show",menuOrder:7,weight:1,tooltip:"ACTION_LINKS_FOLDER_TOOLTIP",title:"ACTION_LINKS_FOLDER_TOOLTIP",text:"ACTION_LINKS"},{action:"action_members",location:"left",locationOrder:2,menu:"show",menuOrder:8,weight:1,tooltip:"ACTION_MEMBERS_TOOLTIP",title:"ACTION_MEMBERS_TOOLTIP",text:"ACTION_MEMBERS"},{menuSeparator:!0,location:"menu",menuOrder:9},{action:"action_properties",location:"menu",menu:"show",menuOrder:10,title:"ACTION_PROPERTIES_TT",text:"ACTION_PROPERTIES"},{menuSeparator:!0,location:"menu",menuOrder:16},{action:"action_toggle_sidebar",location:"side",menu:"show",menuOrder:17,weight:5,title:"ACTION_TOGGLE_SIDEBAR_TT",text:"ACTION_TOGGLE_SIDEBAR",icon:"header-sider-icon oj-ux-icon oj-ux-ico-side-bar"}]},getComboButtonItems:function(e,t){switch(e){case"create_menu":return this.getActionSubmenuList(e,t)}},getActionSubmenuList:function(e,t){var o=this.getItemActions(),n=[],s=o.findWhere({id:e});if(s){var a=s.get("children"),r=o.filter((function(e){return i.contains(a,e.get("id"))}));i.each(r,(function(e,i){this.contextActions.hasActions(this.model,[e.id])[e.id]&&n.push(this.getItemProps(e,i,{verbose:t}))}),this)}return n},getItemActions:function(){var e=new t.Collection(this.contextActions.itemActions[this.model.get("type")]);return n.resolveMenuItems(e),e},getItemProps:function(e,t,i){var n="";return(i=i||{}).noTooltip||(n=e.get("tooltip")?e.get("tooltip"):e.get("label")),{action:e.id,locationType:"comboAction",order:t,rawText:e.get("label"),rawTooltip:n,itemIcon:o.getNewIcon(e.id),itemIconClass:o.getNewIconClass(e.id)}},hasActions:function(){var e=this.contextActions.hasActions(this.model,["action_upload_to_folder","action_new_folder","action_favorite","action_clear_favorite","action_properties","action_members","action_links","create_menu","action_menu_new_folder","action_o365_new_word","action_o365_new_ppt","action_o365_new_excel"]),t=u.isPublicLink,i=(u.isPublicUser,this.isFavorite(this.model)),n=(s.hasSidebarActions(this.model),p.isSites(this.model)),a=p.isTheme(this.model),r=p.isApp(this.model),l=p.isTemplate(this.model);e.action_new_folder=this.options.header.create.folder&&this.model.isAllowedAction("folderWrite"),e.action_upload_to_folder=this.options.header.upload&&this.model.isAllowedAction("folderWrite");var _=this.options.actions.favorite&&c.isFavoritesEnabled(this.model);return e.action_favorite=!i&&_,e.action_clear_favorite=i&&_,o.isEnabled({systemAndTenant:!0})?(e.create_menu=e.action_o365_new_word||e.action_o365_new_ppt||e.action_o365_new_excel,e.create_menu&&delete e.action_new_folder):(delete e.create_menu,delete e.action_menu_new_folder,delete e.action_o365_new_word,delete e.action_o365_new_ppt,delete e.action_o365_new_excel),e.action_toggle_sidebar=(!t||!u.isPublicUser)&&(!n||a||r||l)&&d.getTabs(this.model,this.options).length>0,e.action_properties=e.action_properties&&!(a||r||l),e},render:function(){a.prototype.render.call(this)},renderHeaderButtons:function(){a.prototype.renderHeaderButtons.call(this),this.options.header.favorites||e("#filter_favorites").remove(),this.options.header.trash||this.$("#filter_trash").remove(),this.contextActions&&this.listenTo(this.contextActions,"container:action_new_folder",this.newFolder)},actionSelected:function(e){switch(e){case"action_upload_to_folder":this.uploadClicked();break;case"action_new_folder":case"action_menu_new_folder":this.newFolder();break;case"action_o365_new_word":o.newOfficeDocument(this.model,"docx");break;case"action_o365_new_ppt":o.newOfficeDocument(this.model,"pptx");break;case"action_o365_new_excel":o.newOfficeDocument(this.model,"xlsx");break;case"action_favorite":l.addFavorite(this,this.model);break;case"action_clear_favorite":l.deleteFavorite(this,this.model);break;case"action_properties":this.showPropsDlg();break;case"action_members":this.showMembersDlg();break;case"action_links":this.showLinksDlg();break;case"action_toggle_sidebar":docs.events.trigger("sidebar:toggleSidebar");break;default:this.contextActions.trigger(e)}},configureHeaderButtons:function(){a.prototype.configureHeaderButtons.call(this)},onResize:function(){a.prototype.onResize.call(this),!u.embed||u.isAppLink&&!this.model.isAllowedAction("linkShareRead")||this.options.urlParams.hide_share||e("#share_button").toggle(this.$el.width()>=604)},onCloseView:function(){a.prototype.onCloseView.call(this)},newFolder:function(){require(["docs/dialogs/NewFolderDialog"],i.bind((function(e){e.show({cbContext:this,cbOk:function(e,t){this.model.createFolder(e,t)}})}),this))},uploadClicked:function(){this.contextActions&&this.contextActions.trigger("clearSelection")},showPropsDlg:function(){e('.layout-sidebar-sideboard .sideboard-button[data-name="properties"]').removeClass("selected"),e.sessionStorage("DocsSelectedtab","propTab"),docs.events.trigger("sidebar:showSidebar","properties")},showMembersDlg:function(){require(["sites/dialogs/MembersFPD"],i.bind((function(e){var t=e.show({route:"sites/members/",modelOptions:{selectedSite:this.model}});this._slideInDialog=t,docs.events.trigger("action:share")}),this))},showLinksDlg:function(){require(["docs/share/ShareLinkDialog"],i.bind((function(e){e.show({item:this.model,container:this.model,dialogTitle:docs.i18n.t("LINK_SHARE_DLG_TITLE",i.unescape(this.model.get("name")))})}),this))}},c,r))})),define("common/sites/model/BackgroundCopySiteProgressable",["jquery","underscore","core/util/Service","core/util/SitesJsonify","common/sites/SitesErrorMap","common/notification/model/TimeredProgressable"],(function(e,t,i,o,n){"use strict";return sites.models.BackgroundCopySiteProgressable=docs.models.TimeredProgressable.extend({defaults:{timerInterval:2e3,percentComplete:0,actionStatusList:[],errorList:[]},initialize:function(e,t){docs.models.TimeredProgressable.prototype.initialize.call(this,t)},startProgressTimer:function(){var e=this;this.progressTimer=window.setInterval((function(){e.updateStatus()}),this.get("timerInterval"))},updateStatus:function(){var t=this;if(!t.get("jobFinished")){var i=docs.common.Service.formatServiceUrl("SCS_GET_BACKGROUND_SERVICE_JOB_STATUS")+"&JobID="+t.get("jobID");e.ajax(i,{type:"GET",success:function(e){var i=sites.common.SitesJsonify.parse_SCS_GET_JOB_STATUS(e);i[0]&&("FAILED"===i[0].jobStatus?(t.set("jobFinished",!0),t.handleJobCompletion()):100!==i[0].percentComplete?t.set("percentComplete",i[0].percentComplete):"COMPLETE"!==i[0].jobStatus?t.set("percentComplete",90):(t.set("jobFinished",!0),t.handleJobCompletion()))}})}},handleJobCompletion:function(){var t=this,i=docs.common.Service.formatServiceUrl("SCS_GET_BACKGROUND_SERVICE_JOB_RESPONSE_DATA")+"&JobID="+t.get("jobID");e.ajax(i,{type:"GET",success:function(e){var i=sites.common.SitesJsonify.parse_SCS_GET_BACKGROUND_SERVICE_JOB_RESPONSE_DATA(e),o=t.get("successCallback"),n=t.get("callbackParam");t.set("response",i),"function"!=typeof o||o(e,t,n)},error:function(e,i,o){var n=t.get("errorCallback"),s=t.get("callbackParam");"function"!=typeof n||n(e,i,o,t,s)}})}}),sites.models.BackgroundCopySiteProgressable})),define("common/dialog/unzip/model/UnzipMgr",["jquery","underscore","core/util/Globals","core/util/Service","core/util/Utils","docs/notification/template/ProgressViewLink.template","core/view/NotificationManager","core/dialog/MessageDialog","core/util/Logger","core/util/Session","common/notification/model/TimeredProgressable","core/view/MessageBar","common/sites/model/BackgroundCopySiteProgressable","jqueryui-amd/widgets/progressbar"],(function(e,t,docs,i,o,n,s,a){"use strict";return docs.models.UnzipMgr=docs.models.TimeredProgressable.extend({className:"UnzipMgr",logger:"Unzip",defaults:{timerInterval:2e3,isPageReloading:!1},initialize:function(e){switch(t.bindAll(this,"progressMessage","completeMessage","createFolder"),docs.models.TimeredProgressable.prototype.initialize.call(this,e),this.set("itemCount",this.get("selection")?this.get("selection").length:0),this.parent=e.parent,this.get("action")){case"unzip":this.set("target",e.target),this.set("duplicateResolution",e.duplicateResolution)}},locationLink:function(e){var t="",s=n;return e.name&&(t=s({href:o.getLocation(e.id),name:i.breakWords(e.name)})),t},progressMessage:function(e,t){return docs.i18n.t("UNZIP_TITLE_IN_PROGRESS",e[0].name,this.locationLink(t))},completeMessage:function(e,t,i){return docs.i18n.t("UNZIP_TITLE_COMPLETE",e[0].name,this.locationLink(t))},createFolder:function(t,o){var n=i.getServiceParamsForPost("FLD_CREATE_FOLDER");n.data.fFolderName=t,n.data.fFolderDescription="",n.data.parent="fFolderGUID:"+o;var s=e.Deferred();return e.ajax(n.url,{type:"POST",data:n.data,success:function(e){s.resolve(e)},error:function(e){e.errorHandled=!0,s.resolve({})}}),s.promise()},perform:function(t,o){this.progressable=t,this.target=o,this.messageNumber=s.getWebBarNumber();var n=this.get("selection"),a=i.getServiceParamsForPost("DOCS_BULK_EXTRACT_ZIP"),r=this.get("target");a.data.destination="fFolderGUID:"+r,a.data.ConflictResolutionMethod=this.get("duplicateResolution"),a.url=a.url+"&item=fFileGUID:"+n[0].id,this.startProgressTimer(n);var l=this;this.jobId="",l.action=this.get("action"),t.$el.find(".wbCommands .wbCancel").hide(),t.$el.find(".wbCommands .wbDetails").hide(),e.ajax(a.url,{type:"POST",data:a.data,async:!0,success:function(e){l.parent.reload(),e.LocalData&&(l.jobId=e.LocalData.jobId,l.startDetailsTimer(),t.$el.find(".wbCommands .wbDetails").html(docs.i18n.t("GENERAL_CMD_DETAILS",this.messageNumber)),t.$el.find(".wbCommands .wbCancel").show().on("click",(function(){l.cancelUnzipOperation()})))},error:function(e,t,i){l.stopProgressTimer()}})},getUnzipDetails:function(){var t=i.getServiceParamsForPost("DOCS_BULK_STATUS");t.data.jobId=this.jobId;var o=e.Deferred(),n=this,s=this.get("selection");return e.ajax(t.url,{type:"POST",data:t.data,async:!0,success:function(e){o.resolve(e),e.LocalData&&parseInt(e.LocalData.completedPercentage)<99&&!n.progressTimer?n.startDetailsTimer():e.LocalData&&"true"===e.LocalData.completed&&"SUCCEEDED"===e.LocalData.progress?(n.stopDetailsTimer(),n.stopProgressTimer(),n.progressable.$el.find(".wbCommands .wbCancel").hide(),n.progressable.$el.find(".wbCommands .wbDetails").show().on("click",(function(){docs.events.trigger("progressable:unzipDetails",{selection:s,jobId:n.jobId,target:n.target})}))):e.LocalData&&"true"===e.LocalData.completed&&"SUCCEEDED"!==e.LocalData.progress&&(n.stopDetailsTimer(),n.progressable.model.set("errorMessage",e.LocalData.message?e.LocalData.message:docs.i18n.t("UNKNOWN_ERROR")),n.stopProgressTimer(!0),n.progressable.renderError(),n.progressable.$el.find(".wbCommands .wbCancel").hide(),n.progressable.$el.find(".wbCommands .wbDetails").hide())},error:function(e,t,i){o.reject(e)}}),o},startDetailsTimer:function(){var e=this;this.detailsProgressTimer=window.setInterval((function(){e.getUnzipDetails()}),2500)},stopDetailsTimer:function(){window.clearInterval(this.detailsProgressTimer),this.detailsProgressTimer=void 0},cancelUnzipOperation:function(){var e=this;a.show({title:docs.i18n.t("UNZIP_CANCEL_DIALOG_TITLE"),message:docs.i18n.t("UNZIP_CANCEL_DIALOG_MSG"),context:this,cancelButtonText:docs.i18n.t("NO"),cancelCallback:function(){return!0},okButtonText:docs.i18n.t("YES"),callback:function(t){e.cancelUnzip()},reverseButtons:"no",defaultButton:"ok"})},cancelUnzip:function(){this.detailsProgressTimer&&this.stopDetailsTimer(),this.progressable&&this.progressable.hideProgressBar();var t=this;this.progressable=new docs.views.ProgressBar({model:t,type:"indeterminate-progress",titles:{inProgress:docs.i18n.t("UNZIP_CANCEL_PROGRESS_MSG"),complete:docs.i18n.t("UNZIP_CANCEL_SUCCESSFUL")},messages:{inProgress:docs.i18n.t("UNZIP_CANCEL_PROGRESS_MSG"),complete:docs.i18n.t("UNZIP_CANCEL_SUCCESSFUL")}});var o=i.getServiceParamsForPost("DOCS_BULK_DELETE"),n=this.target;o.data.jobId=this.jobId,this.progressable.showProgressBar(),e.ajax(o.url,{type:"POST",data:o.data,async:!0,success:function(e){var i=docs.i18n.t("UNZIP_CANCEL_WARNING",t.locationLink(n));t.progressable&&(t.progressable.renderWarning(i),t.progressable.$el.find(".wbCommand.wbErrors.button-as-link").hide(),t.progressable.$el.find(".ui-progressbar-indeterminate").remove())},error:function(e,i,o){t.stopProgressTimer()}})}}),docs.models.UnzipMgr})),define("docs/folderview/template/FileRow.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<li id="'+(null==(__t=row.get("id"))?"":_.escape(__t))+'" tabindex="-1" class="containerview-item folderview-filerow skipTarget" role="listitem" aria-describedby="contextMenuHelp">  <div class="containerview-row-content" aria-label="'+(null==(__t=data.rowLabel)?"":_.escape(__t))+'" role="group">    <span class="containerview-check custom-checkbox"><input type="checkbox" title="'+(null==(__t=data.chkTitle)?"":__t)+'" /></span>    <span class="containerview-thumbnail"></span>    <span class="containerview-content-area">      <span class="containerview-textarea1">        <span class="containerview-name">          <a href="'+(null==(__t=data.href)?"":_.escape(__t))+'" title="'+(null==(__t=data.nameTitle)?"":__t)+'" aria-label="'+(null==(__t=data.nameTitle)?"":__t)+'" class="folderLink text_button containerview-openClick">            <span class="nameStart">'+(null==(__t=data.nameStart)?"":__t)+'</span><span class="nameEnd">'+(null==(__t=data.nameEnd)?"":__t)+"</span>          </a>        </span>      ",data.verDispLink?__p+='        <span class="containerview-revision"><a href="#" title="'+(null==(__t=data.verTitle)?"":__t)+'" aria-label="'+(null==(__t=data.verTitle)?"":__t)+'" class="folderLink text_button containerview-versionClick"> '+(null==(__t=data.verDisp)?"":_.escape(__t))+"</a></span>      ":__p+='        <span class="containerview-revision">'+(null==(__t=data.verDisp)?"":_.escape(__t))+"</span>      ",__p+='        <span class="containerview-prop">'+(null==(__t=row.get("size_display"))?"":_.escape(__t))+"</span>      </span>      ",data.hideStatusDisplay||(__p+='      <span class="containerview-textarea2">        <span class="containerview-status">'+(null==(__t=data.statusDisplay)?"":__t)+"</span>      </span>      "),__p+='      <span class="containerview-textarea3">        <span class="containerview-description" title="'+(null==(__t=row.get("description"))?"":_.escape(__t))+'">'+(null==(__t=row.get("description"))?"":_.escape(__t))+'</span>      </span>    </span>    <span class="containerview-buttons">      <span class="containerview-indicator"><span class="ui-icon ui-icon-lock folderview-reserved" title="'+(null==(__t=data.reserveTooltip)?"":_.escape(__t))+'"></span></span>      <span class="containerview-indicator folderview-conversation-pinned-placeholder"></span>      <span class="containerview-action">        <button class="containerview-item-button folderview-download-button ws-toolbar-button">          <span class="ui-icon ui-icon-athena-download"></span>        </button>      </span>      <span class="containerview-action">        <button class="containerview-item-button folderview-share-button ws-toolbar-button">          <span class="ui-icon ui-icon-athena-share"></span>        </button>      </span>    </span>  </div></li>';return __p}})),define("docs/folderview/view/FileRowView",["jquery","underscore","docs/folderview/template/FileRow.template","docs/folderview/view/FileItemView"],(function(e,t,i){"use strict";return docs.views.FileRowView=docs.views.FileItemView.extend({initialize:function(e){return(e=e||{}).template=i,e.largeThumbs=!1,e.realThumbs=!0,docs.views.FileItemView.prototype.initialize.call(this,e),this}}),docs.views.FileRowView})),define("docs/folderview/template/FileCard.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<li id="'+(null==(__t=row.get("id"))?"":_.escape(__t))+'" tabindex="0" class="containerview-item containerview-card skipTarget file-card-view" role="listitem" aria-describedby="contextMenuHelp">  <div class="containerview-card-frame" aria-label="'+(null==(__t=data.rowLabel)?"":_.escape(__t))+'" role="group" >    <div class="containerview-card-thumbnail-wrapper">      <div class="containerview-check custom-checkbox"><input tabindex="-1" type="checkbox" title="'+(null==(__t=data.chkTitle)?"":__t)+'" /></div>      <div class="containerview-card-thumbnail"></div>      <div class="containerview-card-thumbnail-overlay"></div>    </div>    <div class="containerview-card-metadata-wrapper">      <div class="containerview-card-selection-wrapper">        <div class="containerview-card-mla-selector"></div>        <div class="containerview-card-status-selector"></div>      </div>      <div class="containerview-card-name-wrapper">        <span class="containerview-card-name containerview-name folderLink text_button containerview-openClick" title="'+(null==(__t=data.nameTitle)?"":__t)+'" aria-label="'+(null==(__t=data.nameTitle)?"":__t)+'">          <span class="nameStart">'+(null==(__t=data.nameStart)?"":__t)+'</span><span class="nameEnd">'+(null==(__t=data.nameEnd)?"":__t)+'</span>        </span>      </div>      <div class="containerview-card-date-wrapper">      ',data.verDispLink?__p+='        <span class="containerview-card-revision"><a href="#" title="'+(null==(__t=data.verTitle)?"":__t)+'" aria-label="'+(null==(__t=data.verTitle)?"":__t)+'" class="folderLink text_button containerview-versionClick"> '+(null==(__t=data.verDisp)?"":_.escape(__t))+"</a></span>      ":__p+='        <span class="containerview-card-revision">'+(null==(__t=data.verDisp)?"":_.escape(__t))+"</span>      ",__p+='        <div class="containerview-card-date" title="'+(null==(__t=data.updateText)?"":__t)+'" aria-label="'+(null==(__t=data.updateText)?"":__t)+'">'+(null==(__t=data.updateDate)?"":__t)+'</div>      </div>      <div class="containerview-card-indicators-wrapper">        <div class="containerview-card-capsule-text filetype-extension-text">'+(null==(__t=row.get("extension"))?"":__t)+'</div>        <div class="containerview-card-indicators containerview-buttons">          <span class="containerview-card-indicator"><span class="ui-icon ui-icon-lock folderview-reserved" title="'+(null==(__t=data.reserveTooltip)?"":_.escape(__t))+'"></span></span>          <span class="containerview-card-indicator folderview-conversation-pinned-placeholder"></span>          <span class="containerview-action">            <button class="containerview-card-button containerview-item-button folderview-download-button ws-toolbar-button">              <span class="ui-icon ui-icon-athena-download"></span>            </button>          </span>          <span class="containerview-action">            <button class="containerview-card-button containerview-item-button folderview-share-button ws-toolbar-button">              <span class="ui-icon ui-icon-athena-share"></span>            </button>          </span>        </div>      </div>    </div>  </div></li>';return __p}})),define("docs/folderview/view/FileCardView",["jquery","underscore","docs/folderview/view/FileItemView","docs/folderview/template/FileCard.template"],(function(e,t,i,o){"use strict";return docs.views.FileCardView=i.extend({initialize:function(e){return(e=e||{}).template=o,e.largeThumbs=!0,e.realThumbs=!0,i.prototype.initialize.call(this,e),this},getRenderData:function(e){var t=i.prototype.getRenderData.call(this,e),o=docs.i18n.t("FILEVIEW_REV",parseInt(this.model.get("revision"),10));o=o.replace("(","").replace(")",""),t.verDisp=o;var n=parseInt(this.model.get("revision"),10);t.verTitle=docs.i18n.t(t.verDispLink?"ACTION_VERS_TT":"FILEVIEW_ARIA_REV",n);var s=this.getUpdateInfo();return t.updateDate=s.updateDate,t.updateText=s.updateText,t}}),docs.views.FileCardView})),define("docs/folderview/template/FolderRow.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<li id="'+(null==(__t=row.get("id"))?"":_.escape(__t))+'" tabindex="-1" class="containerview-item '+(null==(__t=data.rowClass)?"":_.escape(__t))+' skipTarget">  <div class="containerview-row-content" aria-label="'+(null==(__t=data.rowLabel)?"":_.escape(__t))+'" role="group">    <span class="containerview-check custom-checkbox"><input type="checkbox" title="'+(null==(__t=data.chkTitle)?"":__t)+'" /></span>    <span class="containerview-thumbnail"></span>    <span class="containerview-content-area">      <span class="containerview-textarea1">        <span class="containerview-name">          <a href="'+(null==(__t=data.href)?"":_.escape(__t))+'" title="'+(null==(__t=data.nameTitle)?"":__t)+'" aria-label="'+(null==(__t=data.nameTitle)?"":__t)+'" class="folderLink text_button containerview-openClick">            <span class="nameStart">'+(null==(__t=data.nameStart)?"":__t)+'</span><span class="nameEnd">'+(null==(__t=data.nameEnd)?"":__t)+"</span>          </a>        </span>      </span>      ",data.hideStatusDisplay||(__p+='      <span class="containerview-textarea2" title="'+(null==(__t=data.statusDisplayTitle)?"":__t)+'">        <span class="containerview-status">'+(null==(__t=data.statusDisplay)?"":__t)+"</span>      </span>      "),__p+="      ",data.ownedBy&&(__p+='      <span class="containerview-textarea2" title="'+(null==(__t=data.ownedBy)?"":__t)+'">        <span class="containerview-status">'+(null==(__t=data.ownedBy)?"":__t)+"</span>      </span>      "),__p+='      <span class="containerview-textarea3">        <span class="containerview-description" title="'+(null==(__t=row.get("description"))?"":_.escape(__t))+'">'+(null==(__t=row.get("description"))?"":_.escape(__t))+'</span>      </span>    </span>    <span class="containerview-buttons">      <span class="containerview-action"><span class="empty"></span></span>      <span class="containerview-action">        <button class="containerview-item-button folderview-share-button"><span class="ui-icon ui-icon-athena-share"></span></button>      </span>    </span>  </div></li>';return __p}})),define("docs/folderview/view/FolderRowView",["jquery","underscore","docs/folderview/template/FolderRow.template","docs/folderview/view/FolderItemView"],(function(e,t,i){"use strict";return docs.views.FolderRowView=docs.views.FolderItemView.extend({initialize:function(e){return(e=e||{}).template=i,e.largeThumbs=!1,e.noCenterThumb=!0,docs.views.FolderItemView.prototype.initialize.call(this,e),this}}),docs.views.FolderRowView})),define("docs/folderview/template/FolderCard.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",data.isTrashSiteItem?__p+='<li id="'+(null==(__t=row.get("id"))?"":_.escape(__t))+'" tabindex="0" class="containerview-item containerview-card skipTarget file-card-view">  <div class="containerview-card-frame" aria-label="'+(null==(__t=data.rowLabel)?"":_.escape(__t))+'" role="group" >    <div class="containerview-card-thumbnail-wrapper">      <div class="containerview-check custom-checkbox"><input tabindex="-1" type="checkbox" title="'+(null==(__t=data.chkTitle)?"":__t)+'" /></div>      <div class="containerview-card-thumbnail"></div>      <div class="containerview-card-thumbnail-overlay"></div>    </div>    <div class="containerview-card-metadata-wrapper">      <div class="containerview-card-selection-wrapper">        <div class="containerview-card-mla-selector"></div>        <div class="containerview-card-status-selector"></div>      </div>      <div class="containerview-card-name-wrapper">        <span class="containerview-card-name containerview-name folderLink text_button containerview-openClick" title="'+(null==(__t=data.nameTitle)?"":__t)+'" aria-label="'+(null==(__t=data.nameTitle)?"":__t)+'">          <span class="nameStart">'+(null==(__t=data.nameStart)?"":__t)+'</span><span class="nameEnd">'+(null==(__t=data.nameEnd)?"":__t)+'</span>        </span>      </div>      <div class="containerview-card-date-wrapper">        <div class="containerview-card-date" title="'+(null==(__t=data.updateText)?"":__t)+'" aria-label="'+(null==(__t=data.updateText)?"":__t)+'">'+(null==(__t=data.updateDate)?"":__t)+'</div>      </div>      <div class="containerview-card-indicators-wrapper">        <div class="containerview-card-capsule-text">'+(null==(__t=data.capsuleText)?"":_.escape(__t))+'</div>        <div class="containerview-card-indicators containerview-buttons"></div>      </div>    </div>  </div></li>':(__p+='<li id="'+(null==(__t=row.get("id"))?"":_.escape(__t))+'" tabindex="-1" class="containerview-item containerview-card skipTarget folder-card-view">  <div class="containerview-card-frame" aria-label="'+(null==(__t=data.rowLabel)?"":_.escape(__t))+'" role="group">    <div class="containerview-card-folder-wrapper">      <div class="containerview-card-folder"></div>      <div class="containerview-card-folder-overlay"></div>      <div class="containerview-check custom-checkbox"><input tabindex="-1" type="checkbox" title="'+(null==(__t=data.chkTitle)?"":__t)+'" /></div>      <div class="containerview-card-name-wrapper">        <span class="containerview-card-name containerview-name folderLink text_button containerview-openClick" title="'+(null==(__t=data.nameTitle)?"":__t)+'" aria-label="'+(null==(__t=data.nameTitle)?"":__t)+'">          <span class="nameStart">'+(null==(__t=data.nameStart)?"":__t)+'</span><span class="nameEnd">'+(null==(__t=data.nameEnd)?"":__t)+'</span>        </span>      </div>    </div>    <div class="containerview-card-folder-indicators-wrapper">      <div class="containerview-folder-share-wrapper">        ',row.isSharedByYou()?__p+='        <span class="containerview-card-indicator"><span class="folder-shared folder-shared-icon oj-ux-icon oj-ux-ico-layers" title="'+(null==(__t=i18n.t("FOLDERVIEW_SHARED_BY_YOU"))?"":_.escape(__t))+'"></span></span>        ':row.isSharedToYou()&&(__p+='        <span class="containerview-card-indicator"><span class="folder-shared folder-shared-icon oj-ux-icon oj-ux-ico-layers" title="'+(null==(__t=i18n.t("FOLDERVIEW_SHARED_WITH_YOU"))?"":_.escape(__t))+'"></span></span>        '),__p+='      </div>      <div class="containerview-card-folder-indicators">        <div class="containerview-buttons">          <span class="containerview-action">            <button class="containerview-card-button containerview-item-button folderview-share-button"><span class="ui-icon ui-icon-athena-share"></span></button>          </span>        </div>      </div>    </div>  </div></li>'),__p+="";return __p}})),define("docs/folderview/view/FolderCardView",["jquery","underscore","core/util/Globals","core/util/SitesGlobals","docs/folderview/view/FolderItemView","docs/folderview/template/FolderCard.template"],(function(e,t,docs,sites,i,o){"use strict";docs.common.Globals;return docs.views.FolderCardView=i.extend({initialize:function(e){return(e=e||{}).template=o,i.prototype.initialize.call(this,e),this},flagsChanged:function(){docs.views.FolderItemView.prototype.flagsChanged.call(this);var t=this.model.get("flags");if(this.$(".containerview-folder-share-wrapper").empty(),t&&t.isShared){var i=e('<span class="containerview-card-indicator"><span class="folder-shared folder-shared-icon oj-ux-icon oj-ux-ico-layers"></span></span>');this.$(".containerview-folder-share-wrapper").append(i),this.$(".folder-shared").attr("title",this.model.isSharedByYou()?docs.i18n.t("FOLDERVIEW_SHARED_BY_YOU"):docs.i18n.t("FOLDERVIEW_SHARED_WITH_YOU"))}}}),docs.views.FolderCardView})),define("docs/template/DragHelper.template",["underscore"],(function(_){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="drag-helper">  <div class="drag-helper-cursor">    <div class=\'ui-widget-header drag-text\'>      <span class="athena-icon-16 '+(null==(__t=dragIconClass)?"":_.escape(__t))+'"></span>      <span>'+(null==(__t=dragText)?"":_.escape(__t))+"</span>    </div>    <div class='ui-widget-header no-drag-text'>      <span class=\"athena-icon-16 athena-icon-16-error\"></span>      <span>"+(null==(__t=i18n.t("FOLDERVIEW_CANT_MOVE_HERE"))?"":_.escape(__t))+"</span>    </div>  </div></div>";return __p}})),
/*!
 * jQuery UI Droppable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
function(e){"use strict";"function"==typeof define&&define.amd?define("jqueryui-amd/widgets/droppable",["jquery","./draggable","./mouse","../version","../widget"],e):e(jQuery)}((function(e){"use strict";return e.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept="function"==typeof i?i:function(e){return e.is(i)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if("accept"===t)this.accept="function"==typeof i?i:function(e){return e.is(i)};else if("scope"===t){var o=e.ui.ddmanager.droppables[this.options.scope];this._splice(o),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var o=i||e.ui.ddmanager.current,n=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var i=e(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===o.options.scope&&i.accept.call(i.element[0],o.currentItem||o.element)&&e.ui.intersect(o,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t))return n=!0,!1})),!n&&(!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",t,this.ui(o)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,o,n){if(!i.offset)return!1;var s=(t.positionAbs||t.position.absolute).left+t.margins.left,a=(t.positionAbs||t.position.absolute).top+t.margins.top,r=s+t.helperProportions.width,l=a+t.helperProportions.height,c=i.offset.left,d=i.offset.top,p=c+i.proportions().width,u=d+i.proportions().height;switch(o){case"fit":return c<=s&&r<=p&&d<=a&&l<=u;case"intersect":return c<s+t.helperProportions.width/2&&r-t.helperProportions.width/2<p&&d<a+t.helperProportions.height/2&&l-t.helperProportions.height/2<u;case"pointer":return e(n.pageY,d,i.proportions().height)&&e(n.pageX,c,i.proportions().width);case"touch":return(a>=d&&a<=u||l>=d&&l<=u||a<d&&l>u)&&(s>=c&&s<=p||r>=c&&r<=p||s<c&&r>p);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var o,n,s=e.ui.ddmanager.droppables[t.options.scope]||[],a=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(o=0;o<s.length;o++)if(!(s[o].options.disabled||t&&!s[o].accept.call(s[o].element[0],t.currentItem||t.element))){for(n=0;n<r.length;n++)if(r[n]===s[o].element[0]){s[o].proportions().height=0;continue e}s[o].visible="none"!==s[o].element.css("display"),s[o].visible&&("mousedown"===a&&s[o]._activate.call(s[o],i),s[o].offset=s[o].element.offset(),s[o].proportions({width:s[o].element[0].offsetWidth,height:s[o].element[0].offsetHeight}))}},drop:function(t,i){var o=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(o=this._drop.call(this,i)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))})),o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}))},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,s,a=e.ui.intersect(t,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===n}))).length&&((o=e(s[0]).droppable("instance")).greedyChild="isover"===r)),o&&"isover"===r&&(o.isover=!1,o.isout=!0,o._out.call(o,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),o&&"isout"===r&&(o.isout=!1,o.isover=!0,o._over.call(o,i)))}}))},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable})),define("docs/folderview/view/FolderViewDetail",["jquery","backbone","underscore","core/util/Globals","core/util/SitesGlobals","core/util/Service","core/util/UrlParams","core/util/Utils","core/router/DocsController","core/util/Browser","core/util/Session","core/embedapi/EmbedApi","core/authz","common/container/config","common/container/view/ContainerViewDetail","common/container/view/DragAndDropUtils","core/dialog/MessageDialog","common/dialog/movecopy/model/MoveCopyMgr","common/dialog/unzip/model/UnzipMgr","docs/folderview/view/FolderViewHeader","docs/mixins/FavoritesMixin","core/view/MessageBar","common/notification/view/ProgressBar","docs/folderview/view/FileRowView","docs/folderview/view/FileCardView","docs/folderview/view/FolderRowView","docs/folderview/view/FolderCardView","docs/folderview/view/DocumentTableRowView","docs/template/DragHelper.template","common/site/SitesUtils","jqueryui-amd/widgets/droppable","jqueryui-amd/widgets/draggable"],(function(e,t,i,docs,sites,o,n,s,a,r,l,c,d,p,u,_,h,m,f,g,v,w,E,T,b,A,I,P,R,S){"use strict";var O=docs.common.Globals,C=docs.events;return docs.container.Config.rowViews.folder=A,docs.container.Config.rowViews.file=T,docs.container.Config.cardViews.folder=I,docs.container.Config.cardViews.file=b,u.extend(i.extend({ContainerTableRowView:P,events:i.extend({},u.prototype.events,v.favoriteItemEvents(),{"click .folderview-edit-button":"editFile","click .folderview-download-button":"downloadFile","click .folderview-share-button":"shareItem","click .new_folder_link":"newFolder","click .folderview-conversation-pinned":"viewPinnedConversation","click .add_collection_link":"newFolder"}),updateUrl:function(){if(this.containerView.url){var e=i.result(this.containerView,"url"),t=this.collection.container.get("sortOrder").slice("sort_".length);"nameasc"!==t&&(e+="/"+t);var o=this.collection.pagerData.get("page");o>1&&(e+="/p"+o);var s=this.options.urlParams.conversationId;if(s){e+="/o"+s;var a=this.options.urlParams.chatId;if(a)e+="/m"+a,this.options.urlParams.replyToChat&&(e+="/reply")}return e+=n.getConfigUrlPart(this.options.urlParams),e+=n.getViewConfigUrlPart(this.options.urlParams),docs.router.navigate(e,{trigger:!1,replace:!0}),e}},initialize:function(e){return"documents"===e.selectable&&(e.selectableTypes=["file"]),u.prototype.initialize.call(this,e),this.listenTo(this.contextActions,"action_rename",this.actionRename),this.listenTo(this.contextActions,"action_trash",this.actionTrash),this.listenTo(this.contextActions,"action_members",this.actionMembers),this.listenTo(this.contextActions,"action_links",this.actionShareLink),this.listenTo(this.contextActions,"action_view",this.actionOpen),this.listenTo(this.contextActions,"action_open",this.actionOpen),this.listenTo(this.contextActions,"action_download",this.actionDownload),this.listenTo(this.contextActions,"action_bulk_download",this.actionBulkDownload),this.listenTo(this.contextActions,"action_webedit",this.actionEdit),this.listenTo(this.contextActions,"action_unzip",this.actionUnzip),this.listenTo(this.contextActions,"action_o365_edit",this.actionO365Edit),this.listenTo(this.contextActions,"action_o365_view",this.actionO365View),this.listenTo(this.contextActions,"action_move",this.actionMove),this.listenTo(this.contextActions,"action_copy",this.actionCopy),this.listenTo(this.contextActions,"action_delete",this.actionDelete),this.listenTo(this.contextActions,"action_restore",this.actionRestore),this.listenTo(this.contextActions,"action_properties",this.actionProperties),this.listenTo(this.contextActions,"action_conversation",this.actionConversation),this.listenTo(this.contextActions,"action_tag",this.actionTag),this.listenTo(this.contextActions,"action_add_to_assets",this.actionAddToAssets),this.listenTo(this.contextActions,"action_favorite",this.toggleFavoriteFromSelection),this.listenTo(this.contextActions,"action_unfavorite",this.toggleFavoriteFromSelection),this.listenTo(this.contextActions,"action_reserve",this.actionReserve),this.listenTo(this.contextActions,"action_free",this.actionFree),this.listenTo(this.contextActions,"action_select_all",this.actionSelAll),this.listenTo(C,"FolderViewDetail:reload",this.reload),this.listenTo(C,"FileItem:makeReservation",this.makeReservationResult),this.listenTo(C,"FileItem:clearReservation",this.clearReservationResult),this.listenTo(C,"containerItem:versionActivityItem",this.openVersionActivity),this.listenTo(this.contextActions,"view_menu",i.noop),this.listenTo(this.contextActions,"edit_menu",i.noop),this.listenTo(this.contextActions,"action_sidebar_menu",i.noop),i.bindAll(this,"_refreshExtUsersLinksBanner"),this.listenTo(docs.events,"members:updated links:updated",this._refreshExtUsersLinksBanner),this.listenTo(docs.events,"progressable:unzipDetails",this.showUnzipDetails),this.listenTo(C,"embedapi:documentsView:toggleSidebar",(function(e){this.contextActions.trigger("sidebar:toggleSidebar")})),this.listenTo(C,"embedapi:documentsView:showSidebar",(function(e){this.contextActions.trigger("sidebar:showSidebar",e)})),this.listenTo(C,"embedapi:documentsView:hideSidebar",(function(e){this.contextActions.trigger("sidebar:hideSidebar",!0)})),this},setFocus:function(){e("button[data-action=action_cancel]").focus()},updateTabItemEntry:function(e,t){var i=e.find(this.activeFocusItems);this.itemIsMine(e)&&(this.$(this.itemMainFocus).removeAttr("tabindex"),e.attr({tabindex:0}),t&&(this.$(this.itemMainFocus).removeClass("focused"),e.hasClass("containerview-noselect")?e.focus():i.first().focus()))},getEmptyBoilerplateHtml:function(){var e,t,i=this.collection.container.isHome?"folder-bp bp-home bp-large inner-min-height bp-redwood-illustration":"folder-bp bp-large bp-redwood-illustration";this.collection.container.isHome?"filter_shared"===this.collection.container.get("filter")?(i="folder-bp bp-large bp-redwood-illustration",e=this.getBoilerplateHtml(i,"Boilerplate_Shared_Content.png",docs.i18n.t("BP_EMPTY_SHARED_WITH_YOU_MSG"),docs.i18n.t("BP_EMPTY_SHARED_WITH_YOU_DETAIL"))):e=this.options.urlParams.hide_upload?this.getBoilerplateHtml(i,"Boilerplate_Documents.png",docs.i18n.t("BP_EMPTY_FOLDER_MSG"),docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_UPLOAD")):this.options.urlParams.hide_new?this.getBoilerplateHtml(i,"Boilerplate_Documents.png",docs.i18n.t("BP_EMPTY_FOLDER_MSG"),docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_CREATE_NEW")):s.getGenericBoilerplateHtml(i,O.staticRoot+"images/Boilerplate_Documents.png",docs.i18n.t("BP_EMPTY_ROOT_FOLDER_MSG"),docs.common.Globals.isStandardExternalUser?docs.i18n.t("BP_EMPTY_ROOT_FOLDER_DETAIL_EXTERNAL_USER"):docs.i18n.t("BP_EMPTY_FOLDER_DETAIL")):this.collection.container.isTrash&&this.collection.container.emptyInProgress?e=this.getBoilerplateHtml(i,"Boilerplate_Trash.png",docs.i18n.t("BP_EMPTY_TRASH_FOLDER_IN_PROGRESS_MSG"),docs.i18n.t("BP_EMPTY_TRASH_FOLDER_IN_PROGRESS_DETAIL")):this.collection.container.isTrash?e=this.getBoilerplateHtml(i,"Boilerplate_Trash.png",docs.i18n.t("BP_EMPTY_TRASH_FOLDER_MSG"),docs.i18n.t("BP_EMPTY_TRASH_FOLDER_DETAIL")):this.collection.container.isSearchResults?(t=docs.i18n.t("BP_EMPTY_SEARCH_FOLDER_DETAIL",this.collection.container.get("searchstr")),e=this.getBoilerplateHtml(i,"Boilerplate_Error.png",docs.i18n.t("BP_EMPTY_SEARCH_FOLDER_MSG"),t)):this.collection.container.isFavorites?(t=docs.i18n.t("BP_EMPTY_FAVORITE_FOLDER_DETAIL"),e=this.getBoilerplateHtml(i,"Boilerplate_Favorites.png",docs.i18n.t("BP_EMPTY_FAVORITE_FOLDER_MSG"),t)):this.collection.container.isSharedToYou()||this.collection.container.isSharedByYou()?(t=this.collection.container.isAllowedAction("folderWrite")?docs.common.Globals.isStandardExternalUser?docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_EXTERNAL_USER"):this.options.urlParams.hide_upload?docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_UPLOAD"):this.options.urlParams.hide_new?docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_CREATE_NEW"):docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_SHARED"):docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_RIGHTS"),e=this.getBoilerplateHtml(i,"Boilerplate_Shared_Content.png",docs.i18n.t("BP_EMPTY_SHARED_FOLDER_MSG"),t)):(t=!o.isAppLink||this.collection.container.isAllowedAction("folderWrite")?this.options.urlParams.hide_upload?docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_UPLOAD"):this.options.urlParams.hide_new?docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_CREATE_NEW"):docs.i18n.t("BP_EMPTY_FOLDER_DETAIL"):docs.i18n.t("BP_EMPTY_FOLDER_DETAIL_NO_CONTENT"),e=this.getBoilerplateHtml(i,"Boilerplate_Documents.png",docs.i18n.t("BP_EMPTY_FOLDER_MSG"),t));return e},actionOpen:function(e,t){return this._doActionOpen(e,t)},_doActionOpen:function(t,i,o,n){o=o||e(i.currentTarget).hasClass("conversationType"),n=n||(t[0].folderItem.isFile?"fileview/":"folder/")+t[0].id,!0===o&&(n+="/sbr=conversations");var s=t[0].folderItem.isFile?this.options.actions.open.file:this.options.actions.open.folder;u.prototype.openNavigate.call(this,i,n,s)},actionDelete:function(t){var i=e(document.activeElement);h.show({title:docs.i18n.t("DELETE_PERMANENTLY_CONFIRM"),message:docs.i18n.t("DELETE_PERMANENTLY_CONFIRM_MSG"),danger:!0,context:this,cancelButtonText:docs.i18n.t("NO"),cancelCallback:function(){i&&i.focus()},okButtonText:docs.i18n.t("YES"),callback:function(e){var i=new m({action:"deletePermanently",selection:t,folderItems:e.collection,sourceId:e.collection.id,useBackgroundJob:!0,timerInterval:5e3});new docs.views.ProgressBar({model:i,type:"",titles:{inProgress:i.progressTitle,complete:i.completeTitle},messages:{inProgress:i.progressMessage,complete:i.completeMessage}}),i.perform()},reverseButtons:"no",defaultButton:"ok"})},actionDownload:function(e){var t=e[0].id,i=this.collection.where({id:t})[0];i.isDownloadable()&&(i.startDownload(!0),C.trigger("history:modified"))},actionBulkDownload:function(e){require(["docs/notification/view/BulkDownloadProgressBar","docs/notification/model/BulkDownloadFilesProgressable","docs/upload/model/ProcessItem","common/container/model/ContainerItem"],i.bind((function(o,n,s,a){var r=i.pluck(e,"folderItem"),l=new n({action:"prepareBulkDownload",errorMap:{csBulkdownloadUnableToInitJob:{causes:{csFldDoesNotExist:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_PARENT_INVALID"},csCloudItemInsufficientPrivileges:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_NO_ACCESS_FILES",responseArgs:["LocalData.items"]},csCloudBulkDownloadRequestNotValidTooLarge:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_TOO_LARGE"},csCloudBulkDownloadRequestNotValidTooManyFiles:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_TOO_MANY_FILES"},csCloudBulkDownloadRequestItemsNotInParentFolder:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_NOT_IN_PARENT"},csCloudBulkDownloadRequestItemsNoWork:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_EMPTY_FOLDER"}}},defaultMsg:{formatString:"MSG_PREPARING_FILES_FOR_DOWNLOAD_UNEXPECTED",args:2,responseArgs:["LocalData.StatusMessage"]}},folderItems:i.pluck(e,"folderItem"),maxPctDisplayed:100});this.model.isFavorites?(l.parentModel=this.model.clone(),l.parentModel.set("id",r[0].get("parentID"))):l.parentModel=this.model,l.items=new t.Collection(new s({id:"",name:"",img:O.staticRoot+"images/thumbs/zip_40.png",thumbDetails:{overlayText:"ZIP"},locationLinkStates:["finished","finished-with-error"]})),new o({model:l}),a.requestBulkDownload(r,l)}),this))},actionEdit:function(e){this.doEditAction(e,"desktopEdit")},actionUnzip:function(e){var t=this.collection.container;(t.isFavorites||t.isSearchResults)&&(e[0].folderItem.get("ownedBy")!==docs.common.Session.getUserName()?t.id="F:USER:"+docs.common.Session.getUserName():t.id=e[0].folderItem.get("parentID"),t.set("ownedBy",e[0].folderItem.get("ownedBy"))),require(["docs/dialogs/UnzipDialog",docs.common.Utils.getCssRequirePath("gemini-dialog")],i.bind((function(i){i.show({themeMode:S.isTheme(this.collection.container),appMode:S.isApp(this.collection.container),currentFolder:t,selection:e,moveMode:!0,cbOk:function(t,i){this.doUnzip(e,t,i,this)},cbContext:this})}),this))},showUnzipDetails:function(e){require(["docs/dialogs/UnzipDetailsDialog"],i.bind((function(t){t.show({cbContext:this,unzipSelectionDetails:e})}),this))},actionO365Edit:function(e){this.doEditAction(e,"o365Edit")},doEditAction:function(e,t){var i=e[0].id,o=this.collection.where({id:i})[0];"file"===o.get("type")&&o.isAllowedAction("fileRead")&&o.startEdit(t)},actionO365View:function(e){var t=e[0].id,i=this.collection.where({id:t})[0];"file"===i.get("type")&&i.startView()},actionMove:function(e){var t=this.collection.container;(t.isFavorites||t.isSearchResults)&&(t.id=e[0].folderItem.get("parentID"),t.set("ownedBy",e[0].folderItem.get("ownedBy"))),require(["docs/dialogs/MoveCopyDialog"],i.bind((function(i){i.show({themeMode:S.isTheme(this.collection.container),appMode:S.isApp(this.collection.container),currentFolder:t,selection:e,moveMode:!0,cbOk:function(t,i){this.doMoveCopy(i,t,e)},cbContext:this})}),this))},actionCopy:function(e){var t=this.collection.container;(t.isFavorites||t.isSearchResults)&&(e[0].folderItem.get("ownedBy")!==docs.common.Session.getUserName()?t.id="F:USER:"+docs.common.Session.getUserName():t.id=e[0].folderItem.get("parentID"),t.set("ownedBy",e[0].folderItem.get("ownedBy"))),require(["docs/dialogs/MoveCopyDialog"],i.bind((function(i){i.show({themeMode:S.isTheme(this.collection.container),appMode:S.isApp(this.collection.container),currentFolder:t,selection:e,moveMode:!1,cbOk:function(t,i){this.doMoveCopy(i,t,e)},cbContext:this})}),this))},doMoveCopy:function(e,t,i){var o=new m({action:e,selection:i,target:t,sourceId:this.collection.id,folderItems:this.collection});new docs.views.ProgressBar({model:o,type:"indeterminate-progress",titles:{inProgress:o.progressTitle,complete:o.completeTitle},messages:{inProgress:o.progressMessage,complete:o.completeMessage}}),o.perform(),this.updateSelection(this.getSelection())},doUnzip:function(e,t,i){var o=new f({action:"unzip",selection:e,target:t.id,duplicateResolution:i,parent:this}),n=new docs.views.ProgressBar({model:o,type:"indeterminate-progress",titles:{inProgress:docs.i18n.t("UNZIP_TITLE_IN_PROGRESS",e[0].name,o.locationLink(t)),complete:docs.i18n.t("UNZIP_TITLE_COMPLETE",e[0].name,o.locationLink(t))},messages:{inProgress:docs.i18n.t("UNZIP_TITLE_IN_PROGRESS",e[0].name,o.locationLink(t)),complete:docs.i18n.t("UNZIP_TITLE_COMPLETE",e[0].name,o.locationLink(t))}});if(""===i||void 0===i){var s=t.id,a=e[0].name.split(".").slice(0,-1).join(".");o.createFolder(a,s).done((function(e){var i=e.LocalData.fFolderGUID;o.set("target",i),o.perform(n,t)}))}else o.perform(n,t)},doTrash:function(e){var t=new m({action:"trash",selection:e,sourceId:this.collection.id,folderItems:this.collection,hide_trash_link:this.options.urlParams.hide_trash_link});"framework.site.theme"!==e[0].folderItem.get("application")&&"framework.site.app"!==e[0].folderItem.get("application")||t.set("trashLink","sites/trash"),new docs.views.ProgressBar({model:t,type:"indeterminate-progress",titles:{inProgress:t.progressTitle,complete:t.completeTitle},messages:{inProgress:t.progressMessage,complete:t.completeMessage}}),t.perform()},actionRestore:function(e){h.show({title:docs.i18n.t("RESTORE_CONFIRM"),message:docs.i18n.t("RESTORE_CONFIRM_MSG"),context:this,cancelButtonText:docs.i18n.t("NO"),cancelCallback:i.noop,okButtonText:docs.i18n.t("YES"),callback:function(t){var i=new m({action:"restore",selection:e,sourceId:t.collection.id,folderItems:t.collection,service:"FLD_RESTORE"});new docs.views.ProgressBar({model:i,type:"indeterminate-progress",titles:{inProgress:i.progressTitle,complete:i.completeTitle},messages:{inProgress:i.progressMessage,complete:i.completeMessage}}),i.perform()},reverseButtons:"no",defaultButton:"ok"})},actionProperties:function(t,i,o,n){e('.layout-sidebar-sideboard .sideboard-button[data-name="properties"]').removeClass("selected"),e.sessionStorage("DocsSelectedtab","propTab"),docs.events.trigger("sidebar:showSidebar","properties")},actionConversation:function(){C.trigger("sidebar:toggleSidebar","conversation")},openVersionActivity:function(t,i){if(this.itemIsMine(t)){var o=this.containerItemfromRowEl(t);if(o.get("flags")&&o.get("flags").isInTrash)this.itemSelected(t,i);else{var n=[{id:o.id,rev:o.get("revision"),folderItem:o}];t.siblings().each((function(){e(this).removeClass("selected mousedown"),e(".containerview-check input",this).prop("checked",!1).change()})),t.removeClass("selected mousedown"),t.find(".containerview-check input").prop("checked",!1).change(),this.itemSelected(t,i),this.actionVersions(n,i)}}},actionVersions:function(t){e('.layout-sidebar-sideboard .sideboard-button[data-name="properties"]').removeClass("selected"),e.sessionStorage("DocsSelectedtab","versionTab"),C.trigger("sidebar:showSidebar","properties")},actionMembers:function(e){var t=this.collection.where({id:e[0].id})[0];require(["sites/dialogs/MembersFPD"],i.bind((function(e){t.fetch({ignoreSync:!0}).then((function(){var i=e.show({route:"sites/members/",modelOptions:{selectedSite:t}});this._slideInDialog=i}))}),this))},actionShareLink:function(e){var t=this.collection.where({id:e[0].id})[0],o=this.collection.container,n=!t.isFile||o.isSearchResults||o.isFavorites?t:o,s=docs.i18n.t("LINK_SHARE_DLG_TITLE",i.unescape(t.get("name")));require(["docs/share/ShareLinkDialog"],i.bind((function(e){e.show({item:t,container:n,dialogTitle:s})}),this))},rowClick:function(e){u.prototype.rowClick.call(this,e),C.trigger("action:rowclick")},onResize:function(e){if(e&&e.extraHeight){var t=this.$el.closest(".mainViewContainer"),i=t.height();t.height(i-e.extraHeight)}u.prototype.onResize.call(this)},setupDragDropMove:function(e,t,o){o.isTrash||o.isSearchResults||o.isFavorites||(i.isBoolean(this.externalDrag)&&this.externalDrag||i.isObject(this.externalDrag)&&this.externalDrag.enabled?_.setupExternalMove(e,t,o):this.disableDragMove||this._setupInternalDragDropMove(e,t,o))},_setupInternalDragDropMove:function(t,o,n){var s=this,a=e(t.el);o.isAllowedAction("folderWrite")&&(a.hasClass("folderview-fldrrow")||a.hasClass("folder-card-view"))&&a.droppable({activeClass:"drag-target-active",hoverClass:"drop-target-highlight",tolerance:"pointer",drop:function(){var e=s.containerItemfromRowEl(this),t={id:e.id,name:e.get("name")},o=s.getSelection(),n=e.get("ownedBy"),a=!0;i.each(o,(function(e){e.folderItem.get("ownedBy")!==n&&(a=!1)})),a?s.doMoveCopy("move",t,o):h.show({title:docs.i18n.t("MOVECOPY_MOVE_TITLE"),message:docs.i18n.t("MOVECOPY_OWNERSHIP_WARNING",e.get("ownedByName")),callback:function(){s.doMoveCopy("move",t,o)},cancelCallback:i.noop})},deactivate:function(){s.jqdragactive=!1},accept:function(t){var i=t.parents(".containerview-item");if(1===i.length)return e(this).attr("id")!==e(i[0]).attr("id")},over:function(e,t){var i=t.helper.data("count");i?t.helper.data("count",i+1):t.helper.data("count",1),t.helper.addClass("over-drop")},out:function(e,t){var i=t.helper.data("count");i?(1===i&&t.helper.removeClass("over-drop"),(i-=1)<0&&(i=0),t.helper.data("count",i)):t.helper.removeClass("over-drop")}}),!a.hasClass("containerview-item")||n.isHome&&o.isSharedToYou()||!(o.isFolder&&o.isAllowedAction("folderUpdate")||o.isFile&&o.isAllowedAction("fileUpdate"))||this._setupInternalDraggable(e(".containerview-openClick",a),a.parent())},_setupInternalDraggable:function(t){var i=this;e(t).draggable({containment:O.embed?"#embedWrapper":"#contentWrapper",appendTo:"body",cursor:"default",cursorAt:{top:-16,left:-16},helper:function(t){e(t.target).closest(".containerview-item").hasClass("selected")||i.rowClick(t);var o,n,s=i.getSelection(),a=s.length;return a>1||0===a?(o="FOLDERVIEW_DRAG_MOVE_HELPER_TEXT",n="athena-icon-16-movecopy"):(o="FOLDERVIEW_DRAG_MOVE_SINGLE_HELPER_TEXT",n="folder"===s[0].actionType?"athena-icon-16-enabledFolder":"athena-icon-16-file"),e(R({dragText:docs.i18n.t(o,a),dragIconClass:n,i18n:docs.i18n}))},start:function(){i.jqdragactive=!0}})},reload:function(){this.collection.fetch()},downloadFile:function(e){return this._itemAction(e,this.actionDownload)},editFile:function(e){return this._itemAction(e,this.actionEdit)},shareItem:function(e){return this._itemAction(e,this.actionShareLink)},newFolder:function(){g.prototype.newFolder.call({model:this.collection.container})},viewPinnedConversation:function(e){var t=this.containerItemfromRowEl(e.target),i=this.getSelection();return 1===i.length&&i[0].id===t.id?this._doActionOpen(i,e,!0):(this.rowClick(e),1===(i=this.getSelection()).length&&this._doActionOpen(i,e,!0)),!1},_itemAction:function(e,t){var i=this.containerItemfromRowEl(e.target),o=this.getSelection();return 1===o.length&&o[0].id===i.id?t.call(this,o):(this.rowClick(e),1===(o=this.getSelection()).length&&t.call(this,o)),!1},actionReserve:function(e){var t=this.collection.where({id:e[0].id})[0];e[0].checked&&t.set("checked",!0,{silent:!0}),t&&t.isFile&&t.makeReservation()},makeReservationResult:function(e){if(!e.success){var t=docs.i18n.t("RESERVED_FILE_FAILURE_UNKNOWN",e.fileItem.get("name"));e.error&&e.error.errorMsgKey&&(e.error.errorMsgKey.indexOf("csFldThisItemIsAlreadyReserved")>-1?t=docs.i18n.t("RESERVED_FILE_FAILURE_ALREADY_RESERVED",e.fileItem.get("name")):e.error.errorMsgKey.indexOf("csFldCannotReserveItemBeingEdit")>-1?t=docs.i18n.t("RESERVED_FILE_FAILURE_O365_EDIT",e.fileItem.get("name")):(e.error.errorMsgKey.indexOf("csFldThisItemDoesNotExist")>-1||e.error.errorMsgKey.indexOf("csFldDoesNotExist")>-1)&&(t=docs.i18n.t("RESERVED_FILE_FAILURE_NO_FILE",e.fileItem.get("name")),this.collection.remove(e.fileItem))),new docs.views.MessageBar({messageText:t,messageType:"error"})}},actionFree:function(e){var t=this.collection.where({id:e[0].id})[0];if(e[0].checked&&t.set("checked",!0,{silent:!0}),t&&t.isFile){var o=t.get("reservedBy");o&&o===O.userid?t.clearReservation():h.show({title:docs.i18n.t("CLEAR_RESERVE_TITLE",t.get("name")),message:docs.i18n.t("CLEAR_RESERVE_CONFIRMATION",t.get("reservedByName"),t.get("name")),okButtonText:docs.i18n.t("YES"),callback:function(){t.clearReservation()},cancelButtonText:docs.i18n.t("NO"),cancelCallback:i.noop,reverseButtons:"no",defaultButton:"cancel",disableScriptProtection:!0})}},clearReservationResult:function(e){if(!e.success){var t=docs.i18n.t("CLEAR_RESERVE_FAILURE_UNKNOWN",e.fileItem.get("name")),i="error";e.error&&e.error.errorMsgKey&&(e.error.errorMsgKey.indexOf("csFldReservedUserNotMatched")>-1?t=docs.i18n.t("CLEAR_RESERVE_FAILURE_OTHER_RESERVED",e.fileItem.get("name")):e.error.errorMsgKey.indexOf("csFldThisItemDoesNotExist")>-1||e.error.errorMsgKey.indexOf("csFldDoesNotExist")>-1?(t=docs.i18n.t("CLEAR_RESERVE_FAILURE_NO_FILE",e.fileItem.get("name")),this.collection.remove(e.fileItem)):e.error.errorMsgKey.indexOf("csFldThisItemIsNotReserved")>-1&&(t=docs.i18n.t("CLEAR_RESERVE_NOT_RESERVED",e.fileItem.get("name")),i="success")),new docs.views.MessageBar({messageText:t,messageType:i})}},actionSelAll:function(){this.selectAll(!0)},actionTag:function(e){require(["docs/metadata/view/MetadataTagsDialog"],i.bind((function(){C.trigger("sidebar:toggleSidebar","metadata")}),this))},actionAddToAssets:function(e){var t=this.model.get("id");require(["assets/dialog/ChooseRepositoryDialog","assets/model/AddItemsUploader","common/upload/model/UploadQueue","common/upload/model/QueueItem","connectors/model/ExternalConnector","core/util/FeatureFlags"],(function(o,n,s,a,r,l){var c,d=new s({connector:new r({connectorId:"Documents"}),uploadType:"addDocItems",fixedRepository:!1});d.setUploader(n),i.each(e,(function(e){c=new a({docItem:e}),d.add(c)}),this),o.show({cbContext:this,cbOk:function(e){d.set({fixedRepository:!0,repositoryId:e.id,repositoryName:e.get("name"),currentFolderId:t}),require(["assets/dialog/AddToRepositoryFPD"],(function(e){e.show({model:d,repository:d.get("repositoryId")})}))}})}))},_getSelectedItemIds:function(e){var t=[];return i.each(e,(function(e){var i="fFileGUID:"+e.id;t.push(i)}),this),t},render:function(e){u.prototype.render.call(this,e),this.renderExternalUsersLinksBanner&&this.renderExternalUsersLinksBanner(),O.embed&&c.events.resultsDisplayed(this.collection.first(this.model.options.pageSize),this.model)},renderExternalUsersLinksBanner:function(t){var o=this.model.get("hasExternalUserAccess"),n=this.model.get("hasExternalLinks");if(d.can("showExternalUserLinkBanner","All")&&!this.options.hidePublicLinkBanner&&(o||n)){var s=docs.i18n.t(o&&n?"FOLDER_BAR_WARNING_EXT_USERS_PUBLIC_LINK":o?"FOLDER_BAR_WARNING_EXT_USERS":"FOLDER_BAR_WARNING_PUBLIC_LINK","http://www.oracle.com/pls/topic/lookup?ctx=cloud&id=CECSA-GUID-925E928C-E14C-459C-A047-DA7DCBF18B2D");this.messageBar&&this.messageBarText!==s&&(this.messageBar.closeWebBar(),delete this.messageBar,delete this.messageBarText),this.messageBar&&this.messageBar.$el.is(":visible")||(this.messageBarText=s,this.messageBar=new docs.views.MessageBar({customIconClass:"athena-icon-16-info-blue",messageType:"info_iconFont",messageText:s,disableScriptProtection:!0,noImmediateProtectedPeriod:!0,notificationContext:this.el}),t||i.defer(function(){var t=this.$el.closest("#content-wrapper").find(".wbMessage");e("a",t).focus()}.bind(this)))}else this.messageBar&&(this.messageBar.closeWebBar(),delete this.messageBar,delete this.messageBarText)},_refreshExtUsersLinksBanner:function(e){if(e===this.model.id&&d.can("showExternalUserLinkBanner","All")){var t=this;this.model.bypassChangeMode=!0,this.model.fetch().then((function(){t.renderExternalUsersLinksBanner(!0)})).always((function(){t.model.bypassChangeMode=!1}))}}},v))})),define("docs/folderview/view/FolderView",["jquery","underscore","core/util/Globals","core/util/Session","core/util/Utils","core/util/Service","common/container/view/ContainerView","docs/folderview/view/FolderViewHeader","docs/folderview/view/FolderViewDetail","common/container/view/BreadCrumbView","common/sidebar/SidebarConfig","common/site/SitesUtils"],(function(e,t,docs,i,o,n,s,a,r,l,c,d){"use strict";var p=docs.common.Globals;return s.extend({id:"folderview",alertText:function(){return docs.i18n.t("FOLDERVIEW_FOLDER_ROW")+" "+this.model.get("name")},url:function(){return"folder/"+this.model.id+"/"+this.model.getUrlName()},ContainerViewHeader:a,ContainerViewDetail:r,BreadCrumbView:l,fullCells:!1,singleSelect:!1,pageUploader:!0,layoutOptions:{compact:!1,list:!0,grid:!1,card:!0,table:!0},contextSidebarTabs:function(){var e=c.getTabs(this.model,this.options);return d.isSites(this.model)&&(e=t.filter(e,(function(e){return"conversation"!=e.name&&"metadata"!=e.name}))),e},initialize:function(e){return s.prototype.initialize.call(this,e),this},delayedViewTimeout:function(){var e=docs.common.Utils.getGenericBoilerplateHtml("bp-large","css-spinner",docs.i18n.t("BP_LOAD_MSG"),docs.i18n.t("BP_LOAD_FOLDER_DETAIL"));return this.$el.html(e),this},renderError:function(e,a){if(!a&&!(n.isAccessDenied(e)||n.isNonExistingItem(e)||n.isItemInTrash(e)||n.isInvalidLink(e)))return s.prototype.initialize.renderError(this,e,a);var r,l;a.errorHandled=!0,this.BreadCrumbView&&(l=t.last(this.BreadCrumbView.trail)),r=i.isAnonymous()&&!l?docs.i18n.t("BP_ACCESS_DENIED_DETAIL_UNAUTH_SIGNIN",docs.common.Globals.memberRoot.slice(0,-1)):l?docs.i18n.t("BP_ACCESS_DENIED_DETAIL_BACK_FOLDER",l.id):!l&&t.isUndefined(this.options.breadcrumb)||!this.options.breadcrumb.hide?docs.i18n.t("BP_ACCESS_DENIED_DETAIL_BACK_FOLDER","home"):docs.i18n.t("BP_ACCESS_DENIED_DETAIL_BACK"),this.trigger("view:renderError");var c=o.getGenericBoilerplateHtml("bp-large bp-redwood-illustration",p.staticRoot+"images/Boilerplate_Error.png",docs.i18n.t("BP_ACCESS_DENIED_HEADER"),r);this.$el.html(c)}})})),define("docs/folderview/view/FavoritesViewHeader",["jquery","underscore","core/util/Session","common/sidebar/SidebarConfig","common/site/SitesUtils","core/util/UrlParams","common/container/view/ContainerViewHeader","core/router/DocsController"],(function(e,t,i,o,n){"use strict";return docs.views.FavoritesViewHeader=docs.views.ContainerViewHeader.extend(t.extend({id:"favoritesview-header",initialize:function(e){return docs.views.ContainerViewHeader.prototype.initialize.call(this,e)},renderData:function(){var e={title:docs.i18n.t("DOCUMENTS"),hideTitle:this.options.header&&!1===this.options.header.title,titleMenu:!(this.options.header&&!1===this.options.header.menu)&&{id:"filter_favorites",label:docs.i18n.t("FILTER_FAVORITES"),tooltip:docs.i18n.t("FILTER_FAVORITES_TOOLTIP"),items:[{id:"filter_all",label:docs.i18n.t("FILTER_ALL"),tooltip:docs.i18n.t("FILTER_ALL_MENU_TOOLTIP")},{id:"filter_owned",label:docs.i18n.t("FILTER_OWNED"),tooltip:docs.i18n.t("FILTER_OWNED_MENU_TOOLTIP")},{id:"filter_shared",label:docs.i18n.t("FILTER_SHARED"),tooltip:docs.i18n.t("FILTER_SHARED_MENU_TOOLTIP")},{id:"filter_favorites",label:docs.i18n.t("FILTER_FAVORITES"),tooltip:docs.i18n.t("FILTER_FAVORITES_MENU_TOOLTIP")},{id:"filter_trash",label:docs.i18n.t("FILTER_TRASH"),tooltip:docs.i18n.t("FILTER_TRASH_MENU_TOOLTIP")}]}};return this.adjustRenderDataForStdExternalUsers(e),e},headerButtonConfig:{menu:{text:"CONTEXT_TOOLBAR_MORE"},hasActions:null,items:[{action:"action_toggle_sidebar",location:"side",menu:"hide",menuOrder:3,weight:5,title:"ACTION_TOGGLE_SIDEBAR_TT",text:"ACTION_TOGGLE_SIDEBAR",icon:"header-sider-icon oj-ux-icon oj-ux-ico-side-bar"}]},hasActions:function(){var e=docs.common.Globals.isPublicLink,t=docs.common.Globals.isAppLink,i=n.isSites(this.model),s=this.contextActions.hasActions(this.model,["action_toggle_sidebar"]);return s.action_toggle_sidebar=!e&&!t&&!i&&o.getTabs(this.model,this.options).length>0,s},actionSelected:function(e){switch(e){case"action_toggle_sidebar":docs.events.trigger("sidebar:toggleSidebar");break;default:this.contextActions.trigger(e)}},titleMenuSelected:function(e,t){var o=docs.views.ContainerViewHeader.prototype.titleMenuSelected.call(this,e,t),n="folder/home/"+o.id.slice(7),s=docs.common.UrlParams.getConfigUrlPart(this.options.urlParams);n+=s+=docs.common.UrlParams.getViewConfigUrlPart(this.options.urlParams),i.folderFilter(o.id),docs.router.navigate(n,{trigger:!0,replace:!0})}})),docs.views.FavoritesViewHeader})),define("docs/folderview/view/FavoritesView",["jquery","underscore","docs/folderview/view/FolderView","docs/folderview/view/FavoritesViewHeader","common/sidebar/SidebarConfig"],(function(e,t,i,o,n){"use strict";return i.extend({id:"favoritesview",alertText:function(){return docs.i18n.t("DOCUMENTS")+" "+docs.i18n.t("FAVORITES")},url:function(){return"folder/home/favorites"},ContainerViewHeader:o,BreadCrumbView:void 0,pageUploader:!1,contextSidebarTabs:function(){return n.getTabs(this.model,this.options)},fullCells:!1,mixedContent:!0,singleSelect:!0})})),define("docs/folderview/view/HomeViewHeader",["backbone","underscore","core/util/Session","docs/folderview/view/FolderViewHeader","common/container/view/ContainerViewHeader","common/util/O365Edit","common/container/view/ContextToolbarView","common/sidebar/SidebarConfig","common/site/SitesUtils","core/router/DocsController","core/util/UrlParams"],(function(e,t,i,o,n,s,a,r,l){"use strict";return o.extend({id:"homeview-header",events:{},initialize:function(e){return o.prototype.initialize.call(this,e),this},renderData:function(){var e=this.model.get("filter").toUpperCase(),t={title:docs.i18n.t("DOCUMENTS"),hideTitle:this.options.header&&!1===this.options.header.title,titleMenu:!(this.options.header&&!1===this.options.header.menu)&&{id:this.model.get("filter"),label:docs.i18n.t(e),tooltip:docs.i18n.t(e+"_TOOLTIP"),items:[{id:"filter_all",label:docs.i18n.t("FILTER_ALL"),tooltip:docs.i18n.t("FILTER_ALL_MENU_TOOLTIP")},{id:"filter_owned",label:docs.i18n.t("FILTER_OWNED"),tooltip:docs.i18n.t("FILTER_OWNED_MENU_TOOLTIP")},{id:"filter_shared",label:docs.i18n.t("FILTER_SHARED"),tooltip:docs.i18n.t("FILTER_SHARED_MENU_TOOLTIP")},{id:"filter_favorites",label:docs.i18n.t("FILTER_FAVORITES"),tooltip:docs.i18n.t("FILTER_FAVORITES_MENU_TOOLTIP")},{id:"filter_trash",label:docs.i18n.t("FILTER_TRASH"),tooltip:docs.i18n.t("FILTER_TRASH_MENU_TOOLTIP")}]}};return this.adjustRenderDataForStdExternalUsers(t),t},headerButtonConfig:{menu:{text:"CONTEXT_TOOLBAR_MORE"},hasActions:null,items:[{action:"action_upload_to_folder",location:"left",locationOrder:1,menu:"show",menuOrder:1,weight:1,tooltip:"GENERAL_UPLOAD_TOOLTIP",text:"GENERAL_CMD_UPLOAD",isUploader:!0},{action:"action_new_folder",location:"left",locationOrder:2,menu:"show",menuOrder:2,weight:2,tooltip:"GENERAL_CREATE_FOLDER_TOOLTIP",text:"GENERAL_CMD_CREATE"},{action:"create_menu",location:"left",locationOrder:2,menu:"show",menuOrder:2,weight:2,locationType:"comboButton",tooltip:"MENU_CREATE_TT",title:"MENU_CREATE_TT",text:"MENU_CREATE"},{action:"action_toggle_sidebar",location:"side",menu:"hide",menuOrder:3,weight:5,title:"ACTION_TOGGLE_SIDEBAR_TT",text:"ACTION_TOGGLE_SIDEBAR",icon:"header-sider-icon oj-ux-icon oj-ux-ico-side-bar"}]},getComboButtonItems:function(e,t){switch(e){case"create_menu":return this.getActionSubmenuList(e,t)}},getActionSubmenuList:function(e,i){var o=this.getItemActions(),n=[],s=o.findWhere({id:e});if(s){var a=s.get("children"),r=o.filter((function(e){return t.contains(a,e.get("id"))}));t.each(r,(function(e,t){this.contextActions.hasActions(this.model,[e.id])[e.id]&&n.push(this.getItemProps(e,t,{verbose:i}))}),this)}return n},getItemActions:function(){var t=new e.Collection(this.contextActions.itemActions[this.model.get("type")]);return a.resolveMenuItems(t),t},getItemProps:function(e,t,i){var o="";return(i=i||{}).noTooltip||(o=e.get("tooltip")?e.get("tooltip"):e.get("label")),{action:e.id,locationType:"comboAction",order:t,rawText:e.get("label"),rawTooltip:o,itemIcon:s.getNewIcon(e.id),itemIconClass:s.getNewIconClass(e.id)}},hasActions:function(){var e=this.model.get("filter"),t=docs.common.Globals.isPublicLink,i=docs.common.Globals.isAppLink,o=l.isSites(this.model);if("filter_shared"===e&&!t&&!i&&!o&&r.getTabs(this.model,this.options).length>0)return{action_toggle_sidebar:!0};var n=this.contextActions.hasActions(this.model,["action_upload_to_folder","action_new_folder","create_menu","action_toggle_sidebar","action_menu_new_folder","action_o365_new_word","action_o365_new_ppt","action_o365_new_excel"]);return n.action_upload_to_folder=this.options.header.upload&&this.model.isAllowedAction("folderWrite"),n.action_new_folder=this.options.header.create.folder&&this.model.isAllowedAction("folderWrite"),n.action_toggle_sidebar=!t&&!i&&!o&&r.getTabs(this.model,this.options).length>0,s.isEnabled({systemAndTenant:!0})?(n.create_menu=n.action_o365_new_word||n.action_o365_new_ppt||n.action_o365_new_excel,n.create_menu&&delete n.action_new_folder):(delete n.create_menu,delete n.action_menu_new_folder,delete n.action_o365_new_word,delete n.action_o365_new_ppt,delete n.action_o365_new_excel),n},actionSelected:function(e){switch(e){case"action_upload_to_folder":o.prototype.uploadClicked.call(this);break;case"action_new_folder":case"action_menu_new_folder":o.prototype.newFolder.call(this);break;case"action_o365_new_word":s.newOfficeDocument(this.model,"docx");break;case"action_o365_new_ppt":s.newOfficeDocument(this.model,"pptx");break;case"action_o365_new_excel":s.newOfficeDocument(this.model,"xlsx");break;case"action_toggle_sidebar":docs.events.trigger("sidebar:toggleSidebar");break;default:this.contextActions.trigger(e)}},titleMenuSelected:function(e,t){var n=o.prototype.titleMenuSelected.call(this,e,t),s="folder/home/"+n.id.slice(7),a=docs.common.UrlParams.getConfigUrlPart(this.options.urlParams);s+=a+=docs.common.UrlParams.getViewConfigUrlPart(this.options.urlParams),i.folderFilter(n.id),docs.router.navigate(s,{trigger:!0,replace:!0})},onResize:function(){n.prototype.onResize.call(this)}})})),define("docs/folderview/view/HomeView",["jquery","underscore","docs/folderview/view/FolderView","docs/folderview/view/HomeViewHeader","common/sidebar/SidebarConfig"],(function(e,t,i,o,n){"use strict";return i.extend({id:"homefolderview",alertText:function(){var e=this.model.get("filter").toUpperCase();return docs.i18n.t("DOCUMENTS")+" "+docs.i18n.t(e)},url:function(){var e="folder/home",t=this.model.get("filter").slice("filter_".length);return"all"!==t&&(e+="/"+t),e},BreadCrumbView:void 0,pageUploader:!0,ContainerViewHeader:o,contextSidebarTabs:function(){return n.getTabs(this.model,this.options)}})})),define("docs-container-15b22b9.cache",(function(){}));